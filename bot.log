2026-02-13 17:28:28,551 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 17:28:29,801 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 17:28:29,802 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 17:28:29,803 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 17:28:29,803 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 17:28:30,576 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 17:28:30,692 - aiogram.dispatcher - INFO - Start polling
2026-02-13 17:28:30,804 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 17:29:36,859 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:29:36,865 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:29:36,865 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] (7946439246,)
2026-02-13 17:29:36,869 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-13 17:29:36,870 - sqlalchemy.engine.Engine - INFO - [generated in 0.00129s] (7946439246, '2026-02-13 17:29:36.867815', 0)
2026-02-13 17:29:36,873 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 17:29:36,885 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-13 17:29:36,885 - common.handler - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-13 17:29:36,885 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 17:29:37,836 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 17:29:37,838 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 17:29:37,838 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 17:29:37,838 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 17:29:38,614 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 17:29:38,627 - aiogram.event - INFO - Update id=66294952 is not handled. Duration 1770 ms by bot id=8543122898
2026-02-13 17:29:38,627 - aiogram.event - ERROR - Cause exception while process update id=66294952 by bot id=8543122898
AttributeError: 'VPNService' object has no attribute 'inbound_id'
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\common\handler.py", line 68, in start_cmd
    logger.info(f"Inbound {client.inbound_id} инициализирован для пользователя")
                           ^^^^^^^^^^^^^^^^^
AttributeError: 'VPNService' object has no attribute 'inbound_id'. Did you mean: 'inbound'?
2026-02-13 17:30:30,060 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 17:30:30,060 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 17:30:30,060 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 17:30:30,320 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 17:30:35,102 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 17:30:37,153 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 17:30:37,154 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 17:30:37,155 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 17:30:37,155 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 17:30:38,094 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 17:30:38,213 - aiogram.dispatcher - INFO - Start polling
2026-02-13 17:30:38,324 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 17:30:48,792 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:30:48,798 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:30:48,799 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] (7946439246,)
2026-02-13 17:30:48,801 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 17:30:48,802 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:30:49,577 - aiogram.event - INFO - Update id=66294953 is handled. Duration 786 ms by bot id=8543122898
2026-02-13 17:30:53,110 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:30:53,111 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 17:30:53,112 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] (7946439246,)
2026-02-13 17:30:53,348 - common.handler - INFO - Пользователь 7946439246 попытался просмотреть профиль без активной подписки.
2026-02-13 17:30:53,348 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:30:53,349 - aiogram.event - INFO - Update id=66294954 is handled. Duration 239 ms by bot id=8543122898
2026-02-13 17:31:00,921 - aiogram.event - INFO - Update id=66294955 is handled. Duration 221 ms by bot id=8543122898
2026-02-13 17:31:05,071 - aiogram.event - INFO - Update id=66294956 is handled. Duration 270 ms by bot id=8543122898
2026-02-13 17:31:07,090 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:31:07,090 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 17:31:07,090 - sqlalchemy.engine.Engine - INFO - [cached since 13.98s ago] (7946439246,)
2026-02-13 17:31:07,208 - common.handler - WARNING - Попытка продлить подписку для несуществующего пользователя: 7946439246
2026-02-13 17:31:07,208 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:31:07,208 - aiogram.event - INFO - Update id=66294957 is handled. Duration 249 ms by bot id=8543122898
2026-02-13 17:31:22,390 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:31:22,390 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:31:22,390 - sqlalchemy.engine.Engine - INFO - [cached since 33.59s ago] (7946439246,)
2026-02-13 17:31:22,391 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 17:31:22,392 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-13 17:31:22,392 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] (1,)
2026-02-13 17:31:22,393 - ServiceClasses.shoping_service - INFO - Получено 0 покупок для пользователя 1
2026-02-13 17:31:22,507 - common.handler - INFO - Пользователь 7946439246 запросил историю покупок, но покупок не найдено.
2026-02-13 17:31:22,508 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:31:22,508 - aiogram.event - INFO - Update id=66294958 is handled. Duration 119 ms by bot id=8543122898
2026-02-13 17:31:24,885 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:31:24,885 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:31:24,885 - sqlalchemy.engine.Engine - INFO - [cached since 36.09s ago] (7946439246,)
2026-02-13 17:31:24,886 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 17:31:24,886 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-13 17:31:24,887 - sqlalchemy.engine.Engine - INFO - [cached since 2.495s ago] (1,)
2026-02-13 17:31:24,887 - ServiceClasses.shoping_service - INFO - Получено 0 покупок для пользователя 1
2026-02-13 17:31:25,073 - common.handler - INFO - Пользователь 7946439246 запросил историю покупок, но покупок не найдено.
2026-02-13 17:31:25,074 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:31:25,074 - aiogram.event - INFO - Update id=66294959 is handled. Duration 190 ms by bot id=8543122898
2026-02-13 17:31:28,128 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:31:28,129 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 17:31:28,129 - sqlalchemy.engine.Engine - INFO - [cached since 35.02s ago] (7946439246,)
2026-02-13 17:31:28,348 - common.handler - INFO - Пользователь 7946439246 попытался просмотреть профиль без активной подписки.
2026-02-13 17:31:28,348 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:31:28,349 - aiogram.event - INFO - Update id=66294960 is handled. Duration 221 ms by bot id=8543122898
2026-02-13 17:32:49,063 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 17:32:49,064 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 17:32:49,064 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 17:32:49,325 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 17:32:59,250 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 17:33:00,264 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 17:33:00,265 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 17:33:00,265 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 17:33:00,265 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 17:33:01,082 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 17:33:01,177 - aiogram.dispatcher - INFO - Start polling
2026-02-13 17:33:01,262 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 17:33:15,628 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:33:15,629 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-13 17:33:15,629 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 17:33:15,630 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-13 17:33:15,630 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 17:33:15,631 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-13 17:33:15,631 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 17:33:15,631 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-13 17:33:15,632 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 17:33:15,633 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-13 17:33:15,633 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-13 17:33:15,647 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-13 17:33:15,648 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-13 17:33:15,658 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-13 17:33:15,659 - sqlalchemy.engine.Engine - INFO - [no key 0.00094s] ()
2026-02-13 17:33:15,670 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-13 17:33:15,671 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-13 17:33:15,680 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-13 17:33:15,681 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 17:33:15,681 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-13 17:33:15,681 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 17:33:15,682 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-13 17:33:15,682 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 17:33:15,682 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-13 17:33:15,682 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 17:33:15,683 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-13 17:33:15,683 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 17:33:15,684 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-13 17:33:15,684 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 17:33:15,685 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-13 17:33:15,685 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 17:33:15,685 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-13 17:33:15,685 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 17:33:15,686 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-13 17:33:15,687 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-13 17:33:15,696 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-13 17:33:15,696 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-13 17:33:15,707 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-13 17:33:15,708 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-13 17:33:15,718 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-13 17:33:15,718 - sqlalchemy.engine.Engine - INFO - [no key 0.00037s] ()
2026-02-13 17:33:15,729 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-13 17:33:15,729 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-13 17:33:15,740 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-13 17:33:15,740 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-13 17:33:15,750 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 17:33:15,751 - aiogram.event - INFO - Update id=66294962 is handled. Duration 834 ms by bot id=8543122898
2026-02-13 17:33:21,141 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:33:21,148 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:33:21,149 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] (7946439246,)
2026-02-13 17:33:21,152 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-13 17:33:21,153 - sqlalchemy.engine.Engine - INFO - [generated in 0.00074s] (7946439246, '2026-02-13 17:33:21.150972', 0)
2026-02-13 17:33:21,156 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 17:33:21,167 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-13 17:33:21,167 - common.handler - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-13 17:33:21,167 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 17:33:22,803 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 17:33:22,804 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 17:33:22,804 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 17:33:22,805 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 17:33:23,716 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 17:33:23,718 - common.handler - INFO - Inbound enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='xby5s6el', enable=True, id='35673e88-11b5-414f-8589-3753cee3cebc', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id=0, total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.microsoft.com:443', 'serverNames': ['www.microsoft.com', 'microsoft.com'], 'privateKey': 'wGSguAfvvojJdB2bJs4ljqcfu9evgQ0lWy9PKFQ_RWQ', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['b6', '6277', '30392505828128f3', '03bd010ab5fda2', 'e7c6bc', '42a1415d', 'a4639daea3', '2285c8b3a1e9'], 'mldsa65Seed': 'ZaTy4HSxx9T5ARzG0QB6hVpoTDPqaXtgRF854_immxw', 'settings': {'publicKey': 'f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'aAcpNBQu5sKltzLD2Psfpw_phO57ebdNcorCHbFwv2VSAAaBQ12s5ciJlAlljzcHr81q5uFqmif3PNQfge19Qk72BIVWtzcrTk_8jpCCgLa65dBYeSVWOD02VNARXnIR1XYb-aYrfX2GZJNQljjfGx4sQLV_0Hblz01r4lGuDvG4wc4MKvmbeaiOmWOhBexi5hIy8PvC_EEmGeDyBIiDj_ilqN3V31SrB9PKKDImb9Ci4DrBDG1zLNCssBpw6GxrKvhVFxwac5GGDoBkgrqDD31j94tmv3dJxet_JZgekJ_y3b_PLXuqMDYpxT3PC-IKKHFbjzX3-QRg1MyxIvOlt_5H1_7oT4e_n1sXcNce8aBy6Gav9qf_kdRoSkEyxQ6Xbh9BDs8hbq5g7610L45pGLO5DJF3iKeY5byblqs3Qhcw16JPHkcFiQuQeQKBq7g5hV9b536dBQRE-QGTGqQg9I5MrFuvbLXSQF9846NDQGwyhKuNBKtBpRQLCXYWURwIzLeHsFNXBDhSuIJzPMDPEHAERudXpzyLT77CjOyqoOYFVcJkyUhkYK671IIYnz3YaGphlFchAcG4qmUim9K3mXHL2bAOH12jrwMuapmXcsMErNugs_dwsH-zVSR7esJ2GdziFgU5KgJont8cCOR7Y6dCmCrRTItADkQCJDHLa-Ncx2CnxGAwAq4nK8YktrAAZTPSavDfHZ0Ky_O5QkshUDJKRrcs5ItnL3G3ZnXUHUaRv9p7UX2O3fmMS6YPEF4iVCreak4W-26CSAgUafqQj9VC4fRL525O2Ss86fPGeJ398lv5nzBVp9MZNoeR9PswC-_hovXoVUrIOdfUGnr77EtQU2GBt9V704LTtxEI1Rfpyyf1iurwUez02aEtV4BRa3-MFKGLQ96hE7S63aPIoGEOVqS7i06iEWaLzd8iOzBM849_KYIxF3s6FbfVhKy8NUMaeYx1fiZ-ZhJiK-Fhv4YNIGtkBAFlxwGKjG9u9wlDCnrPzmmVkPC7lgwl5NcpJXrkWwbfmuvPTwg8xrScW1iVuwBNmZYi8BTVXC0PPn_iFIWz--sQ1AQZ3vjrTLbpcFylbkMrdKCJcnEUaYvcopGQVTyJo5Pi2zeZBhlwiC07IqXIlwFquX0py5DCYcNd-379ryjK7jc5HMNeXWtE99TrqprZ0_L_EzD4DRlE_SkJyPDHn0t0YISmjBOXMKynt7X7gAFHHsxaxOxie7AMlaS3t0LKar47gDtZiWKVv0yVIXgjjeiak8zVjsRUcFOq30ziVY353WFy8ZAfgXoiSsfVFCszIhVYzgPK48j7_oJDRztbD8w3dRQ98NpfV9SVRkktQcBPVfx3plTE28H_V7eSZ0mNtSlg5wkpUazKWnezDwYB9YpWoMu4g3FH7yXI3oyRCiJDFWECaQt9Zvz0otf2LpHVbqs0VocrSu0ZZ5wls0u36eqc9TrgYYzvrPgWkfu73pQLt6XKcTV2h0oqRNEkITyitdwTkJUQCmryAMp9s5kXyRi8tWhFRSWTUMzkCRWBoXOas2sJW86O9mJfEImxAHOyodJvodkmiyWaomablqq-KEAMBa835ZD7XBBGstgj9KCWnhfxslhZiYrECo3mdiCt8U-Ffp9bN2lKawsk4lxLWymMgIGJxLnXAKij_bvC0bppxAdBwrZr5u6enSMdnnEXfLGwLY-GlzGdLo1hsjO49WzE7OskNRXH5-D_f0NFkdBrCZaNOd_769Kslbm9p9uxDuJWtsy5eY_0G7S8L1q3c6XkCG2YxZ0FtFtOiGVRspvYAfBKtAC5CD0Z6G9gD4uG66OsTfiamYU6Te4Sdly33pTB9N9VLHTBgQW9zJp9aiTHPifwBD2YQ5TYgdYZzppBCw3F9DHB_7XpXp4dJt8WRziuJGvqRCws63Kj3gfhJANH9QH8iqiVLUL9zhj-xWLMYKHN-VGCOIUyIgcb-XXIXjdWaP-T-OxEUJOiDaH6QXv7fPE5YwPB1ivTb2bXVaz9Ehivi5--zqCo4Tkwa-1tU-flGDnUsmgSD4G8wExai7JK67UtQszndV73uGFZcI4DhyY0On2a8irY-BJhbQRGo1YLGjns2vGs3H-AcWNTwKSB00aarIlMnG65Dplpboefcrk5aTqXNC1C5I1Ub9CE6Dec5FAHY2J-ApHL10A58mxAr1hYARUFSATUlOmzBz-jGe5nh2ZNINGhZ25mkoltwyex0PuNxdwytMwongFuu3Pf8vRuRAr_Wfl1yMipGMM_tihXfAkuCVtUqSpz2n-n-8A_Dw63jAJ6KUxFozI5CLGuKGSNvsqo3nkHpb2WHYZO_xRjX0UBQQec_LoQ1TY1WGUo7mpO93Z46zthwKW_8NQxC-nBz9zmQrd3g4IPp0ZrfO2zNNeeh-883igx3KrjQv1U2NUW4hHiWKkxF3EzvYbd4wCR0SR7E6D-IjLB6k1dkm0jjyl-5bxk5mW6Ilt1fkYawFnIdRh3HMSBxZaQo1hlKEJq0mQ5iL4M26PINpPFVcDr3jiCmzY1zA7Nefqn0yAastVNS0JB5HHFd9mKRfQSN1Os0dStuMTBuMDoU38lNI1aN32HZjuXxh4'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=42 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='xby5s6el', enable=True, id=263, password='', inbound_id=42, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id='', total_gb=0, uuid='35673e88-11b5-414f-8589-3753cee3cebc')] tag='inbound-443' инициализирован для пользователя
2026-02-13 17:33:23,718 - ServiceClasses.vpn_service - INFO - Создан VPN клиент для пользователя 7946439246 с истечением через 1771252401140 миллисекунд.
2026-02-13 17:33:23,719 - py3xui.async_api.async_api_base - INFO - Updating inbound: enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='xby5s6el', enable=True, id='35673e88-11b5-414f-8589-3753cee3cebc', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id=0, total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce', password='', inbound_id=None, up=0, down=0, expiry_time=1771252401140, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.microsoft.com:443', 'serverNames': ['www.microsoft.com', 'microsoft.com'], 'privateKey': 'wGSguAfvvojJdB2bJs4ljqcfu9evgQ0lWy9PKFQ_RWQ', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['b6', '6277', '30392505828128f3', '03bd010ab5fda2', 'e7c6bc', '42a1415d', 'a4639daea3', '2285c8b3a1e9'], 'mldsa65Seed': 'ZaTy4HSxx9T5ARzG0QB6hVpoTDPqaXtgRF854_immxw', 'settings': {'publicKey': 'f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'aAcpNBQu5sKltzLD2Psfpw_phO57ebdNcorCHbFwv2VSAAaBQ12s5ciJlAlljzcHr81q5uFqmif3PNQfge19Qk72BIVWtzcrTk_8jpCCgLa65dBYeSVWOD02VNARXnIR1XYb-aYrfX2GZJNQljjfGx4sQLV_0Hblz01r4lGuDvG4wc4MKvmbeaiOmWOhBexi5hIy8PvC_EEmGeDyBIiDj_ilqN3V31SrB9PKKDImb9Ci4DrBDG1zLNCssBpw6GxrKvhVFxwac5GGDoBkgrqDD31j94tmv3dJxet_JZgekJ_y3b_PLXuqMDYpxT3PC-IKKHFbjzX3-QRg1MyxIvOlt_5H1_7oT4e_n1sXcNce8aBy6Gav9qf_kdRoSkEyxQ6Xbh9BDs8hbq5g7610L45pGLO5DJF3iKeY5byblqs3Qhcw16JPHkcFiQuQeQKBq7g5hV9b536dBQRE-QGTGqQg9I5MrFuvbLXSQF9846NDQGwyhKuNBKtBpRQLCXYWURwIzLeHsFNXBDhSuIJzPMDPEHAERudXpzyLT77CjOyqoOYFVcJkyUhkYK671IIYnz3YaGphlFchAcG4qmUim9K3mXHL2bAOH12jrwMuapmXcsMErNugs_dwsH-zVSR7esJ2GdziFgU5KgJont8cCOR7Y6dCmCrRTItADkQCJDHLa-Ncx2CnxGAwAq4nK8YktrAAZTPSavDfHZ0Ky_O5QkshUDJKRrcs5ItnL3G3ZnXUHUaRv9p7UX2O3fmMS6YPEF4iVCreak4W-26CSAgUafqQj9VC4fRL525O2Ss86fPGeJ398lv5nzBVp9MZNoeR9PswC-_hovXoVUrIOdfUGnr77EtQU2GBt9V704LTtxEI1Rfpyyf1iurwUez02aEtV4BRa3-MFKGLQ96hE7S63aPIoGEOVqS7i06iEWaLzd8iOzBM849_KYIxF3s6FbfVhKy8NUMaeYx1fiZ-ZhJiK-Fhv4YNIGtkBAFlxwGKjG9u9wlDCnrPzmmVkPC7lgwl5NcpJXrkWwbfmuvPTwg8xrScW1iVuwBNmZYi8BTVXC0PPn_iFIWz--sQ1AQZ3vjrTLbpcFylbkMrdKCJcnEUaYvcopGQVTyJo5Pi2zeZBhlwiC07IqXIlwFquX0py5DCYcNd-379ryjK7jc5HMNeXWtE99TrqprZ0_L_EzD4DRlE_SkJyPDHn0t0YISmjBOXMKynt7X7gAFHHsxaxOxie7AMlaS3t0LKar47gDtZiWKVv0yVIXgjjeiak8zVjsRUcFOq30ziVY353WFy8ZAfgXoiSsfVFCszIhVYzgPK48j7_oJDRztbD8w3dRQ98NpfV9SVRkktQcBPVfx3plTE28H_V7eSZ0mNtSlg5wkpUazKWnezDwYB9YpWoMu4g3FH7yXI3oyRCiJDFWECaQt9Zvz0otf2LpHVbqs0VocrSu0ZZ5wls0u36eqc9TrgYYzvrPgWkfu73pQLt6XKcTV2h0oqRNEkITyitdwTkJUQCmryAMp9s5kXyRi8tWhFRSWTUMzkCRWBoXOas2sJW86O9mJfEImxAHOyodJvodkmiyWaomablqq-KEAMBa835ZD7XBBGstgj9KCWnhfxslhZiYrECo3mdiCt8U-Ffp9bN2lKawsk4lxLWymMgIGJxLnXAKij_bvC0bppxAdBwrZr5u6enSMdnnEXfLGwLY-GlzGdLo1hsjO49WzE7OskNRXH5-D_f0NFkdBrCZaNOd_769Kslbm9p9uxDuJWtsy5eY_0G7S8L1q3c6XkCG2YxZ0FtFtOiGVRspvYAfBKtAC5CD0Z6G9gD4uG66OsTfiamYU6Te4Sdly33pTB9N9VLHTBgQW9zJp9aiTHPifwBD2YQ5TYgdYZzppBCw3F9DHB_7XpXp4dJt8WRziuJGvqRCws63Kj3gfhJANH9QH8iqiVLUL9zhj-xWLMYKHN-VGCOIUyIgcb-XXIXjdWaP-T-OxEUJOiDaH6QXv7fPE5YwPB1ivTb2bXVaz9Ehivi5--zqCo4Tkwa-1tU-flGDnUsmgSD4G8wExai7JK67UtQszndV73uGFZcI4DhyY0On2a8irY-BJhbQRGo1YLGjns2vGs3H-AcWNTwKSB00aarIlMnG65Dplpboefcrk5aTqXNC1C5I1Ub9CE6Dec5FAHY2J-ApHL10A58mxAr1hYARUFSATUlOmzBz-jGe5nh2ZNINGhZ25mkoltwyex0PuNxdwytMwongFuu3Pf8vRuRAr_Wfl1yMipGMM_tihXfAkuCVtUqSpz2n-n-8A_Dw63jAJ6KUxFozI5CLGuKGSNvsqo3nkHpb2WHYZO_xRjX0UBQQec_LoQ1TY1WGUo7mpO93Z46zthwKW_8NQxC-nBz9zmQrd3g4IPp0ZrfO2zNNeeh-883igx3KrjQv1U2NUW4hHiWKkxF3EzvYbd4wCR0SR7E6D-IjLB6k1dkm0jjyl-5bxk5mW6Ilt1fkYawFnIdRh3HMSBxZaQo1hlKEJq0mQ5iL4M26PINpPFVcDr3jiCmzY1zA7Nefqn0yAastVNS0JB5HHFd9mKRfQSN1Os0dStuMTBuMDoU38lNI1aN32HZjuXxh4'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=42 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='xby5s6el', enable=True, id=263, password='', inbound_id=42, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id='', total_gb=0, uuid='35673e88-11b5-414f-8589-3753cee3cebc')] tag='inbound-443'
2026-02-13 17:33:24,575 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/update/42 "HTTP/1.1 200 OK"
2026-02-13 17:33:24,576 - py3xui.async_api.async_api_base - INFO - Inbound updated successfully.
2026-02-13 17:33:24,576 - common.handler - INFO - Клиент создан для пользователя: 7946439246 с именем: 7946439246
2026-02-13 17:33:24,577 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:33:24,577 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:33:24,577 - sqlalchemy.engine.Engine - INFO - [cached since 3.43s ago] (7946439246,)
2026-02-13 17:33:24,579 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, "key", uuid, expired, user_id) VALUES (?, ?, ?, ?, ?)
2026-02-13 17:33:24,580 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (7946439246, 'vless://d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce@94.183.186.146:443?type=tcp&encryption=none&security=reality&pbk=f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M&fp=chrome&sni=www.microsoft.com&sid=b6&spx=%2F&flow=xtls-rprx-vision#dw-7946439246', 'd51ed82a-3c1e-48c0-9f8d-cd204a4c8fce', '2026-02-16 14:33:21.140000', 1)
2026-02-13 17:33:24,581 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 17:33:24,591 - common.handler - INFO - Подписка создана для пользователя: 7946439246 с ключом: vless://d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce@94.183.186.146:443?type=tcp&encryption=none&security=reality&pbk=f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M&fp=chrome&sni=www.microsoft.com&sid=b6&spx=%2F&flow=xtls-rprx-vision#dw-7946439246
2026-02-13 17:33:24,797 - aiogram.event - INFO - Update id=66294963 is handled. Duration 3656 ms by bot id=8543122898
2026-02-13 17:33:27,109 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:33:27,110 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 17:33:27,111 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] (7946439246,)
2026-02-13 17:33:27,233 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:33:27,235 - aiogram.event - INFO - Update id=66294964 is handled. Duration 126 ms by bot id=8543122898
2026-02-13 17:33:35,716 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:33:35,717 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:33:35,717 - sqlalchemy.engine.Engine - INFO - [cached since 14.57s ago] (7946439246,)
2026-02-13 17:33:35,718 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 17:33:35,720 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-13 17:33:35,721 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (1,)
2026-02-13 17:33:35,722 - ServiceClasses.shoping_service - INFO - Получено 0 покупок для пользователя 1
2026-02-13 17:33:35,879 - common.handler - INFO - Пользователь 7946439246 запросил историю покупок, но покупок не найдено.
2026-02-13 17:33:35,880 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:33:35,880 - aiogram.event - INFO - Update id=66294965 is handled. Duration 164 ms by bot id=8543122898
2026-02-13 17:33:42,819 - aiogram.event - INFO - Update id=66294966 is handled. Duration 255 ms by bot id=8543122898
2026-02-13 17:33:44,267 - aiogram.event - INFO - Update id=66294967 is handled. Duration 647 ms by bot id=8543122898
2026-02-13 17:33:45,778 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:33:45,778 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 17:33:45,779 - sqlalchemy.engine.Engine - INFO - [cached since 18.67s ago] (7946439246,)
2026-02-13 17:33:45,779 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 17:33:46,672 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 17:33:46,673 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 17:33:46,673 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 17:33:46,674 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 17:33:47,550 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 17:33:47,553 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 17:33:47,553 - sqlalchemy.engine.Engine - INFO - [cached since 20.44s ago] (7946439246,)
2026-02-13 17:33:47,554 - py3xui.async_api.async_api_base - INFO - Updating inbound: enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='xby5s6el', enable=True, id='35673e88-11b5-414f-8589-3753cee3cebc', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id=0, total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce', password='', inbound_id=None, up=0, down=0, expiry_time=1773844401140, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.microsoft.com:443', 'serverNames': ['www.microsoft.com', 'microsoft.com'], 'privateKey': 'wGSguAfvvojJdB2bJs4ljqcfu9evgQ0lWy9PKFQ_RWQ', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['b6', '6277', '30392505828128f3', '03bd010ab5fda2', 'e7c6bc', '42a1415d', 'a4639daea3', '2285c8b3a1e9'], 'mldsa65Seed': 'ZaTy4HSxx9T5ARzG0QB6hVpoTDPqaXtgRF854_immxw', 'settings': {'publicKey': 'f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'aAcpNBQu5sKltzLD2Psfpw_phO57ebdNcorCHbFwv2VSAAaBQ12s5ciJlAlljzcHr81q5uFqmif3PNQfge19Qk72BIVWtzcrTk_8jpCCgLa65dBYeSVWOD02VNARXnIR1XYb-aYrfX2GZJNQljjfGx4sQLV_0Hblz01r4lGuDvG4wc4MKvmbeaiOmWOhBexi5hIy8PvC_EEmGeDyBIiDj_ilqN3V31SrB9PKKDImb9Ci4DrBDG1zLNCssBpw6GxrKvhVFxwac5GGDoBkgrqDD31j94tmv3dJxet_JZgekJ_y3b_PLXuqMDYpxT3PC-IKKHFbjzX3-QRg1MyxIvOlt_5H1_7oT4e_n1sXcNce8aBy6Gav9qf_kdRoSkEyxQ6Xbh9BDs8hbq5g7610L45pGLO5DJF3iKeY5byblqs3Qhcw16JPHkcFiQuQeQKBq7g5hV9b536dBQRE-QGTGqQg9I5MrFuvbLXSQF9846NDQGwyhKuNBKtBpRQLCXYWURwIzLeHsFNXBDhSuIJzPMDPEHAERudXpzyLT77CjOyqoOYFVcJkyUhkYK671IIYnz3YaGphlFchAcG4qmUim9K3mXHL2bAOH12jrwMuapmXcsMErNugs_dwsH-zVSR7esJ2GdziFgU5KgJont8cCOR7Y6dCmCrRTItADkQCJDHLa-Ncx2CnxGAwAq4nK8YktrAAZTPSavDfHZ0Ky_O5QkshUDJKRrcs5ItnL3G3ZnXUHUaRv9p7UX2O3fmMS6YPEF4iVCreak4W-26CSAgUafqQj9VC4fRL525O2Ss86fPGeJ398lv5nzBVp9MZNoeR9PswC-_hovXoVUrIOdfUGnr77EtQU2GBt9V704LTtxEI1Rfpyyf1iurwUez02aEtV4BRa3-MFKGLQ96hE7S63aPIoGEOVqS7i06iEWaLzd8iOzBM849_KYIxF3s6FbfVhKy8NUMaeYx1fiZ-ZhJiK-Fhv4YNIGtkBAFlxwGKjG9u9wlDCnrPzmmVkPC7lgwl5NcpJXrkWwbfmuvPTwg8xrScW1iVuwBNmZYi8BTVXC0PPn_iFIWz--sQ1AQZ3vjrTLbpcFylbkMrdKCJcnEUaYvcopGQVTyJo5Pi2zeZBhlwiC07IqXIlwFquX0py5DCYcNd-379ryjK7jc5HMNeXWtE99TrqprZ0_L_EzD4DRlE_SkJyPDHn0t0YISmjBOXMKynt7X7gAFHHsxaxOxie7AMlaS3t0LKar47gDtZiWKVv0yVIXgjjeiak8zVjsRUcFOq30ziVY353WFy8ZAfgXoiSsfVFCszIhVYzgPK48j7_oJDRztbD8w3dRQ98NpfV9SVRkktQcBPVfx3plTE28H_V7eSZ0mNtSlg5wkpUazKWnezDwYB9YpWoMu4g3FH7yXI3oyRCiJDFWECaQt9Zvz0otf2LpHVbqs0VocrSu0ZZ5wls0u36eqc9TrgYYzvrPgWkfu73pQLt6XKcTV2h0oqRNEkITyitdwTkJUQCmryAMp9s5kXyRi8tWhFRSWTUMzkCRWBoXOas2sJW86O9mJfEImxAHOyodJvodkmiyWaomablqq-KEAMBa835ZD7XBBGstgj9KCWnhfxslhZiYrECo3mdiCt8U-Ffp9bN2lKawsk4lxLWymMgIGJxLnXAKij_bvC0bppxAdBwrZr5u6enSMdnnEXfLGwLY-GlzGdLo1hsjO49WzE7OskNRXH5-D_f0NFkdBrCZaNOd_769Kslbm9p9uxDuJWtsy5eY_0G7S8L1q3c6XkCG2YxZ0FtFtOiGVRspvYAfBKtAC5CD0Z6G9gD4uG66OsTfiamYU6Te4Sdly33pTB9N9VLHTBgQW9zJp9aiTHPifwBD2YQ5TYgdYZzppBCw3F9DHB_7XpXp4dJt8WRziuJGvqRCws63Kj3gfhJANH9QH8iqiVLUL9zhj-xWLMYKHN-VGCOIUyIgcb-XXIXjdWaP-T-OxEUJOiDaH6QXv7fPE5YwPB1ivTb2bXVaz9Ehivi5--zqCo4Tkwa-1tU-flGDnUsmgSD4G8wExai7JK67UtQszndV73uGFZcI4DhyY0On2a8irY-BJhbQRGo1YLGjns2vGs3H-AcWNTwKSB00aarIlMnG65Dplpboefcrk5aTqXNC1C5I1Ub9CE6Dec5FAHY2J-ApHL10A58mxAr1hYARUFSATUlOmzBz-jGe5nh2ZNINGhZ25mkoltwyex0PuNxdwytMwongFuu3Pf8vRuRAr_Wfl1yMipGMM_tihXfAkuCVtUqSpz2n-n-8A_Dw63jAJ6KUxFozI5CLGuKGSNvsqo3nkHpb2WHYZO_xRjX0UBQQec_LoQ1TY1WGUo7mpO93Z46zthwKW_8NQxC-nBz9zmQrd3g4IPp0ZrfO2zNNeeh-883igx3KrjQv1U2NUW4hHiWKkxF3EzvYbd4wCR0SR7E6D-IjLB6k1dkm0jjyl-5bxk5mW6Ilt1fkYawFnIdRh3HMSBxZaQo1hlKEJq0mQ5iL4M26PINpPFVcDr3jiCmzY1zA7Nefqn0yAastVNS0JB5HHFd9mKRfQSN1Os0dStuMTBuMDoU38lNI1aN32HZjuXxh4'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=42 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='xby5s6el', enable=True, id=263, password='', inbound_id=42, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id='', total_gb=0, uuid='35673e88-11b5-414f-8589-3753cee3cebc'), Client(email='7946439246', enable=True, id=264, password='', inbound_id=42, up=0, down=0, expiry_time=1771252401140, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce')] tag='inbound-443'
2026-02-13 17:33:48,381 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/update/42 "HTTP/1.1 200 OK"
2026-02-13 17:33:48,383 - py3xui.async_api.async_api_base - INFO - Inbound updated successfully.
2026-02-13 17:33:48,384 - sqlalchemy.engine.Engine - INFO - UPDATE subscriptions SET expired=? WHERE subscriptions.id = ?
2026-02-13 17:33:48,384 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ('2026-03-18 14:33:21.140000', 1)
2026-02-13 17:33:48,385 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 17:33:48,395 - common.handler - INFO - Подписка продлена на 30 дней для пользователя: 7946439246
2026-02-13 17:33:48,395 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:33:48,395 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:33:48,396 - sqlalchemy.engine.Engine - INFO - [cached since 27.25s ago] (7946439246,)
2026-02-13 17:33:48,396 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 17:33:48,397 - sqlalchemy.engine.Engine - INFO - INSERT INTO shoping (money, shop_date, user_id) VALUES (?, ?, ?)
2026-02-13 17:33:48,397 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] (149, '2026-02-13 14:33', 1)
2026-02-13 17:33:48,399 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 17:33:48,408 - ServiceClasses.shoping_service - INFO - Покупка создана: пользователь 1, сумма 149 Р., дата 2026-02-13 14:33
2026-02-13 17:33:48,409 - common.handler - INFO - Запись о покупке добавлена для пользователя: 7946439246 с суммой: 149 Р. и датой: 2026-02-13 14:33
2026-02-13 17:33:48,409 - aiogram.event - INFO - Update id=66294968 is handled. Duration 2731 ms by bot id=8543122898
2026-02-13 17:33:50,140 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:33:50,140 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:33:50,140 - sqlalchemy.engine.Engine - INFO - [cached since 28.99s ago] (7946439246,)
2026-02-13 17:33:50,141 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 17:33:50,141 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-13 17:33:50,142 - sqlalchemy.engine.Engine - INFO - [cached since 14.42s ago] (1,)
2026-02-13 17:33:50,143 - ServiceClasses.shoping_service - INFO - Получено 1 покупок для пользователя 1
2026-02-13 17:33:50,255 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:33:50,256 - aiogram.event - INFO - Update id=66294969 is handled. Duration 116 ms by bot id=8543122898
2026-02-13 17:33:52,129 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:33:52,130 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 17:33:52,130 - sqlalchemy.engine.Engine - INFO - [cached since 25.02s ago] (7946439246,)
2026-02-13 17:33:52,273 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:33:52,273 - aiogram.event - INFO - Update id=66294970 is handled. Duration 144 ms by bot id=8543122898
2026-02-13 17:33:55,086 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:33:55,086 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 17:33:55,086 - sqlalchemy.engine.Engine - INFO - [cached since 27.98s ago] (7946439246,)
2026-02-13 17:33:55,735 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:33:55,735 - aiogram.event - INFO - Update id=66294971 is handled. Duration 650 ms by bot id=8543122898
2026-02-13 17:34:05,542 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:34:05,543 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:34:05,543 - sqlalchemy.engine.Engine - INFO - [cached since 44.4s ago] (7946439246,)
2026-02-13 17:34:05,544 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 17:34:05,544 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:34:05,766 - aiogram.event - INFO - Update id=66294972 is handled. Duration 224 ms by bot id=8543122898
2026-02-13 17:34:08,153 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:34:08,153 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:34:08,154 - sqlalchemy.engine.Engine - INFO - [cached since 47.01s ago] (7946439246,)
2026-02-13 17:34:08,154 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 17:34:08,154 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:34:08,290 - aiogram.event - INFO - Update id=66294973 is handled. Duration 137 ms by bot id=8543122898
2026-02-13 17:34:26,238 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:34:26,238 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:34:26,238 - sqlalchemy.engine.Engine - INFO - [cached since 65.09s ago] (8016999764,)
2026-02-13 17:34:26,239 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-13 17:34:26,239 - sqlalchemy.engine.Engine - INFO - [cached since 65.09s ago] (8016999764, '2026-02-13 17:34:26.239441', 0)
2026-02-13 17:34:26,241 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 17:34:26,251 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 8016999764
2026-02-13 17:34:26,251 - common.handler - INFO - Пользователь с Telegram ID 8016999764 создан в базе данных.
2026-02-13 17:34:26,252 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 17:34:27,792 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 17:34:27,793 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 17:34:27,793 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 17:34:27,794 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 17:34:28,626 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 17:34:28,628 - common.handler - INFO - Inbound enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='xby5s6el', enable=True, id='35673e88-11b5-414f-8589-3753cee3cebc', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id=0, total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce', password='', inbound_id=None, up=0, down=0, expiry_time=1773844401140, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.microsoft.com:443', 'serverNames': ['www.microsoft.com', 'microsoft.com'], 'privateKey': 'wGSguAfvvojJdB2bJs4ljqcfu9evgQ0lWy9PKFQ_RWQ', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['b6', '6277', '30392505828128f3', '03bd010ab5fda2', 'e7c6bc', '42a1415d', 'a4639daea3', '2285c8b3a1e9'], 'mldsa65Seed': 'ZaTy4HSxx9T5ARzG0QB6hVpoTDPqaXtgRF854_immxw', 'settings': {'publicKey': 'f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'aAcpNBQu5sKltzLD2Psfpw_phO57ebdNcorCHbFwv2VSAAaBQ12s5ciJlAlljzcHr81q5uFqmif3PNQfge19Qk72BIVWtzcrTk_8jpCCgLa65dBYeSVWOD02VNARXnIR1XYb-aYrfX2GZJNQljjfGx4sQLV_0Hblz01r4lGuDvG4wc4MKvmbeaiOmWOhBexi5hIy8PvC_EEmGeDyBIiDj_ilqN3V31SrB9PKKDImb9Ci4DrBDG1zLNCssBpw6GxrKvhVFxwac5GGDoBkgrqDD31j94tmv3dJxet_JZgekJ_y3b_PLXuqMDYpxT3PC-IKKHFbjzX3-QRg1MyxIvOlt_5H1_7oT4e_n1sXcNce8aBy6Gav9qf_kdRoSkEyxQ6Xbh9BDs8hbq5g7610L45pGLO5DJF3iKeY5byblqs3Qhcw16JPHkcFiQuQeQKBq7g5hV9b536dBQRE-QGTGqQg9I5MrFuvbLXSQF9846NDQGwyhKuNBKtBpRQLCXYWURwIzLeHsFNXBDhSuIJzPMDPEHAERudXpzyLT77CjOyqoOYFVcJkyUhkYK671IIYnz3YaGphlFchAcG4qmUim9K3mXHL2bAOH12jrwMuapmXcsMErNugs_dwsH-zVSR7esJ2GdziFgU5KgJont8cCOR7Y6dCmCrRTItADkQCJDHLa-Ncx2CnxGAwAq4nK8YktrAAZTPSavDfHZ0Ky_O5QkshUDJKRrcs5ItnL3G3ZnXUHUaRv9p7UX2O3fmMS6YPEF4iVCreak4W-26CSAgUafqQj9VC4fRL525O2Ss86fPGeJ398lv5nzBVp9MZNoeR9PswC-_hovXoVUrIOdfUGnr77EtQU2GBt9V704LTtxEI1Rfpyyf1iurwUez02aEtV4BRa3-MFKGLQ96hE7S63aPIoGEOVqS7i06iEWaLzd8iOzBM849_KYIxF3s6FbfVhKy8NUMaeYx1fiZ-ZhJiK-Fhv4YNIGtkBAFlxwGKjG9u9wlDCnrPzmmVkPC7lgwl5NcpJXrkWwbfmuvPTwg8xrScW1iVuwBNmZYi8BTVXC0PPn_iFIWz--sQ1AQZ3vjrTLbpcFylbkMrdKCJcnEUaYvcopGQVTyJo5Pi2zeZBhlwiC07IqXIlwFquX0py5DCYcNd-379ryjK7jc5HMNeXWtE99TrqprZ0_L_EzD4DRlE_SkJyPDHn0t0YISmjBOXMKynt7X7gAFHHsxaxOxie7AMlaS3t0LKar47gDtZiWKVv0yVIXgjjeiak8zVjsRUcFOq30ziVY353WFy8ZAfgXoiSsfVFCszIhVYzgPK48j7_oJDRztbD8w3dRQ98NpfV9SVRkktQcBPVfx3plTE28H_V7eSZ0mNtSlg5wkpUazKWnezDwYB9YpWoMu4g3FH7yXI3oyRCiJDFWECaQt9Zvz0otf2LpHVbqs0VocrSu0ZZ5wls0u36eqc9TrgYYzvrPgWkfu73pQLt6XKcTV2h0oqRNEkITyitdwTkJUQCmryAMp9s5kXyRi8tWhFRSWTUMzkCRWBoXOas2sJW86O9mJfEImxAHOyodJvodkmiyWaomablqq-KEAMBa835ZD7XBBGstgj9KCWnhfxslhZiYrECo3mdiCt8U-Ffp9bN2lKawsk4lxLWymMgIGJxLnXAKij_bvC0bppxAdBwrZr5u6enSMdnnEXfLGwLY-GlzGdLo1hsjO49WzE7OskNRXH5-D_f0NFkdBrCZaNOd_769Kslbm9p9uxDuJWtsy5eY_0G7S8L1q3c6XkCG2YxZ0FtFtOiGVRspvYAfBKtAC5CD0Z6G9gD4uG66OsTfiamYU6Te4Sdly33pTB9N9VLHTBgQW9zJp9aiTHPifwBD2YQ5TYgdYZzppBCw3F9DHB_7XpXp4dJt8WRziuJGvqRCws63Kj3gfhJANH9QH8iqiVLUL9zhj-xWLMYKHN-VGCOIUyIgcb-XXIXjdWaP-T-OxEUJOiDaH6QXv7fPE5YwPB1ivTb2bXVaz9Ehivi5--zqCo4Tkwa-1tU-flGDnUsmgSD4G8wExai7JK67UtQszndV73uGFZcI4DhyY0On2a8irY-BJhbQRGo1YLGjns2vGs3H-AcWNTwKSB00aarIlMnG65Dplpboefcrk5aTqXNC1C5I1Ub9CE6Dec5FAHY2J-ApHL10A58mxAr1hYARUFSATUlOmzBz-jGe5nh2ZNINGhZ25mkoltwyex0PuNxdwytMwongFuu3Pf8vRuRAr_Wfl1yMipGMM_tihXfAkuCVtUqSpz2n-n-8A_Dw63jAJ6KUxFozI5CLGuKGSNvsqo3nkHpb2WHYZO_xRjX0UBQQec_LoQ1TY1WGUo7mpO93Z46zthwKW_8NQxC-nBz9zmQrd3g4IPp0ZrfO2zNNeeh-883igx3KrjQv1U2NUW4hHiWKkxF3EzvYbd4wCR0SR7E6D-IjLB6k1dkm0jjyl-5bxk5mW6Ilt1fkYawFnIdRh3HMSBxZaQo1hlKEJq0mQ5iL4M26PINpPFVcDr3jiCmzY1zA7Nefqn0yAastVNS0JB5HHFd9mKRfQSN1Os0dStuMTBuMDoU38lNI1aN32HZjuXxh4'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=42 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='xby5s6el', enable=True, id=263, password='', inbound_id=42, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id='', total_gb=0, uuid='35673e88-11b5-414f-8589-3753cee3cebc'), Client(email='7946439246', enable=True, id=264, password='', inbound_id=42, up=0, down=0, expiry_time=1771252401140, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce')] tag='inbound-443' инициализирован для пользователя
2026-02-13 17:34:28,628 - ServiceClasses.vpn_service - INFO - Создан VPN клиент для пользователя 8016999764 с истечением через 1771252466237 миллисекунд.
2026-02-13 17:34:28,628 - py3xui.async_api.async_api_base - INFO - Updating inbound: enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='xby5s6el', enable=True, id='35673e88-11b5-414f-8589-3753cee3cebc', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id=0, total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce', password='', inbound_id=None, up=0, down=0, expiry_time=1773844401140, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None), Client(email='8016999764', enable=True, id='e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b', password='', inbound_id=None, up=0, down=0, expiry_time=1771252466237, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.microsoft.com:443', 'serverNames': ['www.microsoft.com', 'microsoft.com'], 'privateKey': 'wGSguAfvvojJdB2bJs4ljqcfu9evgQ0lWy9PKFQ_RWQ', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['b6', '6277', '30392505828128f3', '03bd010ab5fda2', 'e7c6bc', '42a1415d', 'a4639daea3', '2285c8b3a1e9'], 'mldsa65Seed': 'ZaTy4HSxx9T5ARzG0QB6hVpoTDPqaXtgRF854_immxw', 'settings': {'publicKey': 'f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'aAcpNBQu5sKltzLD2Psfpw_phO57ebdNcorCHbFwv2VSAAaBQ12s5ciJlAlljzcHr81q5uFqmif3PNQfge19Qk72BIVWtzcrTk_8jpCCgLa65dBYeSVWOD02VNARXnIR1XYb-aYrfX2GZJNQljjfGx4sQLV_0Hblz01r4lGuDvG4wc4MKvmbeaiOmWOhBexi5hIy8PvC_EEmGeDyBIiDj_ilqN3V31SrB9PKKDImb9Ci4DrBDG1zLNCssBpw6GxrKvhVFxwac5GGDoBkgrqDD31j94tmv3dJxet_JZgekJ_y3b_PLXuqMDYpxT3PC-IKKHFbjzX3-QRg1MyxIvOlt_5H1_7oT4e_n1sXcNce8aBy6Gav9qf_kdRoSkEyxQ6Xbh9BDs8hbq5g7610L45pGLO5DJF3iKeY5byblqs3Qhcw16JPHkcFiQuQeQKBq7g5hV9b536dBQRE-QGTGqQg9I5MrFuvbLXSQF9846NDQGwyhKuNBKtBpRQLCXYWURwIzLeHsFNXBDhSuIJzPMDPEHAERudXpzyLT77CjOyqoOYFVcJkyUhkYK671IIYnz3YaGphlFchAcG4qmUim9K3mXHL2bAOH12jrwMuapmXcsMErNugs_dwsH-zVSR7esJ2GdziFgU5KgJont8cCOR7Y6dCmCrRTItADkQCJDHLa-Ncx2CnxGAwAq4nK8YktrAAZTPSavDfHZ0Ky_O5QkshUDJKRrcs5ItnL3G3ZnXUHUaRv9p7UX2O3fmMS6YPEF4iVCreak4W-26CSAgUafqQj9VC4fRL525O2Ss86fPGeJ398lv5nzBVp9MZNoeR9PswC-_hovXoVUrIOdfUGnr77EtQU2GBt9V704LTtxEI1Rfpyyf1iurwUez02aEtV4BRa3-MFKGLQ96hE7S63aPIoGEOVqS7i06iEWaLzd8iOzBM849_KYIxF3s6FbfVhKy8NUMaeYx1fiZ-ZhJiK-Fhv4YNIGtkBAFlxwGKjG9u9wlDCnrPzmmVkPC7lgwl5NcpJXrkWwbfmuvPTwg8xrScW1iVuwBNmZYi8BTVXC0PPn_iFIWz--sQ1AQZ3vjrTLbpcFylbkMrdKCJcnEUaYvcopGQVTyJo5Pi2zeZBhlwiC07IqXIlwFquX0py5DCYcNd-379ryjK7jc5HMNeXWtE99TrqprZ0_L_EzD4DRlE_SkJyPDHn0t0YISmjBOXMKynt7X7gAFHHsxaxOxie7AMlaS3t0LKar47gDtZiWKVv0yVIXgjjeiak8zVjsRUcFOq30ziVY353WFy8ZAfgXoiSsfVFCszIhVYzgPK48j7_oJDRztbD8w3dRQ98NpfV9SVRkktQcBPVfx3plTE28H_V7eSZ0mNtSlg5wkpUazKWnezDwYB9YpWoMu4g3FH7yXI3oyRCiJDFWECaQt9Zvz0otf2LpHVbqs0VocrSu0ZZ5wls0u36eqc9TrgYYzvrPgWkfu73pQLt6XKcTV2h0oqRNEkITyitdwTkJUQCmryAMp9s5kXyRi8tWhFRSWTUMzkCRWBoXOas2sJW86O9mJfEImxAHOyodJvodkmiyWaomablqq-KEAMBa835ZD7XBBGstgj9KCWnhfxslhZiYrECo3mdiCt8U-Ffp9bN2lKawsk4lxLWymMgIGJxLnXAKij_bvC0bppxAdBwrZr5u6enSMdnnEXfLGwLY-GlzGdLo1hsjO49WzE7OskNRXH5-D_f0NFkdBrCZaNOd_769Kslbm9p9uxDuJWtsy5eY_0G7S8L1q3c6XkCG2YxZ0FtFtOiGVRspvYAfBKtAC5CD0Z6G9gD4uG66OsTfiamYU6Te4Sdly33pTB9N9VLHTBgQW9zJp9aiTHPifwBD2YQ5TYgdYZzppBCw3F9DHB_7XpXp4dJt8WRziuJGvqRCws63Kj3gfhJANH9QH8iqiVLUL9zhj-xWLMYKHN-VGCOIUyIgcb-XXIXjdWaP-T-OxEUJOiDaH6QXv7fPE5YwPB1ivTb2bXVaz9Ehivi5--zqCo4Tkwa-1tU-flGDnUsmgSD4G8wExai7JK67UtQszndV73uGFZcI4DhyY0On2a8irY-BJhbQRGo1YLGjns2vGs3H-AcWNTwKSB00aarIlMnG65Dplpboefcrk5aTqXNC1C5I1Ub9CE6Dec5FAHY2J-ApHL10A58mxAr1hYARUFSATUlOmzBz-jGe5nh2ZNINGhZ25mkoltwyex0PuNxdwytMwongFuu3Pf8vRuRAr_Wfl1yMipGMM_tihXfAkuCVtUqSpz2n-n-8A_Dw63jAJ6KUxFozI5CLGuKGSNvsqo3nkHpb2WHYZO_xRjX0UBQQec_LoQ1TY1WGUo7mpO93Z46zthwKW_8NQxC-nBz9zmQrd3g4IPp0ZrfO2zNNeeh-883igx3KrjQv1U2NUW4hHiWKkxF3EzvYbd4wCR0SR7E6D-IjLB6k1dkm0jjyl-5bxk5mW6Ilt1fkYawFnIdRh3HMSBxZaQo1hlKEJq0mQ5iL4M26PINpPFVcDr3jiCmzY1zA7Nefqn0yAastVNS0JB5HHFd9mKRfQSN1Os0dStuMTBuMDoU38lNI1aN32HZjuXxh4'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=42 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='xby5s6el', enable=True, id=263, password='', inbound_id=42, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id='', total_gb=0, uuid='35673e88-11b5-414f-8589-3753cee3cebc'), Client(email='7946439246', enable=True, id=264, password='', inbound_id=42, up=0, down=0, expiry_time=1771252401140, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce')] tag='inbound-443'
2026-02-13 17:34:29,410 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/update/42 "HTTP/1.1 200 OK"
2026-02-13 17:34:29,413 - py3xui.async_api.async_api_base - INFO - Inbound updated successfully.
2026-02-13 17:34:29,413 - common.handler - INFO - Клиент создан для пользователя: 8016999764 с именем: 8016999764
2026-02-13 17:34:29,413 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:34:29,414 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:34:29,414 - sqlalchemy.engine.Engine - INFO - [cached since 68.27s ago] (8016999764,)
2026-02-13 17:34:29,415 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, "key", uuid, expired, user_id) VALUES (?, ?, ?, ?, ?)
2026-02-13 17:34:29,417 - sqlalchemy.engine.Engine - INFO - [cached since 64.84s ago] (8016999764, 'vless://e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b@94.183.186.146:443?type=tcp&encryption=none&security=reality&pbk=f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M&fp=chrome&sni=www.microsoft.com&sid=b6&spx=%2F&flow=xtls-rprx-vision#dw-8016999764', 'e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b', '2026-02-16 14:34:26.237000', 2)
2026-02-13 17:34:29,419 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 17:34:29,431 - common.handler - INFO - Подписка создана для пользователя: 8016999764 с ключом: vless://e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b@94.183.186.146:443?type=tcp&encryption=none&security=reality&pbk=f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M&fp=chrome&sni=www.microsoft.com&sid=b6&spx=%2F&flow=xtls-rprx-vision#dw-8016999764
2026-02-13 17:34:29,432 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:34:29,432 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:34:29,432 - sqlalchemy.engine.Engine - INFO - [cached since 68.28s ago] (7946439246,)
2026-02-13 17:34:29,433 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 17:34:29,433 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:34:29,434 - sqlalchemy.engine.Engine - INFO - [cached since 68.29s ago] (8016999764,)
2026-02-13 17:34:29,435 - sqlalchemy.engine.Engine - INFO - SELECT referals.id, referals.ref_tg_id, referals.invited_by_tg_id, referals.bonus_given, referals.user_id 
FROM referals 
WHERE referals.ref_tg_id = ?
2026-02-13 17:34:29,435 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] (8016999764,)
2026-02-13 17:34:29,437 - sqlalchemy.engine.Engine - INFO - INSERT INTO referals (ref_tg_id, invited_by_tg_id, bonus_given, user_id) VALUES (?, ?, ?, ?)
2026-02-13 17:34:29,438 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (8016999764, 7946439246, 0, 2)
2026-02-13 17:34:29,439 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 17:34:29,449 - common.handler - INFO - Создан реферал для пользователя: 8016999764 приглашённым пользователем: 7946439246
2026-02-13 17:34:29,449 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:34:29,450 - sqlalchemy.engine.Engine - INFO - SELECT referals.id, referals.ref_tg_id, referals.invited_by_tg_id, referals.bonus_given, referals.user_id 
FROM referals 
WHERE referals.ref_tg_id = ?
2026-02-13 17:34:29,450 - sqlalchemy.engine.Engine - INFO - [cached since 0.01505s ago] (8016999764,)
2026-02-13 17:34:29,451 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 17:34:29,451 - sqlalchemy.engine.Engine - INFO - [cached since 62.34s ago] (7946439246,)
2026-02-13 17:34:29,452 - sqlalchemy.engine.Engine - INFO - UPDATE referals SET bonus_given=? WHERE referals.id = ?
2026-02-13 17:34:29,453 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] (1, 1)
2026-02-13 17:34:29,454 - sqlalchemy.engine.Engine - INFO - UPDATE subscriptions SET expired=? WHERE subscriptions.id = ?
2026-02-13 17:34:29,455 - sqlalchemy.engine.Engine - INFO - [cached since 41.07s ago] ('2026-03-23 14:33:21.140000', 1)
2026-02-13 17:34:29,456 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 17:34:29,465 - py3xui.async_api.async_api_base - INFO - Updating inbound: enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='xby5s6el', enable=True, id='35673e88-11b5-414f-8589-3753cee3cebc', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id=0, total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce', password='', inbound_id=None, up=0, down=0, expiry_time=1774276401140, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None), Client(email='8016999764', enable=True, id='e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b', password='', inbound_id=None, up=0, down=0, expiry_time=1771252466237, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.microsoft.com:443', 'serverNames': ['www.microsoft.com', 'microsoft.com'], 'privateKey': 'wGSguAfvvojJdB2bJs4ljqcfu9evgQ0lWy9PKFQ_RWQ', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['b6', '6277', '30392505828128f3', '03bd010ab5fda2', 'e7c6bc', '42a1415d', 'a4639daea3', '2285c8b3a1e9'], 'mldsa65Seed': 'ZaTy4HSxx9T5ARzG0QB6hVpoTDPqaXtgRF854_immxw', 'settings': {'publicKey': 'f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'aAcpNBQu5sKltzLD2Psfpw_phO57ebdNcorCHbFwv2VSAAaBQ12s5ciJlAlljzcHr81q5uFqmif3PNQfge19Qk72BIVWtzcrTk_8jpCCgLa65dBYeSVWOD02VNARXnIR1XYb-aYrfX2GZJNQljjfGx4sQLV_0Hblz01r4lGuDvG4wc4MKvmbeaiOmWOhBexi5hIy8PvC_EEmGeDyBIiDj_ilqN3V31SrB9PKKDImb9Ci4DrBDG1zLNCssBpw6GxrKvhVFxwac5GGDoBkgrqDD31j94tmv3dJxet_JZgekJ_y3b_PLXuqMDYpxT3PC-IKKHFbjzX3-QRg1MyxIvOlt_5H1_7oT4e_n1sXcNce8aBy6Gav9qf_kdRoSkEyxQ6Xbh9BDs8hbq5g7610L45pGLO5DJF3iKeY5byblqs3Qhcw16JPHkcFiQuQeQKBq7g5hV9b536dBQRE-QGTGqQg9I5MrFuvbLXSQF9846NDQGwyhKuNBKtBpRQLCXYWURwIzLeHsFNXBDhSuIJzPMDPEHAERudXpzyLT77CjOyqoOYFVcJkyUhkYK671IIYnz3YaGphlFchAcG4qmUim9K3mXHL2bAOH12jrwMuapmXcsMErNugs_dwsH-zVSR7esJ2GdziFgU5KgJont8cCOR7Y6dCmCrRTItADkQCJDHLa-Ncx2CnxGAwAq4nK8YktrAAZTPSavDfHZ0Ky_O5QkshUDJKRrcs5ItnL3G3ZnXUHUaRv9p7UX2O3fmMS6YPEF4iVCreak4W-26CSAgUafqQj9VC4fRL525O2Ss86fPGeJ398lv5nzBVp9MZNoeR9PswC-_hovXoVUrIOdfUGnr77EtQU2GBt9V704LTtxEI1Rfpyyf1iurwUez02aEtV4BRa3-MFKGLQ96hE7S63aPIoGEOVqS7i06iEWaLzd8iOzBM849_KYIxF3s6FbfVhKy8NUMaeYx1fiZ-ZhJiK-Fhv4YNIGtkBAFlxwGKjG9u9wlDCnrPzmmVkPC7lgwl5NcpJXrkWwbfmuvPTwg8xrScW1iVuwBNmZYi8BTVXC0PPn_iFIWz--sQ1AQZ3vjrTLbpcFylbkMrdKCJcnEUaYvcopGQVTyJo5Pi2zeZBhlwiC07IqXIlwFquX0py5DCYcNd-379ryjK7jc5HMNeXWtE99TrqprZ0_L_EzD4DRlE_SkJyPDHn0t0YISmjBOXMKynt7X7gAFHHsxaxOxie7AMlaS3t0LKar47gDtZiWKVv0yVIXgjjeiak8zVjsRUcFOq30ziVY353WFy8ZAfgXoiSsfVFCszIhVYzgPK48j7_oJDRztbD8w3dRQ98NpfV9SVRkktQcBPVfx3plTE28H_V7eSZ0mNtSlg5wkpUazKWnezDwYB9YpWoMu4g3FH7yXI3oyRCiJDFWECaQt9Zvz0otf2LpHVbqs0VocrSu0ZZ5wls0u36eqc9TrgYYzvrPgWkfu73pQLt6XKcTV2h0oqRNEkITyitdwTkJUQCmryAMp9s5kXyRi8tWhFRSWTUMzkCRWBoXOas2sJW86O9mJfEImxAHOyodJvodkmiyWaomablqq-KEAMBa835ZD7XBBGstgj9KCWnhfxslhZiYrECo3mdiCt8U-Ffp9bN2lKawsk4lxLWymMgIGJxLnXAKij_bvC0bppxAdBwrZr5u6enSMdnnEXfLGwLY-GlzGdLo1hsjO49WzE7OskNRXH5-D_f0NFkdBrCZaNOd_769Kslbm9p9uxDuJWtsy5eY_0G7S8L1q3c6XkCG2YxZ0FtFtOiGVRspvYAfBKtAC5CD0Z6G9gD4uG66OsTfiamYU6Te4Sdly33pTB9N9VLHTBgQW9zJp9aiTHPifwBD2YQ5TYgdYZzppBCw3F9DHB_7XpXp4dJt8WRziuJGvqRCws63Kj3gfhJANH9QH8iqiVLUL9zhj-xWLMYKHN-VGCOIUyIgcb-XXIXjdWaP-T-OxEUJOiDaH6QXv7fPE5YwPB1ivTb2bXVaz9Ehivi5--zqCo4Tkwa-1tU-flGDnUsmgSD4G8wExai7JK67UtQszndV73uGFZcI4DhyY0On2a8irY-BJhbQRGo1YLGjns2vGs3H-AcWNTwKSB00aarIlMnG65Dplpboefcrk5aTqXNC1C5I1Ub9CE6Dec5FAHY2J-ApHL10A58mxAr1hYARUFSATUlOmzBz-jGe5nh2ZNINGhZ25mkoltwyex0PuNxdwytMwongFuu3Pf8vRuRAr_Wfl1yMipGMM_tihXfAkuCVtUqSpz2n-n-8A_Dw63jAJ6KUxFozI5CLGuKGSNvsqo3nkHpb2WHYZO_xRjX0UBQQec_LoQ1TY1WGUo7mpO93Z46zthwKW_8NQxC-nBz9zmQrd3g4IPp0ZrfO2zNNeeh-883igx3KrjQv1U2NUW4hHiWKkxF3EzvYbd4wCR0SR7E6D-IjLB6k1dkm0jjyl-5bxk5mW6Ilt1fkYawFnIdRh3HMSBxZaQo1hlKEJq0mQ5iL4M26PINpPFVcDr3jiCmzY1zA7Nefqn0yAastVNS0JB5HHFd9mKRfQSN1Os0dStuMTBuMDoU38lNI1aN32HZjuXxh4'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=42 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='xby5s6el', enable=True, id=263, password='', inbound_id=42, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id='', total_gb=0, uuid='35673e88-11b5-414f-8589-3753cee3cebc'), Client(email='7946439246', enable=True, id=264, password='', inbound_id=42, up=0, down=0, expiry_time=1771252401140, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce')] tag='inbound-443'
2026-02-13 17:34:30,261 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/update/42 "HTTP/1.1 200 OK"
2026-02-13 17:34:30,263 - py3xui.async_api.async_api_base - INFO - Inbound updated successfully.
2026-02-13 17:34:30,263 - common.handler - INFO - Реферальный бонус применён для пользователя: 7946439246 за приглашённого пользователя: 8016999764
2026-02-13 17:34:30,264 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:34:30,264 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:34:30,265 - sqlalchemy.engine.Engine - INFO - [cached since 69.12s ago] (7946439246,)
2026-02-13 17:34:30,265 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 17:34:30,266 - sqlalchemy.engine.Engine - INFO - UPDATE users SET referal_count=? WHERE users.id = ?
2026-02-13 17:34:30,266 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (1, 1)
2026-02-13 17:34:30,268 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 17:34:30,281 - ServiceClasses.user_service - INFO - Счётчик рефералов для пользователя 7946439246 увеличен. Новое значение: 1
2026-02-13 17:34:30,524 - aiogram.event - INFO - Update id=66294974 is handled. Duration 4287 ms by bot id=8543122898
2026-02-13 17:38:36,500 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 17:38:36,501 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 17:38:36,501 - sqlalchemy.engine.Engine - INFO - [cached since 315.4s ago] (7946439246,)
2026-02-13 17:38:36,502 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 17:38:36,502 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-13 17:38:36,502 - sqlalchemy.engine.Engine - INFO - [cached since 300.8s ago] (1,)
2026-02-13 17:38:36,503 - ServiceClasses.shoping_service - INFO - Получено 1 покупок для пользователя 1
2026-02-13 17:38:36,693 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 17:38:36,694 - aiogram.event - INFO - Update id=66294975 is handled. Duration 194 ms by bot id=8543122898
2026-02-13 17:59:35,717 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 17:59:35,718 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 17:59:35,718 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 17:59:35,976 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:08:06,853 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:08:07,758 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:08:07,759 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:08:07,760 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:08:07,760 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:08:08,794 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:08:08,901 - aiogram.dispatcher - INFO - Start polling
2026-02-13 18:08:08,999 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:08:13,204 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:08:13,204 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-13 18:08:13,205 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 18:08:13,206 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-13 18:08:13,206 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 18:08:13,207 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-13 18:08:13,207 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 18:08:13,207 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-13 18:08:13,208 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 18:08:13,208 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-13 18:08:13,208 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-13 18:08:13,220 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-13 18:08:13,221 - sqlalchemy.engine.Engine - INFO - [no key 0.00044s] ()
2026-02-13 18:08:13,231 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-13 18:08:13,231 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-13 18:08:13,241 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-13 18:08:13,241 - sqlalchemy.engine.Engine - INFO - [no key 0.00037s] ()
2026-02-13 18:08:13,252 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-13 18:08:13,252 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 18:08:13,253 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-13 18:08:13,254 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 18:08:13,255 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-13 18:08:13,255 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 18:08:13,256 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-13 18:08:13,256 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 18:08:13,256 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-13 18:08:13,257 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 18:08:13,257 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-13 18:08:13,257 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 18:08:13,258 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-13 18:08:13,258 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 18:08:13,259 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-13 18:08:13,260 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 18:08:13,261 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-13 18:08:13,261 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-13 18:08:13,272 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-13 18:08:13,272 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2026-02-13 18:08:13,284 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-13 18:08:13,284 - sqlalchemy.engine.Engine - INFO - [no key 0.00036s] ()
2026-02-13 18:08:13,295 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-13 18:08:13,296 - sqlalchemy.engine.Engine - INFO - [no key 0.00099s] ()
2026-02-13 18:08:13,307 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-13 18:08:13,307 - sqlalchemy.engine.Engine - INFO - [no key 0.00045s] ()
2026-02-13 18:08:13,318 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-13 18:08:13,318 - sqlalchemy.engine.Engine - INFO - [no key 0.00035s] ()
2026-02-13 18:08:13,329 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 18:08:13,329 - aiogram.event - INFO - Update id=66294976 is handled. Duration 809 ms by bot id=8543122898
2026-02-13 18:08:16,557 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:08:16,564 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:08:16,564 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (7946439246,)
2026-02-13 18:08:16,567 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-13 18:08:16,567 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] (7946439246, '2026-02-13 18:08:16.566025', 0)
2026-02-13 18:08:16,570 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 18:08:16,577 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-13 18:08:16,577 - common.handler - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-13 18:08:16,577 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:08:17,698 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:08:17,700 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:08:17,700 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:08:17,700 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:08:18,558 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:08:18,561 - common.handler - INFO - Inbound enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='xby5s6el', enable=True, id='35673e88-11b5-414f-8589-3753cee3cebc', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id=0, total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce', password='', inbound_id=None, up=0, down=0, expiry_time=1774276401140, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None), Client(email='8016999764', enable=True, id='e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b', password='', inbound_id=None, up=0, down=0, expiry_time=1771252466237, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.microsoft.com:443', 'serverNames': ['www.microsoft.com', 'microsoft.com'], 'privateKey': 'wGSguAfvvojJdB2bJs4ljqcfu9evgQ0lWy9PKFQ_RWQ', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['b6', '6277', '30392505828128f3', '03bd010ab5fda2', 'e7c6bc', '42a1415d', 'a4639daea3', '2285c8b3a1e9'], 'mldsa65Seed': 'ZaTy4HSxx9T5ARzG0QB6hVpoTDPqaXtgRF854_immxw', 'settings': {'publicKey': 'f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'aAcpNBQu5sKltzLD2Psfpw_phO57ebdNcorCHbFwv2VSAAaBQ12s5ciJlAlljzcHr81q5uFqmif3PNQfge19Qk72BIVWtzcrTk_8jpCCgLa65dBYeSVWOD02VNARXnIR1XYb-aYrfX2GZJNQljjfGx4sQLV_0Hblz01r4lGuDvG4wc4MKvmbeaiOmWOhBexi5hIy8PvC_EEmGeDyBIiDj_ilqN3V31SrB9PKKDImb9Ci4DrBDG1zLNCssBpw6GxrKvhVFxwac5GGDoBkgrqDD31j94tmv3dJxet_JZgekJ_y3b_PLXuqMDYpxT3PC-IKKHFbjzX3-QRg1MyxIvOlt_5H1_7oT4e_n1sXcNce8aBy6Gav9qf_kdRoSkEyxQ6Xbh9BDs8hbq5g7610L45pGLO5DJF3iKeY5byblqs3Qhcw16JPHkcFiQuQeQKBq7g5hV9b536dBQRE-QGTGqQg9I5MrFuvbLXSQF9846NDQGwyhKuNBKtBpRQLCXYWURwIzLeHsFNXBDhSuIJzPMDPEHAERudXpzyLT77CjOyqoOYFVcJkyUhkYK671IIYnz3YaGphlFchAcG4qmUim9K3mXHL2bAOH12jrwMuapmXcsMErNugs_dwsH-zVSR7esJ2GdziFgU5KgJont8cCOR7Y6dCmCrRTItADkQCJDHLa-Ncx2CnxGAwAq4nK8YktrAAZTPSavDfHZ0Ky_O5QkshUDJKRrcs5ItnL3G3ZnXUHUaRv9p7UX2O3fmMS6YPEF4iVCreak4W-26CSAgUafqQj9VC4fRL525O2Ss86fPGeJ398lv5nzBVp9MZNoeR9PswC-_hovXoVUrIOdfUGnr77EtQU2GBt9V704LTtxEI1Rfpyyf1iurwUez02aEtV4BRa3-MFKGLQ96hE7S63aPIoGEOVqS7i06iEWaLzd8iOzBM849_KYIxF3s6FbfVhKy8NUMaeYx1fiZ-ZhJiK-Fhv4YNIGtkBAFlxwGKjG9u9wlDCnrPzmmVkPC7lgwl5NcpJXrkWwbfmuvPTwg8xrScW1iVuwBNmZYi8BTVXC0PPn_iFIWz--sQ1AQZ3vjrTLbpcFylbkMrdKCJcnEUaYvcopGQVTyJo5Pi2zeZBhlwiC07IqXIlwFquX0py5DCYcNd-379ryjK7jc5HMNeXWtE99TrqprZ0_L_EzD4DRlE_SkJyPDHn0t0YISmjBOXMKynt7X7gAFHHsxaxOxie7AMlaS3t0LKar47gDtZiWKVv0yVIXgjjeiak8zVjsRUcFOq30ziVY353WFy8ZAfgXoiSsfVFCszIhVYzgPK48j7_oJDRztbD8w3dRQ98NpfV9SVRkktQcBPVfx3plTE28H_V7eSZ0mNtSlg5wkpUazKWnezDwYB9YpWoMu4g3FH7yXI3oyRCiJDFWECaQt9Zvz0otf2LpHVbqs0VocrSu0ZZ5wls0u36eqc9TrgYYzvrPgWkfu73pQLt6XKcTV2h0oqRNEkITyitdwTkJUQCmryAMp9s5kXyRi8tWhFRSWTUMzkCRWBoXOas2sJW86O9mJfEImxAHOyodJvodkmiyWaomablqq-KEAMBa835ZD7XBBGstgj9KCWnhfxslhZiYrECo3mdiCt8U-Ffp9bN2lKawsk4lxLWymMgIGJxLnXAKij_bvC0bppxAdBwrZr5u6enSMdnnEXfLGwLY-GlzGdLo1hsjO49WzE7OskNRXH5-D_f0NFkdBrCZaNOd_769Kslbm9p9uxDuJWtsy5eY_0G7S8L1q3c6XkCG2YxZ0FtFtOiGVRspvYAfBKtAC5CD0Z6G9gD4uG66OsTfiamYU6Te4Sdly33pTB9N9VLHTBgQW9zJp9aiTHPifwBD2YQ5TYgdYZzppBCw3F9DHB_7XpXp4dJt8WRziuJGvqRCws63Kj3gfhJANH9QH8iqiVLUL9zhj-xWLMYKHN-VGCOIUyIgcb-XXIXjdWaP-T-OxEUJOiDaH6QXv7fPE5YwPB1ivTb2bXVaz9Ehivi5--zqCo4Tkwa-1tU-flGDnUsmgSD4G8wExai7JK67UtQszndV73uGFZcI4DhyY0On2a8irY-BJhbQRGo1YLGjns2vGs3H-AcWNTwKSB00aarIlMnG65Dplpboefcrk5aTqXNC1C5I1Ub9CE6Dec5FAHY2J-ApHL10A58mxAr1hYARUFSATUlOmzBz-jGe5nh2ZNINGhZ25mkoltwyex0PuNxdwytMwongFuu3Pf8vRuRAr_Wfl1yMipGMM_tihXfAkuCVtUqSpz2n-n-8A_Dw63jAJ6KUxFozI5CLGuKGSNvsqo3nkHpb2WHYZO_xRjX0UBQQec_LoQ1TY1WGUo7mpO93Z46zthwKW_8NQxC-nBz9zmQrd3g4IPp0ZrfO2zNNeeh-883igx3KrjQv1U2NUW4hHiWKkxF3EzvYbd4wCR0SR7E6D-IjLB6k1dkm0jjyl-5bxk5mW6Ilt1fkYawFnIdRh3HMSBxZaQo1hlKEJq0mQ5iL4M26PINpPFVcDr3jiCmzY1zA7Nefqn0yAastVNS0JB5HHFd9mKRfQSN1Os0dStuMTBuMDoU38lNI1aN32HZjuXxh4'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=42 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='xby5s6el', enable=True, id=263, password='', inbound_id=42, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id='', total_gb=0, uuid='35673e88-11b5-414f-8589-3753cee3cebc'), Client(email='7946439246', enable=True, id=264, password='', inbound_id=42, up=0, down=0, expiry_time=1771252401140, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce'), Client(email='8016999764', enable=True, id=265, password='', inbound_id=42, up=0, down=0, expiry_time=1771252466237, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b')] tag='inbound-443' инициализирован для пользователя
2026-02-13 18:08:18,562 - ServiceClasses.vpn_service - INFO - Создан VPN клиент для пользователя 7946439246 с истечением через 1771254496557 миллисекунд.
2026-02-13 18:08:18,562 - py3xui.async_api.async_api_base - INFO - Updating inbound: enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='xby5s6el', enable=True, id='35673e88-11b5-414f-8589-3753cee3cebc', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id=0, total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce', password='', inbound_id=None, up=0, down=0, expiry_time=1774276401140, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None), Client(email='8016999764', enable=True, id='e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b', password='', inbound_id=None, up=0, down=0, expiry_time=1771252466237, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='e402d579-a18d-41d2-8bd4-a1512cc323d4', password='', inbound_id=None, up=0, down=0, expiry_time=1771254496557, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.microsoft.com:443', 'serverNames': ['www.microsoft.com', 'microsoft.com'], 'privateKey': 'wGSguAfvvojJdB2bJs4ljqcfu9evgQ0lWy9PKFQ_RWQ', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['b6', '6277', '30392505828128f3', '03bd010ab5fda2', 'e7c6bc', '42a1415d', 'a4639daea3', '2285c8b3a1e9'], 'mldsa65Seed': 'ZaTy4HSxx9T5ARzG0QB6hVpoTDPqaXtgRF854_immxw', 'settings': {'publicKey': 'f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'aAcpNBQu5sKltzLD2Psfpw_phO57ebdNcorCHbFwv2VSAAaBQ12s5ciJlAlljzcHr81q5uFqmif3PNQfge19Qk72BIVWtzcrTk_8jpCCgLa65dBYeSVWOD02VNARXnIR1XYb-aYrfX2GZJNQljjfGx4sQLV_0Hblz01r4lGuDvG4wc4MKvmbeaiOmWOhBexi5hIy8PvC_EEmGeDyBIiDj_ilqN3V31SrB9PKKDImb9Ci4DrBDG1zLNCssBpw6GxrKvhVFxwac5GGDoBkgrqDD31j94tmv3dJxet_JZgekJ_y3b_PLXuqMDYpxT3PC-IKKHFbjzX3-QRg1MyxIvOlt_5H1_7oT4e_n1sXcNce8aBy6Gav9qf_kdRoSkEyxQ6Xbh9BDs8hbq5g7610L45pGLO5DJF3iKeY5byblqs3Qhcw16JPHkcFiQuQeQKBq7g5hV9b536dBQRE-QGTGqQg9I5MrFuvbLXSQF9846NDQGwyhKuNBKtBpRQLCXYWURwIzLeHsFNXBDhSuIJzPMDPEHAERudXpzyLT77CjOyqoOYFVcJkyUhkYK671IIYnz3YaGphlFchAcG4qmUim9K3mXHL2bAOH12jrwMuapmXcsMErNugs_dwsH-zVSR7esJ2GdziFgU5KgJont8cCOR7Y6dCmCrRTItADkQCJDHLa-Ncx2CnxGAwAq4nK8YktrAAZTPSavDfHZ0Ky_O5QkshUDJKRrcs5ItnL3G3ZnXUHUaRv9p7UX2O3fmMS6YPEF4iVCreak4W-26CSAgUafqQj9VC4fRL525O2Ss86fPGeJ398lv5nzBVp9MZNoeR9PswC-_hovXoVUrIOdfUGnr77EtQU2GBt9V704LTtxEI1Rfpyyf1iurwUez02aEtV4BRa3-MFKGLQ96hE7S63aPIoGEOVqS7i06iEWaLzd8iOzBM849_KYIxF3s6FbfVhKy8NUMaeYx1fiZ-ZhJiK-Fhv4YNIGtkBAFlxwGKjG9u9wlDCnrPzmmVkPC7lgwl5NcpJXrkWwbfmuvPTwg8xrScW1iVuwBNmZYi8BTVXC0PPn_iFIWz--sQ1AQZ3vjrTLbpcFylbkMrdKCJcnEUaYvcopGQVTyJo5Pi2zeZBhlwiC07IqXIlwFquX0py5DCYcNd-379ryjK7jc5HMNeXWtE99TrqprZ0_L_EzD4DRlE_SkJyPDHn0t0YISmjBOXMKynt7X7gAFHHsxaxOxie7AMlaS3t0LKar47gDtZiWKVv0yVIXgjjeiak8zVjsRUcFOq30ziVY353WFy8ZAfgXoiSsfVFCszIhVYzgPK48j7_oJDRztbD8w3dRQ98NpfV9SVRkktQcBPVfx3plTE28H_V7eSZ0mNtSlg5wkpUazKWnezDwYB9YpWoMu4g3FH7yXI3oyRCiJDFWECaQt9Zvz0otf2LpHVbqs0VocrSu0ZZ5wls0u36eqc9TrgYYzvrPgWkfu73pQLt6XKcTV2h0oqRNEkITyitdwTkJUQCmryAMp9s5kXyRi8tWhFRSWTUMzkCRWBoXOas2sJW86O9mJfEImxAHOyodJvodkmiyWaomablqq-KEAMBa835ZD7XBBGstgj9KCWnhfxslhZiYrECo3mdiCt8U-Ffp9bN2lKawsk4lxLWymMgIGJxLnXAKij_bvC0bppxAdBwrZr5u6enSMdnnEXfLGwLY-GlzGdLo1hsjO49WzE7OskNRXH5-D_f0NFkdBrCZaNOd_769Kslbm9p9uxDuJWtsy5eY_0G7S8L1q3c6XkCG2YxZ0FtFtOiGVRspvYAfBKtAC5CD0Z6G9gD4uG66OsTfiamYU6Te4Sdly33pTB9N9VLHTBgQW9zJp9aiTHPifwBD2YQ5TYgdYZzppBCw3F9DHB_7XpXp4dJt8WRziuJGvqRCws63Kj3gfhJANH9QH8iqiVLUL9zhj-xWLMYKHN-VGCOIUyIgcb-XXIXjdWaP-T-OxEUJOiDaH6QXv7fPE5YwPB1ivTb2bXVaz9Ehivi5--zqCo4Tkwa-1tU-flGDnUsmgSD4G8wExai7JK67UtQszndV73uGFZcI4DhyY0On2a8irY-BJhbQRGo1YLGjns2vGs3H-AcWNTwKSB00aarIlMnG65Dplpboefcrk5aTqXNC1C5I1Ub9CE6Dec5FAHY2J-ApHL10A58mxAr1hYARUFSATUlOmzBz-jGe5nh2ZNINGhZ25mkoltwyex0PuNxdwytMwongFuu3Pf8vRuRAr_Wfl1yMipGMM_tihXfAkuCVtUqSpz2n-n-8A_Dw63jAJ6KUxFozI5CLGuKGSNvsqo3nkHpb2WHYZO_xRjX0UBQQec_LoQ1TY1WGUo7mpO93Z46zthwKW_8NQxC-nBz9zmQrd3g4IPp0ZrfO2zNNeeh-883igx3KrjQv1U2NUW4hHiWKkxF3EzvYbd4wCR0SR7E6D-IjLB6k1dkm0jjyl-5bxk5mW6Ilt1fkYawFnIdRh3HMSBxZaQo1hlKEJq0mQ5iL4M26PINpPFVcDr3jiCmzY1zA7Nefqn0yAastVNS0JB5HHFd9mKRfQSN1Os0dStuMTBuMDoU38lNI1aN32HZjuXxh4'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=42 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='xby5s6el', enable=True, id=263, password='', inbound_id=42, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id='', total_gb=0, uuid='35673e88-11b5-414f-8589-3753cee3cebc'), Client(email='7946439246', enable=True, id=264, password='', inbound_id=42, up=0, down=0, expiry_time=1771252401140, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce'), Client(email='8016999764', enable=True, id=265, password='', inbound_id=42, up=0, down=0, expiry_time=1771252466237, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b')] tag='inbound-443'
2026-02-13 18:08:19,413 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/update/42 "HTTP/1.1 200 OK"
2026-02-13 18:08:19,415 - py3xui.async_api.async_api_base - INFO - Inbound updated successfully.
2026-02-13 18:08:19,415 - common.handler - INFO - Клиент создан для пользователя: 7946439246 с именем: 7946439246
2026-02-13 18:08:19,415 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:08:19,416 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:08:19,416 - sqlalchemy.engine.Engine - INFO - [cached since 2.852s ago] (7946439246,)
2026-02-13 18:08:19,417 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, "key", uuid, expired, user_id) VALUES (?, ?, ?, ?, ?)
2026-02-13 18:08:19,418 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] (7946439246, 'vless://e402d579-a18d-41d2-8bd4-a1512cc323d4@94.183.186.146:443?type=tcp&encryption=none&security=reality&pbk=f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M&fp=chrome&sni=www.microsoft.com&sid=b6&spx=%2F&flow=xtls-rprx-vision#dw-7946439246', 'e402d579-a18d-41d2-8bd4-a1512cc323d4', '2026-02-16 15:08:16.557000', 1)
2026-02-13 18:08:19,419 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 18:08:19,429 - common.handler - INFO - Подписка создана для пользователя: 7946439246 с ключом: vless://e402d579-a18d-41d2-8bd4-a1512cc323d4@94.183.186.146:443?type=tcp&encryption=none&security=reality&pbk=f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M&fp=chrome&sni=www.microsoft.com&sid=b6&spx=%2F&flow=xtls-rprx-vision#dw-7946439246
2026-02-13 18:08:19,637 - aiogram.event - INFO - Update id=66294977 is handled. Duration 3079 ms by bot id=8543122898
2026-02-13 18:08:21,765 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:08:21,766 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 18:08:21,767 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] (7946439246,)
2026-02-13 18:08:21,895 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:08:21,895 - aiogram.event - INFO - Update id=66294978 is handled. Duration 130 ms by bot id=8543122898
2026-02-13 18:08:26,358 - aiogram.event - INFO - Update id=66294979 is handled. Duration 225 ms by bot id=8543122898
2026-02-13 18:08:27,460 - aiogram.event - INFO - Update id=66294980 is handled. Duration 216 ms by bot id=8543122898
2026-02-13 18:08:34,880 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:08:34,881 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 18:08:34,881 - sqlalchemy.engine.Engine - INFO - [cached since 13.11s ago] (7946439246,)
2026-02-13 18:08:34,882 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:08:36,731 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:08:36,733 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:08:36,733 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:08:36,733 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:08:37,768 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:08:37,769 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:08:37,770 - sqlalchemy.engine.Engine - INFO - [cached since 21.21s ago] (7946439246,)
2026-02-13 18:08:37,771 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:08:37,771 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:08:37,967 - aiogram.event - INFO - Update id=66294982 is handled. Duration 201 ms by bot id=8543122898
2026-02-13 18:08:39,229 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:08:39,229 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:08:39,230 - sqlalchemy.engine.Engine - INFO - [cached since 22.67s ago] (7946439246,)
2026-02-13 18:08:39,231 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:08:39,231 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-13 18:08:39,232 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (1,)
2026-02-13 18:08:39,232 - ServiceClasses.shoping_service - INFO - Получено 0 покупок для пользователя 1
2026-02-13 18:08:39,427 - common.handler - INFO - Пользователь 7946439246 запросил историю покупок, но покупок не найдено.
2026-02-13 18:08:39,428 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:08:39,428 - aiogram.event - INFO - Update id=66294983 is handled. Duration 200 ms by bot id=8543122898
2026-02-13 18:08:39,690 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:08:39,693 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 18:08:39,693 - sqlalchemy.engine.Engine - INFO - [cached since 17.93s ago] (7946439246,)
2026-02-13 18:08:39,694 - py3xui.async_api.async_api_base - INFO - Updating inbound: enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='xby5s6el', enable=True, id='35673e88-11b5-414f-8589-3753cee3cebc', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id=0, total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce', password='', inbound_id=None, up=0, down=0, expiry_time=1774276401140, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None), Client(email='8016999764', enable=True, id='e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b', password='', inbound_id=None, up=0, down=0, expiry_time=1771252466237, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='e402d579-a18d-41d2-8bd4-a1512cc323d4', password='', inbound_id=None, up=0, down=0, expiry_time=1773846496557, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.microsoft.com:443', 'serverNames': ['www.microsoft.com', 'microsoft.com'], 'privateKey': 'wGSguAfvvojJdB2bJs4ljqcfu9evgQ0lWy9PKFQ_RWQ', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['b6', '6277', '30392505828128f3', '03bd010ab5fda2', 'e7c6bc', '42a1415d', 'a4639daea3', '2285c8b3a1e9'], 'mldsa65Seed': 'ZaTy4HSxx9T5ARzG0QB6hVpoTDPqaXtgRF854_immxw', 'settings': {'publicKey': 'f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'aAcpNBQu5sKltzLD2Psfpw_phO57ebdNcorCHbFwv2VSAAaBQ12s5ciJlAlljzcHr81q5uFqmif3PNQfge19Qk72BIVWtzcrTk_8jpCCgLa65dBYeSVWOD02VNARXnIR1XYb-aYrfX2GZJNQljjfGx4sQLV_0Hblz01r4lGuDvG4wc4MKvmbeaiOmWOhBexi5hIy8PvC_EEmGeDyBIiDj_ilqN3V31SrB9PKKDImb9Ci4DrBDG1zLNCssBpw6GxrKvhVFxwac5GGDoBkgrqDD31j94tmv3dJxet_JZgekJ_y3b_PLXuqMDYpxT3PC-IKKHFbjzX3-QRg1MyxIvOlt_5H1_7oT4e_n1sXcNce8aBy6Gav9qf_kdRoSkEyxQ6Xbh9BDs8hbq5g7610L45pGLO5DJF3iKeY5byblqs3Qhcw16JPHkcFiQuQeQKBq7g5hV9b536dBQRE-QGTGqQg9I5MrFuvbLXSQF9846NDQGwyhKuNBKtBpRQLCXYWURwIzLeHsFNXBDhSuIJzPMDPEHAERudXpzyLT77CjOyqoOYFVcJkyUhkYK671IIYnz3YaGphlFchAcG4qmUim9K3mXHL2bAOH12jrwMuapmXcsMErNugs_dwsH-zVSR7esJ2GdziFgU5KgJont8cCOR7Y6dCmCrRTItADkQCJDHLa-Ncx2CnxGAwAq4nK8YktrAAZTPSavDfHZ0Ky_O5QkshUDJKRrcs5ItnL3G3ZnXUHUaRv9p7UX2O3fmMS6YPEF4iVCreak4W-26CSAgUafqQj9VC4fRL525O2Ss86fPGeJ398lv5nzBVp9MZNoeR9PswC-_hovXoVUrIOdfUGnr77EtQU2GBt9V704LTtxEI1Rfpyyf1iurwUez02aEtV4BRa3-MFKGLQ96hE7S63aPIoGEOVqS7i06iEWaLzd8iOzBM849_KYIxF3s6FbfVhKy8NUMaeYx1fiZ-ZhJiK-Fhv4YNIGtkBAFlxwGKjG9u9wlDCnrPzmmVkPC7lgwl5NcpJXrkWwbfmuvPTwg8xrScW1iVuwBNmZYi8BTVXC0PPn_iFIWz--sQ1AQZ3vjrTLbpcFylbkMrdKCJcnEUaYvcopGQVTyJo5Pi2zeZBhlwiC07IqXIlwFquX0py5DCYcNd-379ryjK7jc5HMNeXWtE99TrqprZ0_L_EzD4DRlE_SkJyPDHn0t0YISmjBOXMKynt7X7gAFHHsxaxOxie7AMlaS3t0LKar47gDtZiWKVv0yVIXgjjeiak8zVjsRUcFOq30ziVY353WFy8ZAfgXoiSsfVFCszIhVYzgPK48j7_oJDRztbD8w3dRQ98NpfV9SVRkktQcBPVfx3plTE28H_V7eSZ0mNtSlg5wkpUazKWnezDwYB9YpWoMu4g3FH7yXI3oyRCiJDFWECaQt9Zvz0otf2LpHVbqs0VocrSu0ZZ5wls0u36eqc9TrgYYzvrPgWkfu73pQLt6XKcTV2h0oqRNEkITyitdwTkJUQCmryAMp9s5kXyRi8tWhFRSWTUMzkCRWBoXOas2sJW86O9mJfEImxAHOyodJvodkmiyWaomablqq-KEAMBa835ZD7XBBGstgj9KCWnhfxslhZiYrECo3mdiCt8U-Ffp9bN2lKawsk4lxLWymMgIGJxLnXAKij_bvC0bppxAdBwrZr5u6enSMdnnEXfLGwLY-GlzGdLo1hsjO49WzE7OskNRXH5-D_f0NFkdBrCZaNOd_769Kslbm9p9uxDuJWtsy5eY_0G7S8L1q3c6XkCG2YxZ0FtFtOiGVRspvYAfBKtAC5CD0Z6G9gD4uG66OsTfiamYU6Te4Sdly33pTB9N9VLHTBgQW9zJp9aiTHPifwBD2YQ5TYgdYZzppBCw3F9DHB_7XpXp4dJt8WRziuJGvqRCws63Kj3gfhJANH9QH8iqiVLUL9zhj-xWLMYKHN-VGCOIUyIgcb-XXIXjdWaP-T-OxEUJOiDaH6QXv7fPE5YwPB1ivTb2bXVaz9Ehivi5--zqCo4Tkwa-1tU-flGDnUsmgSD4G8wExai7JK67UtQszndV73uGFZcI4DhyY0On2a8irY-BJhbQRGo1YLGjns2vGs3H-AcWNTwKSB00aarIlMnG65Dplpboefcrk5aTqXNC1C5I1Ub9CE6Dec5FAHY2J-ApHL10A58mxAr1hYARUFSATUlOmzBz-jGe5nh2ZNINGhZ25mkoltwyex0PuNxdwytMwongFuu3Pf8vRuRAr_Wfl1yMipGMM_tihXfAkuCVtUqSpz2n-n-8A_Dw63jAJ6KUxFozI5CLGuKGSNvsqo3nkHpb2WHYZO_xRjX0UBQQec_LoQ1TY1WGUo7mpO93Z46zthwKW_8NQxC-nBz9zmQrd3g4IPp0ZrfO2zNNeeh-883igx3KrjQv1U2NUW4hHiWKkxF3EzvYbd4wCR0SR7E6D-IjLB6k1dkm0jjyl-5bxk5mW6Ilt1fkYawFnIdRh3HMSBxZaQo1hlKEJq0mQ5iL4M26PINpPFVcDr3jiCmzY1zA7Nefqn0yAastVNS0JB5HHFd9mKRfQSN1Os0dStuMTBuMDoU38lNI1aN32HZjuXxh4'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=42 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='xby5s6el', enable=True, id=263, password='', inbound_id=42, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id='', total_gb=0, uuid='35673e88-11b5-414f-8589-3753cee3cebc'), Client(email='7946439246', enable=True, id=264, password='', inbound_id=42, up=0, down=0, expiry_time=1771252401140, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='e402d579-a18d-41d2-8bd4-a1512cc323d4'), Client(email='8016999764', enable=True, id=265, password='', inbound_id=42, up=0, down=0, expiry_time=1771252466237, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b')] tag='inbound-443'
2026-02-13 18:08:40,767 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/update/42 "HTTP/1.1 200 OK"
2026-02-13 18:08:40,769 - py3xui.async_api.async_api_base - INFO - Inbound updated successfully.
2026-02-13 18:08:40,770 - sqlalchemy.engine.Engine - INFO - UPDATE subscriptions SET expired=? WHERE subscriptions.id = ?
2026-02-13 18:08:40,770 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] ('2026-03-18 15:08:16.557000', 1)
2026-02-13 18:08:40,771 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 18:08:40,782 - common.handler - INFO - Подписка продлена на 30 дней для пользователя: 7946439246
2026-02-13 18:08:40,783 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:08:40,783 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:08:40,783 - sqlalchemy.engine.Engine - INFO - [cached since 24.22s ago] (7946439246,)
2026-02-13 18:08:40,784 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:08:40,785 - sqlalchemy.engine.Engine - INFO - INSERT INTO shoping (money, shop_date, user_id) VALUES (?, ?, ?)
2026-02-13 18:08:40,785 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (149, '2026-02-13 15:08', 1)
2026-02-13 18:08:40,786 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 18:08:40,796 - ServiceClasses.shoping_service - INFO - Покупка создана: пользователь 1, сумма 149 Р., дата 2026-02-13 15:08
2026-02-13 18:08:40,796 - common.handler - INFO - Запись о покупке добавлена для пользователя: 7946439246 с суммой: 149 Р. и датой: 2026-02-13 15:08
2026-02-13 18:08:40,796 - aiogram.event - INFO - Update id=66294981 is handled. Duration 6034 ms by bot id=8543122898
2026-02-13 18:08:40,883 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:08:40,883 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:08:40,884 - sqlalchemy.engine.Engine - INFO - [cached since 24.32s ago] (7946439246,)
2026-02-13 18:08:40,884 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:08:40,885 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-13 18:08:40,885 - sqlalchemy.engine.Engine - INFO - [cached since 1.654s ago] (1,)
2026-02-13 18:08:40,886 - ServiceClasses.shoping_service - INFO - Получено 1 покупок для пользователя 1
2026-02-13 18:08:41,074 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:08:41,075 - aiogram.event - INFO - Update id=66294984 is handled. Duration 192 ms by bot id=8543122898
2026-02-13 18:08:42,410 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:08:42,410 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 18:08:42,411 - sqlalchemy.engine.Engine - INFO - [cached since 20.64s ago] (7946439246,)
2026-02-13 18:08:42,655 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:08:42,656 - aiogram.event - INFO - Update id=66294985 is handled. Duration 247 ms by bot id=8543122898
2026-02-13 18:14:45,085 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 18:14:45,086 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 18:14:45,086 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 18:14:45,338 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:14:50,859 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:14:53,755 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:14:53,757 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:14:53,757 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:14:53,757 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:14:55,678 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:14:55,787 - aiogram.dispatcher - INFO - Start polling
2026-02-13 18:14:55,884 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:14:55,998 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:14:56,005 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:14:56,006 - sqlalchemy.engine.Engine - INFO - [generated in 0.00138s] (7946439246,)
2026-02-13 18:14:56,008 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:14:56,008 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:14:56,873 - aiogram.event - INFO - Update id=66294987 is handled. Duration 878 ms by bot id=8543122898
2026-02-13 18:19:36,181 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 18:19:36,181 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 18:19:36,182 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 18:19:36,443 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:19:41,826 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:19:44,705 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:19:44,707 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:19:44,707 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:19:44,707 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:19:46,664 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:19:46,780 - aiogram.dispatcher - INFO - Start polling
2026-02-13 18:19:46,886 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:19:57,943 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:19:57,950 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:19:57,950 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] (7946439246,)
2026-02-13 18:19:57,952 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:19:57,953 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:19:58,744 - aiogram.event - INFO - Update id=66294988 is handled. Duration 802 ms by bot id=8543122898
2026-02-13 18:20:57,153 - aiogram.event - INFO - Update id=66294989 is not handled. Duration 0 ms by bot id=8543122898
2026-02-13 18:22:28,748 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 18:22:28,749 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 18:22:28,749 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 18:22:29,000 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:22:33,857 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:22:36,690 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:22:36,691 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:22:36,692 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:22:36,692 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:22:37,564 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:22:37,700 - aiogram.dispatcher - INFO - Start polling
2026-02-13 18:22:37,804 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:22:37,913 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:22:37,921 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:22:37,922 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] (7946439246,)
2026-02-13 18:22:37,924 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:22:37,924 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:22:38,777 - aiogram.event - INFO - Update id=66294991 is handled. Duration 867 ms by bot id=8543122898
2026-02-13 18:24:33,982 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 18:24:33,983 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 18:24:33,983 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 18:24:34,249 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:24:39,045 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:24:41,699 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:24:41,700 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:24:41,700 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:24:41,700 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:24:43,773 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:24:43,892 - aiogram.dispatcher - INFO - Start polling
2026-02-13 18:24:44,506 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:24:56,349 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:24:56,356 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:24:56,357 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] (7946439246,)
2026-02-13 18:24:56,358 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:24:56,358 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:24:57,261 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:24:57,261 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:24:57,262 - sqlalchemy.engine.Engine - INFO - [cached since 0.9055s ago] (7946439246,)
2026-02-13 18:24:57,263 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:24:57,263 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:24:57,264 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:24:57,264 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:24:57,264 - sqlalchemy.engine.Engine - INFO - [cached since 0.9083s ago] (7946439246,)
2026-02-13 18:24:57,267 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:24:57,270 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:24:58,684 - aiogram.event - INFO - Update id=66294994 is handled. Duration 1423 ms by bot id=8543122898
2026-02-13 18:24:58,759 - aiogram.event - INFO - Update id=66294995 is handled. Duration 1497 ms by bot id=8543122898
2026-02-13 18:24:58,814 - aiogram.event - INFO - Update id=66294993 is handled. Duration 2466 ms by bot id=8543122898
2026-02-13 18:25:24,236 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 18:25:24,237 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 18:25:24,237 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 18:25:24,497 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:25:28,705 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:25:29,686 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:25:29,687 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:25:29,687 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:25:29,688 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:25:31,647 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:25:31,800 - aiogram.dispatcher - INFO - Start polling
2026-02-13 18:25:31,913 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:25:32,037 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:25:32,045 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:25:32,045 - sqlalchemy.engine.Engine - INFO - [generated in 0.00050s] (7946439246,)
2026-02-13 18:25:32,047 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:25:32,047 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:25:33,252 - aiogram.event - INFO - Update id=66294998 is handled. Duration 1216 ms by bot id=8543122898
2026-02-13 18:25:51,124 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 18:25:51,124 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 18:25:51,125 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 18:25:51,387 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:25:55,153 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:25:58,796 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:25:58,797 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:25:58,797 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:25:58,798 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:25:59,857 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:26:00,038 - aiogram.dispatcher - INFO - Start polling
2026-02-13 18:26:00,153 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:26:00,289 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:26:00,296 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:26:00,296 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] (7946439246,)
2026-02-13 18:26:00,298 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:26:00,299 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:26:01,291 - aiogram.event - INFO - Update id=66295000 is handled. Duration 1003 ms by bot id=8543122898
2026-02-13 18:26:52,654 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:26:53,691 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:26:53,693 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:26:53,693 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:26:53,693 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:26:54,819 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:26:54,960 - aiogram.dispatcher - INFO - Start polling
2026-02-13 18:26:55,098 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:26:57,836 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:26:57,843 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:26:57,843 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (7946439246,)
2026-02-13 18:26:57,845 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:26:57,845 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:26:58,812 - aiogram.event - INFO - Update id=66295002 is handled. Duration 978 ms by bot id=8543122898
2026-02-13 18:27:12,730 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:27:12,731 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 18:27:12,731 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] (7946439246,)
2026-02-13 18:27:13,002 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:27:13,003 - aiogram.event - INFO - Update id=66295003 is handled. Duration 274 ms by bot id=8543122898
2026-02-13 18:27:21,007 - aiogram.event - INFO - Update id=66295004 is handled. Duration 4719 ms by bot id=8543122898
2026-02-13 18:27:34,082 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:27:34,082 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:27:34,083 - sqlalchemy.engine.Engine - INFO - [cached since 36.24s ago] (7946439246,)
2026-02-13 18:27:34,083 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:27:34,084 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:27:38,432 - aiogram.event - INFO - Update id=66295006 is handled. Duration 4350 ms by bot id=8543122898
2026-02-13 18:27:43,081 - aiogram.event - INFO - Update id=66295007 is not handled. Duration 0 ms by bot id=8543122898
2026-02-13 18:27:45,707 - aiogram.event - INFO - Update id=66295005 is handled. Duration 26240 ms by bot id=8543122898
2026-02-13 18:27:45,708 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:27:45,708 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:27:45,709 - sqlalchemy.engine.Engine - INFO - [cached since 47.87s ago] (7946439246,)
2026-02-13 18:27:45,709 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:27:45,710 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:27:45,710 - sqlalchemy.engine.Engine - INFO - [cached since 47.87s ago] (794643926,)
2026-02-13 18:27:45,710 - common.handler - WARNING - Такой пригласивший пользователь не найден: 794643926 для приглашающего пользователя: 7946439246
2026-02-13 18:27:45,711 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:27:45,711 - aiogram.event - INFO - Update id=66295008 is handled. Duration 3 ms by bot id=8543122898
2026-02-13 18:27:49,312 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:27:49,313 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:27:49,313 - sqlalchemy.engine.Engine - INFO - [cached since 51.47s ago] (7946439246,)
2026-02-13 18:27:49,314 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:27:49,314 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:27:49,314 - sqlalchemy.engine.Engine - INFO - [cached since 51.47s ago] (794643926,)
2026-02-13 18:27:49,315 - common.handler - WARNING - Такой пригласивший пользователь не найден: 794643926 для приглашающего пользователя: 7946439246
2026-02-13 18:27:49,315 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:27:49,316 - aiogram.event - INFO - Update id=66295009 is handled. Duration 3 ms by bot id=8543122898
2026-02-13 18:30:38,308 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 18:30:38,309 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 18:30:38,309 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 18:30:38,569 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:30:43,622 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:30:45,673 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:30:45,674 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:30:45,675 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:30:45,675 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:30:47,736 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:30:47,854 - aiogram.dispatcher - INFO - Start polling
2026-02-13 18:30:47,957 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:30:48,088 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:30:48,096 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:30:48,096 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] (7946439246,)
2026-02-13 18:30:48,098 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:30:48,098 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:30:48,949 - aiogram.event - INFO - Update id=66295010 is handled. Duration 862 ms by bot id=8543122898
2026-02-13 18:30:50,168 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:30:50,168 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:30:50,169 - sqlalchemy.engine.Engine - INFO - [cached since 2.073s ago] (7946439246,)
2026-02-13 18:30:50,170 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:30:50,170 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-13 18:30:50,170 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] (1,)
2026-02-13 18:30:50,172 - ServiceClasses.shoping_service - INFO - Получено 1 покупок для пользователя 1
2026-02-13 18:30:50,311 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:30:50,312 - aiogram.event - INFO - Update id=66295011 is handled. Duration 144 ms by bot id=8543122898
2026-02-13 18:31:21,939 - aiogram.event - INFO - Update id=66295012 is handled. Duration 242 ms by bot id=8543122898
2026-02-13 18:31:23,151 - aiogram.event - INFO - Update id=66295013 is handled. Duration 450 ms by bot id=8543122898
2026-02-13 18:31:23,941 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:31:23,942 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 18:31:23,942 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] (7946439246,)
2026-02-13 18:31:23,943 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:31:25,689 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:31:25,690 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:31:25,690 - sqlalchemy.engine.Engine - INFO - [cached since 37.59s ago] (7946439246,)
2026-02-13 18:31:25,691 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:31:25,691 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-13 18:31:25,691 - sqlalchemy.engine.Engine - INFO - [cached since 35.52s ago] (1,)
2026-02-13 18:31:25,692 - ServiceClasses.shoping_service - INFO - Получено 1 покупок для пользователя 1
2026-02-13 18:31:25,693 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:31:25,694 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:31:25,694 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:31:25,695 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:31:25,895 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:31:25,896 - aiogram.event - INFO - Update id=66295015 is handled. Duration 208 ms by bot id=8543122898
2026-02-13 18:31:27,625 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:31:27,630 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 18:31:27,630 - sqlalchemy.engine.Engine - INFO - [cached since 3.689s ago] (7946439246,)
2026-02-13 18:31:27,631 - py3xui.async_api.async_api_base - INFO - Updating inbound: enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='xby5s6el', enable=True, id='35673e88-11b5-414f-8589-3753cee3cebc', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id=0, total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='d51ed82a-3c1e-48c0-9f8d-cd204a4c8fce', password='', inbound_id=None, up=0, down=0, expiry_time=1774276401140, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None), Client(email='8016999764', enable=True, id='e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b', password='', inbound_id=None, up=0, down=0, expiry_time=1771252466237, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='e402d579-a18d-41d2-8bd4-a1512cc323d4', password='', inbound_id=None, up=0, down=0, expiry_time=1776438496557, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.microsoft.com:443', 'serverNames': ['www.microsoft.com', 'microsoft.com'], 'privateKey': 'wGSguAfvvojJdB2bJs4ljqcfu9evgQ0lWy9PKFQ_RWQ', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['b6', '6277', '30392505828128f3', '03bd010ab5fda2', 'e7c6bc', '42a1415d', 'a4639daea3', '2285c8b3a1e9'], 'mldsa65Seed': 'ZaTy4HSxx9T5ARzG0QB6hVpoTDPqaXtgRF854_immxw', 'settings': {'publicKey': 'f7Gp0e-L25Esiafe9mUW7KgdUXaz3A6wPP25VKdZe1M', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'aAcpNBQu5sKltzLD2Psfpw_phO57ebdNcorCHbFwv2VSAAaBQ12s5ciJlAlljzcHr81q5uFqmif3PNQfge19Qk72BIVWtzcrTk_8jpCCgLa65dBYeSVWOD02VNARXnIR1XYb-aYrfX2GZJNQljjfGx4sQLV_0Hblz01r4lGuDvG4wc4MKvmbeaiOmWOhBexi5hIy8PvC_EEmGeDyBIiDj_ilqN3V31SrB9PKKDImb9Ci4DrBDG1zLNCssBpw6GxrKvhVFxwac5GGDoBkgrqDD31j94tmv3dJxet_JZgekJ_y3b_PLXuqMDYpxT3PC-IKKHFbjzX3-QRg1MyxIvOlt_5H1_7oT4e_n1sXcNce8aBy6Gav9qf_kdRoSkEyxQ6Xbh9BDs8hbq5g7610L45pGLO5DJF3iKeY5byblqs3Qhcw16JPHkcFiQuQeQKBq7g5hV9b536dBQRE-QGTGqQg9I5MrFuvbLXSQF9846NDQGwyhKuNBKtBpRQLCXYWURwIzLeHsFNXBDhSuIJzPMDPEHAERudXpzyLT77CjOyqoOYFVcJkyUhkYK671IIYnz3YaGphlFchAcG4qmUim9K3mXHL2bAOH12jrwMuapmXcsMErNugs_dwsH-zVSR7esJ2GdziFgU5KgJont8cCOR7Y6dCmCrRTItADkQCJDHLa-Ncx2CnxGAwAq4nK8YktrAAZTPSavDfHZ0Ky_O5QkshUDJKRrcs5ItnL3G3ZnXUHUaRv9p7UX2O3fmMS6YPEF4iVCreak4W-26CSAgUafqQj9VC4fRL525O2Ss86fPGeJ398lv5nzBVp9MZNoeR9PswC-_hovXoVUrIOdfUGnr77EtQU2GBt9V704LTtxEI1Rfpyyf1iurwUez02aEtV4BRa3-MFKGLQ96hE7S63aPIoGEOVqS7i06iEWaLzd8iOzBM849_KYIxF3s6FbfVhKy8NUMaeYx1fiZ-ZhJiK-Fhv4YNIGtkBAFlxwGKjG9u9wlDCnrPzmmVkPC7lgwl5NcpJXrkWwbfmuvPTwg8xrScW1iVuwBNmZYi8BTVXC0PPn_iFIWz--sQ1AQZ3vjrTLbpcFylbkMrdKCJcnEUaYvcopGQVTyJo5Pi2zeZBhlwiC07IqXIlwFquX0py5DCYcNd-379ryjK7jc5HMNeXWtE99TrqprZ0_L_EzD4DRlE_SkJyPDHn0t0YISmjBOXMKynt7X7gAFHHsxaxOxie7AMlaS3t0LKar47gDtZiWKVv0yVIXgjjeiak8zVjsRUcFOq30ziVY353WFy8ZAfgXoiSsfVFCszIhVYzgPK48j7_oJDRztbD8w3dRQ98NpfV9SVRkktQcBPVfx3plTE28H_V7eSZ0mNtSlg5wkpUazKWnezDwYB9YpWoMu4g3FH7yXI3oyRCiJDFWECaQt9Zvz0otf2LpHVbqs0VocrSu0ZZ5wls0u36eqc9TrgYYzvrPgWkfu73pQLt6XKcTV2h0oqRNEkITyitdwTkJUQCmryAMp9s5kXyRi8tWhFRSWTUMzkCRWBoXOas2sJW86O9mJfEImxAHOyodJvodkmiyWaomablqq-KEAMBa835ZD7XBBGstgj9KCWnhfxslhZiYrECo3mdiCt8U-Ffp9bN2lKawsk4lxLWymMgIGJxLnXAKij_bvC0bppxAdBwrZr5u6enSMdnnEXfLGwLY-GlzGdLo1hsjO49WzE7OskNRXH5-D_f0NFkdBrCZaNOd_769Kslbm9p9uxDuJWtsy5eY_0G7S8L1q3c6XkCG2YxZ0FtFtOiGVRspvYAfBKtAC5CD0Z6G9gD4uG66OsTfiamYU6Te4Sdly33pTB9N9VLHTBgQW9zJp9aiTHPifwBD2YQ5TYgdYZzppBCw3F9DHB_7XpXp4dJt8WRziuJGvqRCws63Kj3gfhJANH9QH8iqiVLUL9zhj-xWLMYKHN-VGCOIUyIgcb-XXIXjdWaP-T-OxEUJOiDaH6QXv7fPE5YwPB1ivTb2bXVaz9Ehivi5--zqCo4Tkwa-1tU-flGDnUsmgSD4G8wExai7JK67UtQszndV73uGFZcI4DhyY0On2a8irY-BJhbQRGo1YLGjns2vGs3H-AcWNTwKSB00aarIlMnG65Dplpboefcrk5aTqXNC1C5I1Ub9CE6Dec5FAHY2J-ApHL10A58mxAr1hYARUFSATUlOmzBz-jGe5nh2ZNINGhZ25mkoltwyex0PuNxdwytMwongFuu3Pf8vRuRAr_Wfl1yMipGMM_tihXfAkuCVtUqSpz2n-n-8A_Dw63jAJ6KUxFozI5CLGuKGSNvsqo3nkHpb2WHYZO_xRjX0UBQQec_LoQ1TY1WGUo7mpO93Z46zthwKW_8NQxC-nBz9zmQrd3g4IPp0ZrfO2zNNeeh-883igx3KrjQv1U2NUW4hHiWKkxF3EzvYbd4wCR0SR7E6D-IjLB6k1dkm0jjyl-5bxk5mW6Ilt1fkYawFnIdRh3HMSBxZaQo1hlKEJq0mQ5iL4M26PINpPFVcDr3jiCmzY1zA7Nefqn0yAastVNS0JB5HHFd9mKRfQSN1Os0dStuMTBuMDoU38lNI1aN32HZjuXxh4'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=42 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='xby5s6el', enable=True, id=263, password='', inbound_id=42, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='pz3vqev2y851eff7', comment='', tg_id='', total_gb=0, uuid='35673e88-11b5-414f-8589-3753cee3cebc'), Client(email='7946439246', enable=True, id=264, password='', inbound_id=42, up=0, down=0, expiry_time=1771252401140, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='e402d579-a18d-41d2-8bd4-a1512cc323d4'), Client(email='8016999764', enable=True, id=265, password='', inbound_id=42, up=0, down=0, expiry_time=1771252466237, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='e90bd545-ea2b-47bb-b3a5-a5a2290e0e1b')] tag='inbound-443'
2026-02-13 18:31:28,455 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/update/42 "HTTP/1.1 200 OK"
2026-02-13 18:31:28,457 - py3xui.async_api.async_api_base - INFO - Inbound updated successfully.
2026-02-13 18:31:28,459 - sqlalchemy.engine.Engine - INFO - UPDATE subscriptions SET expired=? WHERE subscriptions.id = ?
2026-02-13 18:31:28,459 - sqlalchemy.engine.Engine - INFO - [generated in 0.00046s] ('2026-04-17 15:08:16.557000', 1)
2026-02-13 18:31:28,461 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 18:31:28,470 - common.handler - INFO - Подписка продлена на 30 дней для пользователя: 7946439246
2026-02-13 18:31:28,470 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:31:28,471 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:31:28,471 - sqlalchemy.engine.Engine - INFO - [cached since 40.38s ago] (7946439246,)
2026-02-13 18:31:28,472 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:31:28,473 - sqlalchemy.engine.Engine - INFO - INSERT INTO shoping (money, shop_date, user_id) VALUES (?, ?, ?)
2026-02-13 18:31:28,473 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] (149, '2026-02-13 18:31', 1)
2026-02-13 18:31:28,475 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 18:31:28,482 - ServiceClasses.shoping_service - INFO - Покупка создана: пользователь 1, сумма 149 Р., дата 2026-02-13 18:31
2026-02-13 18:31:28,482 - common.handler - INFO - Запись о покупке добавлена для пользователя: 7946439246 с суммой: 149 Р. и датой: 2026-02-13 18:31
2026-02-13 18:31:28,482 - aiogram.event - INFO - Update id=66295014 is handled. Duration 4750 ms by bot id=8543122898
2026-02-13 18:31:31,358 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:31:31,358 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:31:31,358 - sqlalchemy.engine.Engine - INFO - [cached since 43.26s ago] (7946439246,)
2026-02-13 18:31:31,359 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:31:31,359 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:31:31,586 - aiogram.event - INFO - Update id=66295016 is handled. Duration 228 ms by bot id=8543122898
2026-02-13 18:31:32,840 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:31:32,840 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:31:32,840 - sqlalchemy.engine.Engine - INFO - [cached since 44.74s ago] (7946439246,)
2026-02-13 18:31:32,841 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 18:31:32,841 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-13 18:31:32,841 - sqlalchemy.engine.Engine - INFO - [cached since 42.67s ago] (1,)
2026-02-13 18:31:32,842 - ServiceClasses.shoping_service - INFO - Получено 2 покупок для пользователя 1
2026-02-13 18:31:33,110 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 18:31:33,110 - aiogram.event - INFO - Update id=66295017 is handled. Duration 271 ms by bot id=8543122898
2026-02-13 18:33:28,107 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 18:33:28,108 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 18:33:28,108 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 18:33:28,365 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:35:39,579 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:35:40,619 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:35:40,621 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:35:40,621 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:35:40,622 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:35:41,403 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:35:41,512 - aiogram.dispatcher - INFO - Start polling
2026-02-13 18:35:41,603 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 18:39:45,178 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:39:45,183 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:39:45,184 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (5165578007,)
2026-02-13 18:39:45,187 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-13 18:39:45,187 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] (5165578007, '2026-02-13 18:39:45.185358', 0)
2026-02-13 18:39:45,188 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 18:39:45,215 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 5165578007
2026-02-13 18:39:45,216 - common.handler - INFO - Пользователь с Telegram ID 5165578007 создан в базе данных.
2026-02-13 18:39:45,216 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 18:39:46,722 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 18:39:46,723 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 18:39:46,723 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 18:39:46,723 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 18:39:52,024 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 18:39:52,026 - common.handler - INFO - Inbound enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='x401dr3d', enable=True, id='46c9d6b5-70c8-408e-8cfa-e7fcb43d6619', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='2pkgazymttthza14', comment='', tg_id=0, total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.tesla.com:443', 'serverNames': ['www.tesla.com', 'tesla.com'], 'privateKey': 'QNsqmX9IGjR2GdNu25tJFYLbKAAbjBFeSBSVP8aKH3w', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['9765', '2960427e8437', 'f031f4', '1f', 'e51ee496', '77942ce2b6', '1fc8afd0f1eb60', 'ba8c9578ddf20d69'], 'mldsa65Seed': 'R4kzxyQbdoTFZxEquMFIHwqB6gwdV6Gb7WeJn0gbCf4', 'settings': {'publicKey': '7MAXCJ0wdKXo0R0ZWPPATO6t93aAQqdZNmekWR53hz8', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'T44lCh8bZz69mPqUo9IdiMTa1hNRjhcuG4joPPqAc8Akn3-iuROha2sPqDaxvV3iYhFo-i6mgw_wDlOxjogYKxkXJVjWni-fraDflzAKXseeLO4CQsyyuDafSa9YRAUgCB23XVKvhpdRHEdltlXj9tKXTlcSo3GCrhvliCvA95CoTLtxW0rBgESlKg_j6w_8rsStNuAucMc-5aHIBmSlhJ3O5fJdEXTagFv3BWLnAWbYJ9dnsTf8dHKb1U75sP7rY2Kr9O7intUeP6kpMR4B6mRY7xgk2xGn7FF-n0Tp5izs55zYIBMSHlkuYfLDOM_4pyFRj9ts5vZueI5oDnWP6RWNGhK-qqM7zSLHlR4w6bSg5A3tnHwk7Fj4WFYJVnq8snBn8JXJqICtVmrE9lqk8MsZJhTqAoY6r9Tq4i3mO2ZTQdGOF6lsv9x1395qckgCcM4JWxsdI5tdszb-FgtyzgngkXIvXA7oV40IN4wu9cHS_pVjZy7oJpNtPwp0rmAcy7_n-EBJH5pMwWTJbHtezdb4_rIkf-QTRtygXzV-M4LEtMQ2cr_bUHvhhZT3kO7MjlZhY1tFyzJUKt8Zq17PMggHad4VTHFPd8avybUMx7GVkxaRXbW4uEh3ag5h3vVPAC2CQooquaY_pK-kztaXw-0SAjH1nZf_uBjScoRVsN3kHjeCnK4Z7cPdIZ9KeBeDz7tzy2EsQrSArDn1M5cKZEpVAejOm6jfxs8zEIZzGwVGzYgH3Mb3l5pgjY9J14K9ClLpAaKCRrsW2Q0KC2ii20n7MuSrjGRN2IqFbWlLcMD-uFsUSTQU7x1mONnvi7epIl0jAsfBY-pWPhH5KgX8mMbgL8HzwvBkJ__Tj7Scqtol-dC5XBU5sJQjd2xc_UmBNgClWVfCV-Zwuju_Wfh7Gp-RVRqk0Fh0QSV42UZvp8-XZQSpuyA4sUbGxFvNSRGdstnIz_cNz-mtVenBGsjXvRmonM2zRvCKbjYGd-dVXFtvwGXPb-UqyTFpEavXJdHA_ABf6ynkzvHnlG_AFqquXUjk25gZ-BDKM2cVB_PKDsK8TfHEpwOtxY3wSnxNWqXTHUe2_tKHgwdDp0M3XRssxAlvq0dO_oJrRMfey9Zh6YKfg_4X2KVHbgXmdcs5GL66j4fg7k5u_WDwMZqlRUP2wspteD0CXxMmL8zN9KZwWr2sf2n5ncXDclxkO8K6x0QKtAn22zcnSNMEhA4hAc6jSZM4E_ZN8sCPBn89Hl-P7mJHfpDVlj5mK4h7dP_gHl6B_g19eRwZ4sk0PVbqvjD-BTA67tH1BRwjxJ4jrNQHNDj0SHHhE17ssYni9wqjVwgaowttQBlzNm6dyivClbU843VgBrRPqGQDo8MdBmMgrkTjI-97Q28T5KH1IB0nMSSw2FN7dRo-p-lqKGxgtVS6TNqibHw_2uqEk-TgQ-d5svWgRRa38_gMGjdsxczE17KArH7kMUo09ND1bnjMwEM7xpk11Kg_-jFY9l7Vsl26j9MU_x0mtomduTVsfaEwRVghkQ7i4AITRiFlxPk5mP6jq4z0yXU1kCRhm8XsF0b1VvtxeRn3tj0P184C-ijQ7GbFPr_afbOcprp8OGhGSlAI_TAsdMYtwd9HvFuK6rUENd3XUpCVIqbo0OJemvfBFEommGYaBXYEfX4_9lIB2X5J-oDutQwzKWWJ4rsL4WfsR5Zku7XnHf77-KxRCxGhsraHoFFLjNaMQ8-EK1OA_uOBiufO6Bz4uywbQLU1CWKleGpzpTeiBnNwLWgcAR0XOfo-fB4_G3KHFS_va0dM0w5s9hxBOSsUC4rL3HggA0u8-kGbScvQQOy-_jWWA45xoDhgiLAv4nX7xYns-uRSGF7Nxm1zB6Kjddy3Q9OqngIFcZwDx_jDDyTN7OhpugBZB0FycbwlkE4FD41PBucn7AaipVwi0IN7SJB0egCV2FYx4i6jDdxwv2jOVvxiaYCr8403NI4htNEKiUqyoecdqfMQXEqNRAGKCjpUaVgE7jco5EncjpG_sRPwbs2xogB8FkdW_AY7HVaEkUB7K_dEJgfuw0cVY1v4__4hjW0VMjVIQ6SLb7VzfglpTG9SU0rN6qulKhduJd_FdS4c55w470y0K8nxdq4HDFiVXtDeINDlvh4EQsMw9vBTh2M08OIlfzgTnRWf3K-IZE548Z1L26vwRHu8_AfUT7ppHjA6O9froG28PlBxHD7kG5x0Xy7MW7SoeoNuEUY76Te0z7iAtuZ-bGFg5bmHpuc8-290h-nf5h5DYW052e4Z_YijA3oG_wVuHozDR5s64D7ImPjC7K3tEmlKP0Ko1merQsVV3SXNqZu4VNvBJzlhgd-4SVk74YbOvNja7Gpq75Mf7O_7o9k_7VI6wEYB7H0t8fjJB1Q4NEl_JsUX-vaelfqr2IVzhbLWcQSr_DpqA5GnssiyH6FWgihp6ipjRhNgofRW6euklh_YZKl1wGsuy6XnYn1XKjKTsAfWdMzZ8Lq47fgNvwiFmjS9u5AY4mEqqrYLKFvL1afDCvw7ngT7_dTtBmYWX7t8FnUCLXWLb_6ILedCR92axmdxj8ZbBqEw8mZu0YY1-qE'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=43 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='x401dr3d', enable=True, id=266, password='', inbound_id=43, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='2pkgazymttthza14', comment='', tg_id='', total_gb=0, uuid='46c9d6b5-70c8-408e-8cfa-e7fcb43d6619')] tag='inbound-443' инициализирован для пользователя
2026-02-13 18:39:52,027 - ServiceClasses.vpn_service - INFO - Создан VPN клиент для пользователя 5165578007 с истечением через 1771256385175 миллисекунд.
2026-02-13 18:39:52,027 - py3xui.async_api.async_api_base - INFO - Updating inbound: enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='x401dr3d', enable=True, id='46c9d6b5-70c8-408e-8cfa-e7fcb43d6619', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='2pkgazymttthza14', comment='', tg_id=0, total_gb=0, uuid=None), Client(email='5165578007', enable=True, id='33856080-a3d8-4db5-b4e0-7bd3b1043329', password='', inbound_id=None, up=0, down=0, expiry_time=1771256385175, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.tesla.com:443', 'serverNames': ['www.tesla.com', 'tesla.com'], 'privateKey': 'QNsqmX9IGjR2GdNu25tJFYLbKAAbjBFeSBSVP8aKH3w', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['9765', '2960427e8437', 'f031f4', '1f', 'e51ee496', '77942ce2b6', '1fc8afd0f1eb60', 'ba8c9578ddf20d69'], 'mldsa65Seed': 'R4kzxyQbdoTFZxEquMFIHwqB6gwdV6Gb7WeJn0gbCf4', 'settings': {'publicKey': '7MAXCJ0wdKXo0R0ZWPPATO6t93aAQqdZNmekWR53hz8', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'T44lCh8bZz69mPqUo9IdiMTa1hNRjhcuG4joPPqAc8Akn3-iuROha2sPqDaxvV3iYhFo-i6mgw_wDlOxjogYKxkXJVjWni-fraDflzAKXseeLO4CQsyyuDafSa9YRAUgCB23XVKvhpdRHEdltlXj9tKXTlcSo3GCrhvliCvA95CoTLtxW0rBgESlKg_j6w_8rsStNuAucMc-5aHIBmSlhJ3O5fJdEXTagFv3BWLnAWbYJ9dnsTf8dHKb1U75sP7rY2Kr9O7intUeP6kpMR4B6mRY7xgk2xGn7FF-n0Tp5izs55zYIBMSHlkuYfLDOM_4pyFRj9ts5vZueI5oDnWP6RWNGhK-qqM7zSLHlR4w6bSg5A3tnHwk7Fj4WFYJVnq8snBn8JXJqICtVmrE9lqk8MsZJhTqAoY6r9Tq4i3mO2ZTQdGOF6lsv9x1395qckgCcM4JWxsdI5tdszb-FgtyzgngkXIvXA7oV40IN4wu9cHS_pVjZy7oJpNtPwp0rmAcy7_n-EBJH5pMwWTJbHtezdb4_rIkf-QTRtygXzV-M4LEtMQ2cr_bUHvhhZT3kO7MjlZhY1tFyzJUKt8Zq17PMggHad4VTHFPd8avybUMx7GVkxaRXbW4uEh3ag5h3vVPAC2CQooquaY_pK-kztaXw-0SAjH1nZf_uBjScoRVsN3kHjeCnK4Z7cPdIZ9KeBeDz7tzy2EsQrSArDn1M5cKZEpVAejOm6jfxs8zEIZzGwVGzYgH3Mb3l5pgjY9J14K9ClLpAaKCRrsW2Q0KC2ii20n7MuSrjGRN2IqFbWlLcMD-uFsUSTQU7x1mONnvi7epIl0jAsfBY-pWPhH5KgX8mMbgL8HzwvBkJ__Tj7Scqtol-dC5XBU5sJQjd2xc_UmBNgClWVfCV-Zwuju_Wfh7Gp-RVRqk0Fh0QSV42UZvp8-XZQSpuyA4sUbGxFvNSRGdstnIz_cNz-mtVenBGsjXvRmonM2zRvCKbjYGd-dVXFtvwGXPb-UqyTFpEavXJdHA_ABf6ynkzvHnlG_AFqquXUjk25gZ-BDKM2cVB_PKDsK8TfHEpwOtxY3wSnxNWqXTHUe2_tKHgwdDp0M3XRssxAlvq0dO_oJrRMfey9Zh6YKfg_4X2KVHbgXmdcs5GL66j4fg7k5u_WDwMZqlRUP2wspteD0CXxMmL8zN9KZwWr2sf2n5ncXDclxkO8K6x0QKtAn22zcnSNMEhA4hAc6jSZM4E_ZN8sCPBn89Hl-P7mJHfpDVlj5mK4h7dP_gHl6B_g19eRwZ4sk0PVbqvjD-BTA67tH1BRwjxJ4jrNQHNDj0SHHhE17ssYni9wqjVwgaowttQBlzNm6dyivClbU843VgBrRPqGQDo8MdBmMgrkTjI-97Q28T5KH1IB0nMSSw2FN7dRo-p-lqKGxgtVS6TNqibHw_2uqEk-TgQ-d5svWgRRa38_gMGjdsxczE17KArH7kMUo09ND1bnjMwEM7xpk11Kg_-jFY9l7Vsl26j9MU_x0mtomduTVsfaEwRVghkQ7i4AITRiFlxPk5mP6jq4z0yXU1kCRhm8XsF0b1VvtxeRn3tj0P184C-ijQ7GbFPr_afbOcprp8OGhGSlAI_TAsdMYtwd9HvFuK6rUENd3XUpCVIqbo0OJemvfBFEommGYaBXYEfX4_9lIB2X5J-oDutQwzKWWJ4rsL4WfsR5Zku7XnHf77-KxRCxGhsraHoFFLjNaMQ8-EK1OA_uOBiufO6Bz4uywbQLU1CWKleGpzpTeiBnNwLWgcAR0XOfo-fB4_G3KHFS_va0dM0w5s9hxBOSsUC4rL3HggA0u8-kGbScvQQOy-_jWWA45xoDhgiLAv4nX7xYns-uRSGF7Nxm1zB6Kjddy3Q9OqngIFcZwDx_jDDyTN7OhpugBZB0FycbwlkE4FD41PBucn7AaipVwi0IN7SJB0egCV2FYx4i6jDdxwv2jOVvxiaYCr8403NI4htNEKiUqyoecdqfMQXEqNRAGKCjpUaVgE7jco5EncjpG_sRPwbs2xogB8FkdW_AY7HVaEkUB7K_dEJgfuw0cVY1v4__4hjW0VMjVIQ6SLb7VzfglpTG9SU0rN6qulKhduJd_FdS4c55w470y0K8nxdq4HDFiVXtDeINDlvh4EQsMw9vBTh2M08OIlfzgTnRWf3K-IZE548Z1L26vwRHu8_AfUT7ppHjA6O9froG28PlBxHD7kG5x0Xy7MW7SoeoNuEUY76Te0z7iAtuZ-bGFg5bmHpuc8-290h-nf5h5DYW052e4Z_YijA3oG_wVuHozDR5s64D7ImPjC7K3tEmlKP0Ko1merQsVV3SXNqZu4VNvBJzlhgd-4SVk74YbOvNja7Gpq75Mf7O_7o9k_7VI6wEYB7H0t8fjJB1Q4NEl_JsUX-vaelfqr2IVzhbLWcQSr_DpqA5GnssiyH6FWgihp6ipjRhNgofRW6euklh_YZKl1wGsuy6XnYn1XKjKTsAfWdMzZ8Lq47fgNvwiFmjS9u5AY4mEqqrYLKFvL1afDCvw7ngT7_dTtBmYWX7t8FnUCLXWLb_6ILedCR92axmdxj8ZbBqEw8mZu0YY1-qE'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=43 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='x401dr3d', enable=True, id=266, password='', inbound_id=43, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='2pkgazymttthza14', comment='', tg_id='', total_gb=0, uuid='46c9d6b5-70c8-408e-8cfa-e7fcb43d6619')] tag='inbound-443'
2026-02-13 18:39:52,923 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/update/43 "HTTP/1.1 200 OK"
2026-02-13 18:39:52,926 - py3xui.async_api.async_api_base - INFO - Inbound updated successfully.
2026-02-13 18:39:52,926 - common.handler - INFO - Клиент создан для пользователя: 5165578007 с именем: 5165578007
2026-02-13 18:39:52,926 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 18:39:52,927 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 18:39:52,927 - sqlalchemy.engine.Engine - INFO - [cached since 7.744s ago] (5165578007,)
2026-02-13 18:39:52,929 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, "key", uuid, expired, user_id) VALUES (?, ?, ?, ?, ?)
2026-02-13 18:39:52,929 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] (5165578007, 'vless://33856080-a3d8-4db5-b4e0-7bd3b1043329@94.183.186.146:443?type=tcp&encryption=none&security=reality&pbk=7MAXCJ0wdKXo0R0ZWPPATO6t93aAQqdZNmekWR53hz8&fp=chrome&sni=www.tesla.com&sid=9765&spx=%2F&flow=xtls-rprx-vision#dw-5165578007', '33856080-a3d8-4db5-b4e0-7bd3b1043329', '2026-02-16 15:39:45.175000', 2)
2026-02-13 18:39:52,931 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 18:39:52,941 - common.handler - INFO - Подписка создана для пользователя: 5165578007 с ключом: vless://33856080-a3d8-4db5-b4e0-7bd3b1043329@94.183.186.146:443?type=tcp&encryption=none&security=reality&pbk=7MAXCJ0wdKXo0R0ZWPPATO6t93aAQqdZNmekWR53hz8&fp=chrome&sni=www.tesla.com&sid=9765&spx=%2F&flow=xtls-rprx-vision#dw-5165578007
2026-02-13 18:39:53,981 - aiogram.event - INFO - Update id=66295018 is handled. Duration 8806 ms by bot id=8543122898
2026-02-13 19:27:18,752 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 19:27:18,753 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 19:27:18,753 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 19:27:19,008 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 19:28:31,343 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 19:28:32,447 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 19:28:32,448 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 19:28:32,449 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 19:28:32,449 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 19:28:33,268 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 19:28:33,385 - aiogram.dispatcher - INFO - Start polling
2026-02-13 19:28:33,480 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 19:28:47,082 - aiogram.event - INFO - Update id=66295020 is handled. Duration 932 ms by bot id=8543122898
2026-02-13 19:28:48,937 - aiogram.event - INFO - Update id=66295021 is handled. Duration 370 ms by bot id=8543122898
2026-02-13 19:28:54,610 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 19:28:54,616 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 19:28:54,617 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] (5165578007,)
2026-02-13 19:28:54,618 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 19:28:56,443 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 19:28:56,445 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 19:28:56,445 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 19:28:56,445 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 19:28:57,340 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 19:28:57,343 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 19:28:57,344 - sqlalchemy.engine.Engine - INFO - [cached since 2.727s ago] (5165578007,)
2026-02-13 19:28:57,345 - py3xui.async_api.async_api_base - INFO - Updating inbound: enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='x401dr3d', enable=True, id='46c9d6b5-70c8-408e-8cfa-e7fcb43d6619', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='2pkgazymttthza14', comment='', tg_id=0, total_gb=0, uuid=None), Client(email='5165578007', enable=True, id='33856080-a3d8-4db5-b4e0-7bd3b1043329', password='', inbound_id=None, up=0, down=0, expiry_time=1773848385175, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.tesla.com:443', 'serverNames': ['www.tesla.com', 'tesla.com'], 'privateKey': 'QNsqmX9IGjR2GdNu25tJFYLbKAAbjBFeSBSVP8aKH3w', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['9765', '2960427e8437', 'f031f4', '1f', 'e51ee496', '77942ce2b6', '1fc8afd0f1eb60', 'ba8c9578ddf20d69'], 'mldsa65Seed': 'R4kzxyQbdoTFZxEquMFIHwqB6gwdV6Gb7WeJn0gbCf4', 'settings': {'publicKey': '7MAXCJ0wdKXo0R0ZWPPATO6t93aAQqdZNmekWR53hz8', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'T44lCh8bZz69mPqUo9IdiMTa1hNRjhcuG4joPPqAc8Akn3-iuROha2sPqDaxvV3iYhFo-i6mgw_wDlOxjogYKxkXJVjWni-fraDflzAKXseeLO4CQsyyuDafSa9YRAUgCB23XVKvhpdRHEdltlXj9tKXTlcSo3GCrhvliCvA95CoTLtxW0rBgESlKg_j6w_8rsStNuAucMc-5aHIBmSlhJ3O5fJdEXTagFv3BWLnAWbYJ9dnsTf8dHKb1U75sP7rY2Kr9O7intUeP6kpMR4B6mRY7xgk2xGn7FF-n0Tp5izs55zYIBMSHlkuYfLDOM_4pyFRj9ts5vZueI5oDnWP6RWNGhK-qqM7zSLHlR4w6bSg5A3tnHwk7Fj4WFYJVnq8snBn8JXJqICtVmrE9lqk8MsZJhTqAoY6r9Tq4i3mO2ZTQdGOF6lsv9x1395qckgCcM4JWxsdI5tdszb-FgtyzgngkXIvXA7oV40IN4wu9cHS_pVjZy7oJpNtPwp0rmAcy7_n-EBJH5pMwWTJbHtezdb4_rIkf-QTRtygXzV-M4LEtMQ2cr_bUHvhhZT3kO7MjlZhY1tFyzJUKt8Zq17PMggHad4VTHFPd8avybUMx7GVkxaRXbW4uEh3ag5h3vVPAC2CQooquaY_pK-kztaXw-0SAjH1nZf_uBjScoRVsN3kHjeCnK4Z7cPdIZ9KeBeDz7tzy2EsQrSArDn1M5cKZEpVAejOm6jfxs8zEIZzGwVGzYgH3Mb3l5pgjY9J14K9ClLpAaKCRrsW2Q0KC2ii20n7MuSrjGRN2IqFbWlLcMD-uFsUSTQU7x1mONnvi7epIl0jAsfBY-pWPhH5KgX8mMbgL8HzwvBkJ__Tj7Scqtol-dC5XBU5sJQjd2xc_UmBNgClWVfCV-Zwuju_Wfh7Gp-RVRqk0Fh0QSV42UZvp8-XZQSpuyA4sUbGxFvNSRGdstnIz_cNz-mtVenBGsjXvRmonM2zRvCKbjYGd-dVXFtvwGXPb-UqyTFpEavXJdHA_ABf6ynkzvHnlG_AFqquXUjk25gZ-BDKM2cVB_PKDsK8TfHEpwOtxY3wSnxNWqXTHUe2_tKHgwdDp0M3XRssxAlvq0dO_oJrRMfey9Zh6YKfg_4X2KVHbgXmdcs5GL66j4fg7k5u_WDwMZqlRUP2wspteD0CXxMmL8zN9KZwWr2sf2n5ncXDclxkO8K6x0QKtAn22zcnSNMEhA4hAc6jSZM4E_ZN8sCPBn89Hl-P7mJHfpDVlj5mK4h7dP_gHl6B_g19eRwZ4sk0PVbqvjD-BTA67tH1BRwjxJ4jrNQHNDj0SHHhE17ssYni9wqjVwgaowttQBlzNm6dyivClbU843VgBrRPqGQDo8MdBmMgrkTjI-97Q28T5KH1IB0nMSSw2FN7dRo-p-lqKGxgtVS6TNqibHw_2uqEk-TgQ-d5svWgRRa38_gMGjdsxczE17KArH7kMUo09ND1bnjMwEM7xpk11Kg_-jFY9l7Vsl26j9MU_x0mtomduTVsfaEwRVghkQ7i4AITRiFlxPk5mP6jq4z0yXU1kCRhm8XsF0b1VvtxeRn3tj0P184C-ijQ7GbFPr_afbOcprp8OGhGSlAI_TAsdMYtwd9HvFuK6rUENd3XUpCVIqbo0OJemvfBFEommGYaBXYEfX4_9lIB2X5J-oDutQwzKWWJ4rsL4WfsR5Zku7XnHf77-KxRCxGhsraHoFFLjNaMQ8-EK1OA_uOBiufO6Bz4uywbQLU1CWKleGpzpTeiBnNwLWgcAR0XOfo-fB4_G3KHFS_va0dM0w5s9hxBOSsUC4rL3HggA0u8-kGbScvQQOy-_jWWA45xoDhgiLAv4nX7xYns-uRSGF7Nxm1zB6Kjddy3Q9OqngIFcZwDx_jDDyTN7OhpugBZB0FycbwlkE4FD41PBucn7AaipVwi0IN7SJB0egCV2FYx4i6jDdxwv2jOVvxiaYCr8403NI4htNEKiUqyoecdqfMQXEqNRAGKCjpUaVgE7jco5EncjpG_sRPwbs2xogB8FkdW_AY7HVaEkUB7K_dEJgfuw0cVY1v4__4hjW0VMjVIQ6SLb7VzfglpTG9SU0rN6qulKhduJd_FdS4c55w470y0K8nxdq4HDFiVXtDeINDlvh4EQsMw9vBTh2M08OIlfzgTnRWf3K-IZE548Z1L26vwRHu8_AfUT7ppHjA6O9froG28PlBxHD7kG5x0Xy7MW7SoeoNuEUY76Te0z7iAtuZ-bGFg5bmHpuc8-290h-nf5h5DYW052e4Z_YijA3oG_wVuHozDR5s64D7ImPjC7K3tEmlKP0Ko1merQsVV3SXNqZu4VNvBJzlhgd-4SVk74YbOvNja7Gpq75Mf7O_7o9k_7VI6wEYB7H0t8fjJB1Q4NEl_JsUX-vaelfqr2IVzhbLWcQSr_DpqA5GnssiyH6FWgihp6ipjRhNgofRW6euklh_YZKl1wGsuy6XnYn1XKjKTsAfWdMzZ8Lq47fgNvwiFmjS9u5AY4mEqqrYLKFvL1afDCvw7ngT7_dTtBmYWX7t8FnUCLXWLb_6ILedCR92axmdxj8ZbBqEw8mZu0YY1-qE'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=43 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='x401dr3d', enable=True, id=266, password='', inbound_id=43, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='2pkgazymttthza14', comment='', tg_id='', total_gb=0, uuid='46c9d6b5-70c8-408e-8cfa-e7fcb43d6619'), Client(email='5165578007', enable=True, id=267, password='', inbound_id=43, up=0, down=0, expiry_time=1771256385175, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid='33856080-a3d8-4db5-b4e0-7bd3b1043329')] tag='inbound-443'
2026-02-13 19:28:59,866 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/update/43 "HTTP/1.1 200 OK"
2026-02-13 19:28:59,868 - py3xui.async_api.async_api_base - INFO - Inbound updated successfully.
2026-02-13 19:28:59,870 - sqlalchemy.engine.Engine - INFO - UPDATE subscriptions SET expired=? WHERE subscriptions.id = ?
2026-02-13 19:28:59,870 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] ('2026-03-18 15:39:45.175000', 2)
2026-02-13 19:28:59,872 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 19:28:59,883 - common.handler - INFO - Подписка продлена на 30 дней для пользователя: 5165578007
2026-02-13 19:28:59,883 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 19:28:59,884 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 19:28:59,885 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (5165578007,)
2026-02-13 19:28:59,886 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 5165578007 найден в базе.
2026-02-13 19:28:59,887 - sqlalchemy.engine.Engine - INFO - INSERT INTO shoping (money, shop_date, user_id) VALUES (?, ?, ?)
2026-02-13 19:28:59,887 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (149, '2026-02-13 19:28', 2)
2026-02-13 19:28:59,889 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 19:28:59,899 - ServiceClasses.shoping_service - INFO - Покупка создана: пользователь 2, сумма 149 Р., дата 2026-02-13 19:28
2026-02-13 19:28:59,899 - common.handler - INFO - Запись о покупке добавлена для пользователя: 5165578007 с суммой: 149 Р. и датой: 2026-02-13 19:28
2026-02-13 19:28:59,899 - aiogram.event - INFO - Update id=66295022 is handled. Duration 5428 ms by bot id=8543122898
2026-02-13 19:29:30,017 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 19:29:30,018 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 19:29:30,018 - sqlalchemy.engine.Engine - INFO - [cached since 30.13s ago] (5165578007,)
2026-02-13 19:29:30,019 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 5165578007 найден в базе.
2026-02-13 19:29:30,019 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-13 19:29:30,020 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] (2,)
2026-02-13 19:29:30,020 - ServiceClasses.shoping_service - INFO - Получено 1 покупок для пользователя 2
2026-02-13 19:29:30,213 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 19:29:30,214 - aiogram.event - INFO - Update id=66295023 is handled. Duration 197 ms by bot id=8543122898
2026-02-13 19:29:50,065 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 19:29:50,066 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 19:29:50,066 - sqlalchemy.engine.Engine - INFO - [cached since 55.45s ago] (5165578007,)
2026-02-13 19:29:50,371 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 19:29:50,372 - aiogram.event - INFO - Update id=66295024 is handled. Duration 307 ms by bot id=8543122898
2026-02-13 20:55:42,131 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 20:55:43,201 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 20:55:43,202 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 20:55:43,203 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 20:55:43,204 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 20:55:44,015 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 20:55:44,119 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-13 20:55:44,120 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-13 20:55:44,120 - apscheduler.scheduler - INFO - Scheduler started
2026-02-13 20:55:44,120 - aiogram.dispatcher - INFO - Start polling
2026-02-13 20:55:44,215 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 20:56:31,631 - aiogram.event - INFO - Update id=66295025 is not handled. Duration 0 ms by bot id=8543122898
2026-02-13 20:56:42,687 - aiogram.event - INFO - Update id=66295026 is not handled. Duration 0 ms by bot id=8543122898
2026-02-13 20:56:53,340 - aiogram.event - INFO - Update id=66295027 is not handled. Duration 0 ms by bot id=8543122898
2026-02-13 20:56:53,816 - aiogram.event - INFO - Update id=66295028 is not handled. Duration 0 ms by bot id=8543122898
2026-02-13 20:57:07,400 - aiogram.event - INFO - Update id=66295029 is not handled. Duration 0 ms by bot id=8543122898
2026-02-13 20:57:26,924 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 20:57:26,924 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 20:57:26,924 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 20:57:27,178 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 20:57:31,899 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 20:57:33,185 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 20:57:33,188 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 20:57:33,190 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 20:57:33,190 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 20:57:34,043 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 20:57:34,190 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-13 20:57:34,191 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-13 20:57:34,191 - apscheduler.scheduler - INFO - Scheduler started
2026-02-13 20:57:34,192 - aiogram.dispatcher - INFO - Start polling
2026-02-13 20:57:34,305 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 20:57:34,420 - aiogram.event - INFO - Update id=66295032 is not handled. Duration 0 ms by bot id=8543122898
2026-02-13 20:57:37,215 - aiogram.event - INFO - Update id=66295033 is not handled. Duration 0 ms by bot id=8543122898
2026-02-13 20:59:21,003 - aiogram.dispatcher - INFO - Polling stopped
2026-02-13 20:59:21,004 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-13 20:59:21,004 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-13 20:59:21,257 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 20:59:25,769 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-13 20:59:27,175 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-13 20:59:27,177 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-13 20:59:27,177 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-13 20:59:27,179 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-13 20:59:28,015 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-13 20:59:28,168 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-13 20:59:28,169 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-13 20:59:28,169 - apscheduler.scheduler - INFO - Scheduler started
2026-02-13 20:59:28,169 - aiogram.dispatcher - INFO - Start polling
2026-02-13 20:59:28,261 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-13 20:59:28,360 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 20:59:28,367 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-13 20:59:28,368 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s] (7946439246,)
2026-02-13 20:59:28,370 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-13 20:59:28,370 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 20:59:29,330 - aiogram.event - INFO - Update id=66295034 is handled. Duration 973 ms by bot id=8543122898
2026-02-13 20:59:36,178 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 20:59:36,179 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-13 20:59:36,180 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] (7946439246,)
2026-02-13 20:59:36,409 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-13 20:59:36,409 - aiogram.event - INFO - Update id=66295035 is handled. Duration 232 ms by bot id=8543122898
2026-02-13 20:59:39,095 - aiogram.event - INFO - Update id=66295036 is handled. Duration 164 ms by bot id=8543122898
2026-02-13 20:59:56,594 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-13 20:59:56,595 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-13 20:59:56,596 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 20:59:56,597 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-13 20:59:56,597 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 20:59:56,601 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-13 20:59:56,601 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 20:59:56,602 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-13 20:59:56,602 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 20:59:56,604 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-13 20:59:56,604 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2026-02-13 20:59:56,616 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-13 20:59:56,616 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-13 20:59:56,626 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-13 20:59:56,626 - sqlalchemy.engine.Engine - INFO - [no key 0.00051s] ()
2026-02-13 20:59:56,636 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-13 20:59:56,636 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-13 20:59:56,646 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-13 20:59:56,647 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 20:59:56,647 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-13 20:59:56,648 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 20:59:56,649 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-13 20:59:56,649 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 20:59:56,650 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-13 20:59:56,650 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 20:59:56,651 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-13 20:59:56,651 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 20:59:56,651 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-13 20:59:56,652 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 20:59:56,652 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-13 20:59:56,652 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 20:59:56,653 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-13 20:59:56,653 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-13 20:59:56,654 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-13 20:59:56,655 - sqlalchemy.engine.Engine - INFO - [no key 0.00050s] ()
2026-02-13 20:59:56,664 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-13 20:59:56,664 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-13 20:59:56,675 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-13 20:59:56,675 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-13 20:59:56,686 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-13 20:59:56,686 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-13 20:59:56,696 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-13 20:59:56,696 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-13 20:59:56,706 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-13 20:59:56,706 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-13 20:59:56,716 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-13 20:59:56,716 - aiogram.event - INFO - Update id=66295037 is handled. Duration 305 ms by bot id=8543122898
2026-02-14 13:09:19,619 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-14 13:09:20,820 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-14 13:09:20,822 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-14 13:09:20,822 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-14 13:09:20,822 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-14 13:09:21,666 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-14 13:09:21,795 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-14 13:09:21,797 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-14 13:09:21,797 - apscheduler.scheduler - INFO - Scheduler started
2026-02-14 13:09:21,797 - aiogram.dispatcher - INFO - Start polling
2026-02-14 13:09:21,905 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-14 13:09:36,252 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-14 13:09:36,260 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-14 13:09:36,260 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] (7946439246,)
2026-02-14 13:09:36,270 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-14 13:09:36,273 - sqlalchemy.engine.Engine - INFO - [generated in 0.00270s] (7946439246, '2026-02-14 13:09:36.269582', 0)
2026-02-14 13:09:36,275 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-14 13:09:36,285 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-14 13:09:36,285 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-14 13:09:36,285 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-14 13:09:37,839 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-14 13:09:37,840 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-14 13:09:37,840 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-14 13:09:37,840 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-14 13:09:38,908 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-14 13:09:38,912 - common.handlers_flder.start_cmd - INFO - Inbound enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='x401dr3d', enable=True, id='46c9d6b5-70c8-408e-8cfa-e7fcb43d6619', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='2pkgazymttthza14', comment='', tg_id=0, total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.tesla.com:443', 'serverNames': ['www.tesla.com', 'tesla.com'], 'privateKey': 'QNsqmX9IGjR2GdNu25tJFYLbKAAbjBFeSBSVP8aKH3w', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['9765', '2960427e8437', 'f031f4', '1f', 'e51ee496', '77942ce2b6', '1fc8afd0f1eb60', 'ba8c9578ddf20d69'], 'mldsa65Seed': 'R4kzxyQbdoTFZxEquMFIHwqB6gwdV6Gb7WeJn0gbCf4', 'settings': {'publicKey': '7MAXCJ0wdKXo0R0ZWPPATO6t93aAQqdZNmekWR53hz8', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'T44lCh8bZz69mPqUo9IdiMTa1hNRjhcuG4joPPqAc8Akn3-iuROha2sPqDaxvV3iYhFo-i6mgw_wDlOxjogYKxkXJVjWni-fraDflzAKXseeLO4CQsyyuDafSa9YRAUgCB23XVKvhpdRHEdltlXj9tKXTlcSo3GCrhvliCvA95CoTLtxW0rBgESlKg_j6w_8rsStNuAucMc-5aHIBmSlhJ3O5fJdEXTagFv3BWLnAWbYJ9dnsTf8dHKb1U75sP7rY2Kr9O7intUeP6kpMR4B6mRY7xgk2xGn7FF-n0Tp5izs55zYIBMSHlkuYfLDOM_4pyFRj9ts5vZueI5oDnWP6RWNGhK-qqM7zSLHlR4w6bSg5A3tnHwk7Fj4WFYJVnq8snBn8JXJqICtVmrE9lqk8MsZJhTqAoY6r9Tq4i3mO2ZTQdGOF6lsv9x1395qckgCcM4JWxsdI5tdszb-FgtyzgngkXIvXA7oV40IN4wu9cHS_pVjZy7oJpNtPwp0rmAcy7_n-EBJH5pMwWTJbHtezdb4_rIkf-QTRtygXzV-M4LEtMQ2cr_bUHvhhZT3kO7MjlZhY1tFyzJUKt8Zq17PMggHad4VTHFPd8avybUMx7GVkxaRXbW4uEh3ag5h3vVPAC2CQooquaY_pK-kztaXw-0SAjH1nZf_uBjScoRVsN3kHjeCnK4Z7cPdIZ9KeBeDz7tzy2EsQrSArDn1M5cKZEpVAejOm6jfxs8zEIZzGwVGzYgH3Mb3l5pgjY9J14K9ClLpAaKCRrsW2Q0KC2ii20n7MuSrjGRN2IqFbWlLcMD-uFsUSTQU7x1mONnvi7epIl0jAsfBY-pWPhH5KgX8mMbgL8HzwvBkJ__Tj7Scqtol-dC5XBU5sJQjd2xc_UmBNgClWVfCV-Zwuju_Wfh7Gp-RVRqk0Fh0QSV42UZvp8-XZQSpuyA4sUbGxFvNSRGdstnIz_cNz-mtVenBGsjXvRmonM2zRvCKbjYGd-dVXFtvwGXPb-UqyTFpEavXJdHA_ABf6ynkzvHnlG_AFqquXUjk25gZ-BDKM2cVB_PKDsK8TfHEpwOtxY3wSnxNWqXTHUe2_tKHgwdDp0M3XRssxAlvq0dO_oJrRMfey9Zh6YKfg_4X2KVHbgXmdcs5GL66j4fg7k5u_WDwMZqlRUP2wspteD0CXxMmL8zN9KZwWr2sf2n5ncXDclxkO8K6x0QKtAn22zcnSNMEhA4hAc6jSZM4E_ZN8sCPBn89Hl-P7mJHfpDVlj5mK4h7dP_gHl6B_g19eRwZ4sk0PVbqvjD-BTA67tH1BRwjxJ4jrNQHNDj0SHHhE17ssYni9wqjVwgaowttQBlzNm6dyivClbU843VgBrRPqGQDo8MdBmMgrkTjI-97Q28T5KH1IB0nMSSw2FN7dRo-p-lqKGxgtVS6TNqibHw_2uqEk-TgQ-d5svWgRRa38_gMGjdsxczE17KArH7kMUo09ND1bnjMwEM7xpk11Kg_-jFY9l7Vsl26j9MU_x0mtomduTVsfaEwRVghkQ7i4AITRiFlxPk5mP6jq4z0yXU1kCRhm8XsF0b1VvtxeRn3tj0P184C-ijQ7GbFPr_afbOcprp8OGhGSlAI_TAsdMYtwd9HvFuK6rUENd3XUpCVIqbo0OJemvfBFEommGYaBXYEfX4_9lIB2X5J-oDutQwzKWWJ4rsL4WfsR5Zku7XnHf77-KxRCxGhsraHoFFLjNaMQ8-EK1OA_uOBiufO6Bz4uywbQLU1CWKleGpzpTeiBnNwLWgcAR0XOfo-fB4_G3KHFS_va0dM0w5s9hxBOSsUC4rL3HggA0u8-kGbScvQQOy-_jWWA45xoDhgiLAv4nX7xYns-uRSGF7Nxm1zB6Kjddy3Q9OqngIFcZwDx_jDDyTN7OhpugBZB0FycbwlkE4FD41PBucn7AaipVwi0IN7SJB0egCV2FYx4i6jDdxwv2jOVvxiaYCr8403NI4htNEKiUqyoecdqfMQXEqNRAGKCjpUaVgE7jco5EncjpG_sRPwbs2xogB8FkdW_AY7HVaEkUB7K_dEJgfuw0cVY1v4__4hjW0VMjVIQ6SLb7VzfglpTG9SU0rN6qulKhduJd_FdS4c55w470y0K8nxdq4HDFiVXtDeINDlvh4EQsMw9vBTh2M08OIlfzgTnRWf3K-IZE548Z1L26vwRHu8_AfUT7ppHjA6O9froG28PlBxHD7kG5x0Xy7MW7SoeoNuEUY76Te0z7iAtuZ-bGFg5bmHpuc8-290h-nf5h5DYW052e4Z_YijA3oG_wVuHozDR5s64D7ImPjC7K3tEmlKP0Ko1merQsVV3SXNqZu4VNvBJzlhgd-4SVk74YbOvNja7Gpq75Mf7O_7o9k_7VI6wEYB7H0t8fjJB1Q4NEl_JsUX-vaelfqr2IVzhbLWcQSr_DpqA5GnssiyH6FWgihp6ipjRhNgofRW6euklh_YZKl1wGsuy6XnYn1XKjKTsAfWdMzZ8Lq47fgNvwiFmjS9u5AY4mEqqrYLKFvL1afDCvw7ngT7_dTtBmYWX7t8FnUCLXWLb_6ILedCR92axmdxj8ZbBqEw8mZu0YY1-qE'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=43 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='x401dr3d', enable=True, id=266, password='', inbound_id=43, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='2pkgazymttthza14', comment='', tg_id='', total_gb=0, uuid='46c9d6b5-70c8-408e-8cfa-e7fcb43d6619')] tag='inbound-443' инициализирован для пользователя
2026-02-14 13:09:38,912 - ServiceClasses.vpn_service - INFO - Создан VPN клиент для пользователя 7946439246 с истечением через 1771322976226 миллисекунд.
2026-02-14 13:09:38,913 - py3xui.async_api.async_api_base - INFO - Updating inbound: enable=True port=443 protocol='vless' settings=Settings(clients=[Client(email='x401dr3d', enable=True, id='46c9d6b5-70c8-408e-8cfa-e7fcb43d6619', password='', inbound_id=None, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='2pkgazymttthza14', comment='', tg_id=0, total_gb=0, uuid=None), Client(email='7946439246', enable=True, id='7a40b13a-acf5-4c37-a9e1-9c405a646a7a', password='', inbound_id=None, up=0, down=0, expiry_time=1771322976226, total=0, reset=None, flow='xtls-rprx-vision', method='', limit_ip=0, sub_id='', comment='', tg_id='', total_gb=0, uuid=None)], decryption='none', fallbacks=[]) stream_settings=StreamSettings(security='reality', network='tcp', tcp_settings={'acceptProxyProtocol': False, 'header': {'type': 'none'}}, kcp_settings={}, external_proxy=[], reality_settings={'show': False, 'xver': 0, 'target': 'www.tesla.com:443', 'serverNames': ['www.tesla.com', 'tesla.com'], 'privateKey': 'QNsqmX9IGjR2GdNu25tJFYLbKAAbjBFeSBSVP8aKH3w', 'minClientVer': '', 'maxClientVer': '', 'maxTimediff': 0, 'shortIds': ['9765', '2960427e8437', 'f031f4', '1f', 'e51ee496', '77942ce2b6', '1fc8afd0f1eb60', 'ba8c9578ddf20d69'], 'mldsa65Seed': 'R4kzxyQbdoTFZxEquMFIHwqB6gwdV6Gb7WeJn0gbCf4', 'settings': {'publicKey': '7MAXCJ0wdKXo0R0ZWPPATO6t93aAQqdZNmekWR53hz8', 'fingerprint': 'chrome', 'serverName': '', 'spiderX': '/', 'mldsa65Verify': 'T44lCh8bZz69mPqUo9IdiMTa1hNRjhcuG4joPPqAc8Akn3-iuROha2sPqDaxvV3iYhFo-i6mgw_wDlOxjogYKxkXJVjWni-fraDflzAKXseeLO4CQsyyuDafSa9YRAUgCB23XVKvhpdRHEdltlXj9tKXTlcSo3GCrhvliCvA95CoTLtxW0rBgESlKg_j6w_8rsStNuAucMc-5aHIBmSlhJ3O5fJdEXTagFv3BWLnAWbYJ9dnsTf8dHKb1U75sP7rY2Kr9O7intUeP6kpMR4B6mRY7xgk2xGn7FF-n0Tp5izs55zYIBMSHlkuYfLDOM_4pyFRj9ts5vZueI5oDnWP6RWNGhK-qqM7zSLHlR4w6bSg5A3tnHwk7Fj4WFYJVnq8snBn8JXJqICtVmrE9lqk8MsZJhTqAoY6r9Tq4i3mO2ZTQdGOF6lsv9x1395qckgCcM4JWxsdI5tdszb-FgtyzgngkXIvXA7oV40IN4wu9cHS_pVjZy7oJpNtPwp0rmAcy7_n-EBJH5pMwWTJbHtezdb4_rIkf-QTRtygXzV-M4LEtMQ2cr_bUHvhhZT3kO7MjlZhY1tFyzJUKt8Zq17PMggHad4VTHFPd8avybUMx7GVkxaRXbW4uEh3ag5h3vVPAC2CQooquaY_pK-kztaXw-0SAjH1nZf_uBjScoRVsN3kHjeCnK4Z7cPdIZ9KeBeDz7tzy2EsQrSArDn1M5cKZEpVAejOm6jfxs8zEIZzGwVGzYgH3Mb3l5pgjY9J14K9ClLpAaKCRrsW2Q0KC2ii20n7MuSrjGRN2IqFbWlLcMD-uFsUSTQU7x1mONnvi7epIl0jAsfBY-pWPhH5KgX8mMbgL8HzwvBkJ__Tj7Scqtol-dC5XBU5sJQjd2xc_UmBNgClWVfCV-Zwuju_Wfh7Gp-RVRqk0Fh0QSV42UZvp8-XZQSpuyA4sUbGxFvNSRGdstnIz_cNz-mtVenBGsjXvRmonM2zRvCKbjYGd-dVXFtvwGXPb-UqyTFpEavXJdHA_ABf6ynkzvHnlG_AFqquXUjk25gZ-BDKM2cVB_PKDsK8TfHEpwOtxY3wSnxNWqXTHUe2_tKHgwdDp0M3XRssxAlvq0dO_oJrRMfey9Zh6YKfg_4X2KVHbgXmdcs5GL66j4fg7k5u_WDwMZqlRUP2wspteD0CXxMmL8zN9KZwWr2sf2n5ncXDclxkO8K6x0QKtAn22zcnSNMEhA4hAc6jSZM4E_ZN8sCPBn89Hl-P7mJHfpDVlj5mK4h7dP_gHl6B_g19eRwZ4sk0PVbqvjD-BTA67tH1BRwjxJ4jrNQHNDj0SHHhE17ssYni9wqjVwgaowttQBlzNm6dyivClbU843VgBrRPqGQDo8MdBmMgrkTjI-97Q28T5KH1IB0nMSSw2FN7dRo-p-lqKGxgtVS6TNqibHw_2uqEk-TgQ-d5svWgRRa38_gMGjdsxczE17KArH7kMUo09ND1bnjMwEM7xpk11Kg_-jFY9l7Vsl26j9MU_x0mtomduTVsfaEwRVghkQ7i4AITRiFlxPk5mP6jq4z0yXU1kCRhm8XsF0b1VvtxeRn3tj0P184C-ijQ7GbFPr_afbOcprp8OGhGSlAI_TAsdMYtwd9HvFuK6rUENd3XUpCVIqbo0OJemvfBFEommGYaBXYEfX4_9lIB2X5J-oDutQwzKWWJ4rsL4WfsR5Zku7XnHf77-KxRCxGhsraHoFFLjNaMQ8-EK1OA_uOBiufO6Bz4uywbQLU1CWKleGpzpTeiBnNwLWgcAR0XOfo-fB4_G3KHFS_va0dM0w5s9hxBOSsUC4rL3HggA0u8-kGbScvQQOy-_jWWA45xoDhgiLAv4nX7xYns-uRSGF7Nxm1zB6Kjddy3Q9OqngIFcZwDx_jDDyTN7OhpugBZB0FycbwlkE4FD41PBucn7AaipVwi0IN7SJB0egCV2FYx4i6jDdxwv2jOVvxiaYCr8403NI4htNEKiUqyoecdqfMQXEqNRAGKCjpUaVgE7jco5EncjpG_sRPwbs2xogB8FkdW_AY7HVaEkUB7K_dEJgfuw0cVY1v4__4hjW0VMjVIQ6SLb7VzfglpTG9SU0rN6qulKhduJd_FdS4c55w470y0K8nxdq4HDFiVXtDeINDlvh4EQsMw9vBTh2M08OIlfzgTnRWf3K-IZE548Z1L26vwRHu8_AfUT7ppHjA6O9froG28PlBxHD7kG5x0Xy7MW7SoeoNuEUY76Te0z7iAtuZ-bGFg5bmHpuc8-290h-nf5h5DYW052e4Z_YijA3oG_wVuHozDR5s64D7ImPjC7K3tEmlKP0Ko1merQsVV3SXNqZu4VNvBJzlhgd-4SVk74YbOvNja7Gpq75Mf7O_7o9k_7VI6wEYB7H0t8fjJB1Q4NEl_JsUX-vaelfqr2IVzhbLWcQSr_DpqA5GnssiyH6FWgihp6ipjRhNgofRW6euklh_YZKl1wGsuy6XnYn1XKjKTsAfWdMzZ8Lq47fgNvwiFmjS9u5AY4mEqqrYLKFvL1afDCvw7ngT7_dTtBmYWX7t8FnUCLXWLb_6ILedCR92axmdxj8ZbBqEw8mZu0YY1-qE'}}, xtls_settings={}, tls_settings={}, xhttp_settings={}) sniffing=Sniffing(enabled=False, dest_override=['http', 'tls', 'quic', 'fakedns'], metadata_only=False, route_only=False) listen='' remark='' id=43 up=0 down=0 total=0 expiry_time=0 client_stats=[Client(email='x401dr3d', enable=True, id=266, password='', inbound_id=43, up=0, down=0, expiry_time=0, total=0, reset=0, flow='', method='', limit_ip=0, sub_id='2pkgazymttthza14', comment='', tg_id='', total_gb=0, uuid='46c9d6b5-70c8-408e-8cfa-e7fcb43d6619')] tag='inbound-443'
2026-02-14 13:09:39,816 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/update/43 "HTTP/1.1 200 OK"
2026-02-14 13:09:39,818 - py3xui.async_api.async_api_base - INFO - Inbound updated successfully.
2026-02-14 13:09:39,818 - common.handlers_flder.start_cmd - INFO - Клиент создан для пользователя: 7946439246 с именем: 7946439246
2026-02-14 13:09:39,818 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-14 13:09:39,818 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-14 13:09:39,819 - sqlalchemy.engine.Engine - INFO - [cached since 3.559s ago] (7946439246,)
2026-02-14 13:09:39,821 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, "key", uuid, expired, user_id) VALUES (?, ?, ?, ?, ?)
2026-02-14 13:09:39,822 - sqlalchemy.engine.Engine - INFO - [generated in 0.00142s] (7946439246, 'vless://7a40b13a-acf5-4c37-a9e1-9c405a646a7a@94.183.186.146:443?type=tcp&encryption=none&security=reality&pbk=7MAXCJ0wdKXo0R0ZWPPATO6t93aAQqdZNmekWR53hz8&fp=chrome&sni=www.tesla.com&sid=9765&spx=%2F&flow=xtls-rprx-vision#dw-7946439246', '7a40b13a-acf5-4c37-a9e1-9c405a646a7a', '2026-02-17 10:09:36.226000', 1)
2026-02-14 13:09:39,825 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-14 13:09:39,836 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246 с ключом: vless://7a40b13a-acf5-4c37-a9e1-9c405a646a7a@94.183.186.146:443?type=tcp&encryption=none&security=reality&pbk=7MAXCJ0wdKXo0R0ZWPPATO6t93aAQqdZNmekWR53hz8&fp=chrome&sni=www.tesla.com&sid=9765&spx=%2F&flow=xtls-rprx-vision#dw-7946439246
2026-02-14 13:09:40,667 - aiogram.event - INFO - Update id=66295038 is handled. Duration 4440 ms by bot id=8543122898
2026-02-14 13:09:43,967 - aiogram.event - INFO - Update id=66295039 is not handled. Duration 1 ms by bot id=8543122898
2026-02-14 13:09:43,967 - aiogram.event - ERROR - Cause exception while process update id=66295039 by bot id=8543122898
AttributeError: 'coroutine' object has no attribute 'expired'
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\my_vpn.py", line 43, in my_vpn
    if sub.expired < now:
       ^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'expired'
2026-02-14 13:10:20,462 - aiogram.dispatcher - INFO - Polling stopped
2026-02-14 13:10:20,462 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-14 13:10:20,463 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-14 13:10:20,714 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-14 13:10:26,726 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-14 13:10:27,824 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-14 13:10:27,826 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-14 13:10:27,826 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-14 13:10:27,826 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-14 13:10:28,589 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-14 13:10:28,700 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-14 13:10:28,701 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-14 13:10:28,701 - apscheduler.scheduler - INFO - Scheduler started
2026-02-14 13:10:28,701 - aiogram.dispatcher - INFO - Start polling
2026-02-14 13:10:28,793 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-14 13:10:28,894 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-14 13:10:28,901 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-14 13:10:28,901 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] (7946439246,)
2026-02-14 13:10:28,902 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-14 13:10:28,903 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-14 13:10:30,193 - aiogram.event - INFO - Update id=66295040 is handled. Duration 1301 ms by bot id=8543122898
2026-02-14 13:10:32,370 - aiogram.event - INFO - Update id=66295041 is not handled. Duration 93 ms by bot id=8543122898
2026-02-14 13:10:32,370 - aiogram.event - ERROR - Cause exception while process update id=66295041 by bot id=8543122898
TelegramBadRequest: Telegram server says - Bad Request: there is no text in the message to edit
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\instructions.py", line 10, in instr
    await callback.message.edit_text('Выерите устройство: ', reply_markup=intsr)
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\methods\base.py", line 82, in emit
    return await bot(self)
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\client\bot.py", line 487, in __call__
    return await self.session(self, method, timeout=request_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\client\session\base.py", line 259, in __call__
    return cast(TelegramType, await middleware(bot, method))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\client\session\aiohttp.py", line 177, in make_request
    response = self.check_response(
        bot=bot,
    ...<2 lines>...
        content=raw_result,
    )
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\client\session\base.py", line 121, in check_response
    raise TelegramBadRequest(method=method, message=description)
aiogram.exceptions.TelegramBadRequest: Telegram server says - Bad Request: there is no text in the message to edit
2026-02-14 13:10:35,144 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-14 13:10:35,146 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions."key", subscriptions.uuid, subscriptions.expired, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-14 13:10:35,146 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] (7946439246,)
2026-02-14 13:10:35,313 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-14 13:10:35,314 - aiogram.event - INFO - Update id=66295042 is handled. Duration 170 ms by bot id=8543122898
2026-02-14 13:10:38,126 - aiogram.event - INFO - Update id=66295043 is handled. Duration 201 ms by bot id=8543122898
2026-02-14 13:11:24,141 - aiogram.dispatcher - INFO - Polling stopped
2026-02-14 13:11:24,142 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-14 13:11:24,142 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-14 13:11:24,405 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-14 13:11:29,377 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-14 13:11:30,796 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-14 13:11:30,798 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-14 13:11:30,798 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-14 13:11:30,799 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-14 13:11:31,728 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-14 13:11:32,173 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-14 13:11:32,173 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-14 13:11:32,174 - apscheduler.scheduler - INFO - Scheduler started
2026-02-14 13:11:32,174 - aiogram.dispatcher - INFO - Start polling
2026-02-14 13:11:32,273 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-14 13:11:32,380 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-14 13:11:32,387 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-14 13:11:32,387 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] (7946439246,)
2026-02-14 13:11:32,388 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-14 13:11:32,390 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-14 13:11:33,218 - aiogram.event - INFO - Update id=66295044 is handled. Duration 840 ms by bot id=8543122898
2026-02-14 13:11:34,931 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-14 13:11:34,932 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-14 13:11:34,932 - sqlalchemy.engine.Engine - INFO - [cached since 2.546s ago] (7946439246,)
2026-02-14 13:11:34,933 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-14 13:11:34,933 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-14 13:11:34,934 - aiogram.event - INFO - Update id=66295045 is not handled. Duration 3 ms by bot id=8543122898
2026-02-14 13:11:34,934 - aiogram.event - ERROR - Cause exception while process update id=66295045 by bot id=8543122898
ValidationError: 1 validation error for SendMessage
text
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\referal_system.py", line 22, in referal_system
    await callback.message.answer(referal_text(check_user, callback), parse_mode=ParseMode.HTML)
          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\types\message.py", line 2252, in answer
    return SendMessage(
           ~~~~~~~~~~~^
        chat_id=self.chat.id,
        ^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwargs,
        ^^^^^^^^^
    ).as_(self._bot)
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SendMessage
text
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2026-02-14 13:12:20,432 - aiogram.dispatcher - INFO - Polling stopped
2026-02-14 13:12:20,433 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-14 13:12:20,434 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-14 13:12:20,699 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-14 13:12:25,668 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-14 13:12:26,805 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-14 13:12:26,806 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-14 13:12:26,807 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-14 13:12:26,807 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-14 13:12:27,675 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-14 13:12:27,947 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-14 13:12:27,948 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-14 13:12:27,948 - apscheduler.scheduler - INFO - Scheduler started
2026-02-14 13:12:27,948 - aiogram.dispatcher - INFO - Start polling
2026-02-14 13:12:28,254 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-14 13:12:28,344 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-14 13:12:28,351 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-14 13:12:28,352 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] (7946439246,)
2026-02-14 13:12:28,353 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-14 13:12:28,357 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-14 13:12:29,114 - aiogram.event - INFO - Update id=66295046 is handled. Duration 771 ms by bot id=8543122898
2026-02-14 13:12:31,503 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-14 13:12:31,503 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-14 13:12:31,503 - sqlalchemy.engine.Engine - INFO - [cached since 3.152s ago] (7946439246,)
2026-02-14 13:12:31,504 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-14 13:12:31,504 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-14 13:12:31,505 - aiogram.event - INFO - Update id=66295047 is not handled. Duration 3 ms by bot id=8543122898
2026-02-14 13:12:31,505 - aiogram.event - ERROR - Cause exception while process update id=66295047 by bot id=8543122898
ValidationError: 1 validation error for SendMessage
text
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\referal_system.py", line 22, in referal_system
    await callback.message.answer(text=referal_text(check_user, callback), parse_mode=ParseMode.HTML)
          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\types\message.py", line 2252, in answer
    return SendMessage(
           ~~~~~~~~~~~^
        chat_id=self.chat.id,
        ^^^^^^^^^^^^^^^^^^^^^
    ...<17 lines>...
        **kwargs,
        ^^^^^^^^^
    ).as_(self._bot)
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for SendMessage
text
  Input should be a valid string [type=string_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
2026-02-14 13:13:23,142 - aiogram.dispatcher - INFO - Polling stopped
2026-02-14 13:13:23,143 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-14 13:13:23,143 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-14 13:13:23,398 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-14 13:13:33,050 - py3xui.async_api.async_api_base - INFO - Logging in with username: JUHEyo8TCy
2026-02-14 13:13:33,988 - httpx - INFO - HTTP Request: POST https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/login "HTTP/1.1 200 OK"
2026-02-14 13:13:33,989 - py3xui.async_api.async_api_base - INFO - Session cookie successfully retrieved for username: JUHEyo8TCy
2026-02-14 13:13:33,989 - py3xui.async_api.async_api - INFO - Logged in successfully.
2026-02-14 13:13:33,990 - py3xui.async_api.async_api_base - INFO - Getting inbounds...
2026-02-14 13:13:34,899 - httpx - INFO - HTTP Request: GET https://94.183.186.146:55591/cwb9fj6JhB8r8EIlNY/panel/api/inbounds/list "HTTP/1.1 200 OK"
2026-02-14 13:13:35,017 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-14 13:13:35,019 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-14 13:13:35,019 - apscheduler.scheduler - INFO - Scheduler started
2026-02-14 13:13:35,019 - aiogram.dispatcher - INFO - Start polling
2026-02-14 13:13:35,133 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-14 13:13:35,245 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-14 13:13:35,252 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-14 13:13:35,253 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] (7946439246,)
2026-02-14 13:13:35,257 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-14 13:13:35,258 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-14 13:13:36,013 - aiogram.event - INFO - Update id=66295049 is handled. Duration 769 ms by bot id=8543122898
2026-02-14 13:13:57,856 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-14 13:13:57,856 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-14 13:13:57,856 - sqlalchemy.engine.Engine - INFO - [cached since 22.6s ago] (7946439246,)
2026-02-14 13:13:57,857 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-14 13:13:57,857 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-14 13:13:58,031 - aiogram.event - INFO - Update id=66295050 is handled. Duration 176 ms by bot id=8543122898
2026-02-14 13:14:02,644 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-14 13:14:02,644 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-14 13:14:02,645 - sqlalchemy.engine.Engine - INFO - [cached since 27.39s ago] (7946439246,)
2026-02-14 13:14:02,645 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-14 13:14:02,646 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-14 13:14:02,646 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (1,)
2026-02-14 13:14:02,647 - ServiceClasses.shoping_service - INFO - Получено 0 покупок для пользователя 1
2026-02-14 13:14:02,776 - common.handlers_flder.history_shops - INFO - Пользователь 7946439246 запросил историю покупок, но покупок не найдено.
2026-02-14 13:14:02,777 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-14 13:14:02,777 - aiogram.event - INFO - Update id=66295051 is handled. Duration 134 ms by bot id=8543122898
2026-02-14 18:51:28,588 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 1236] Подключение к сети было разорвано локальной системой
2026-02-14 18:51:28,651 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-14 18:51:50,697 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:51:50,697 - aiogram.dispatcher - WARNING - Sleep for 1.071575 seconds and try again... (tryings = 1, bot id = 8543122898)
2026-02-14 18:52:12,820 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:52:12,820 - aiogram.dispatcher - WARNING - Sleep for 1.482993 seconds and try again... (tryings = 2, bot id = 8543122898)
2026-02-14 18:52:35,381 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:52:35,381 - aiogram.dispatcher - WARNING - Sleep for 1.880127 seconds and try again... (tryings = 3, bot id = 8543122898)
2026-02-14 18:52:58,316 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:52:58,316 - aiogram.dispatcher - WARNING - Sleep for 2.287813 seconds and try again... (tryings = 4, bot id = 8543122898)
2026-02-14 18:53:21,657 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:53:21,658 - aiogram.dispatcher - WARNING - Sleep for 2.889177 seconds and try again... (tryings = 5, bot id = 8543122898)
2026-02-14 18:53:45,603 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:53:45,604 - aiogram.dispatcher - WARNING - Sleep for 3.575009 seconds and try again... (tryings = 6, bot id = 8543122898)
2026-02-14 18:54:10,242 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:54:10,242 - aiogram.dispatcher - WARNING - Sleep for 4.871308 seconds and try again... (tryings = 7, bot id = 8543122898)
2026-02-14 18:54:36,168 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:54:36,169 - aiogram.dispatcher - WARNING - Sleep for 4.890548 seconds and try again... (tryings = 8, bot id = 8543122898)
2026-02-14 18:55:02,119 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:55:02,120 - aiogram.dispatcher - WARNING - Sleep for 5.157229 seconds and try again... (tryings = 9, bot id = 8543122898)
2026-02-14 18:55:28,325 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:55:28,326 - aiogram.dispatcher - WARNING - Sleep for 4.919647 seconds and try again... (tryings = 10, bot id = 8543122898)
2026-02-14 18:55:54,291 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:55:54,292 - aiogram.dispatcher - WARNING - Sleep for 5.027946 seconds and try again... (tryings = 11, bot id = 8543122898)
2026-02-14 18:56:20,369 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:56:20,370 - aiogram.dispatcher - WARNING - Sleep for 5.046944 seconds and try again... (tryings = 12, bot id = 8543122898)
2026-02-14 18:56:46,473 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:56:46,473 - aiogram.dispatcher - WARNING - Sleep for 4.959028 seconds and try again... (tryings = 13, bot id = 8543122898)
2026-02-14 18:57:12,479 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:57:12,479 - aiogram.dispatcher - WARNING - Sleep for 4.827100 seconds and try again... (tryings = 14, bot id = 8543122898)
2026-02-14 18:57:38,341 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:57:38,341 - aiogram.dispatcher - WARNING - Sleep for 4.985308 seconds and try again... (tryings = 15, bot id = 8543122898)
2026-02-14 18:58:04,386 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:58:04,386 - aiogram.dispatcher - WARNING - Sleep for 4.942386 seconds and try again... (tryings = 16, bot id = 8543122898)
2026-02-14 18:58:30,389 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:58:30,389 - aiogram.dispatcher - WARNING - Sleep for 4.919543 seconds and try again... (tryings = 17, bot id = 8543122898)
2026-02-14 18:58:56,351 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:58:56,352 - aiogram.dispatcher - WARNING - Sleep for 4.984695 seconds and try again... (tryings = 18, bot id = 8543122898)
2026-02-14 18:59:22,396 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:59:22,396 - aiogram.dispatcher - WARNING - Sleep for 5.010273 seconds and try again... (tryings = 19, bot id = 8543122898)
2026-02-14 18:59:48,461 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 18:59:48,462 - aiogram.dispatcher - WARNING - Sleep for 4.987007 seconds and try again... (tryings = 20, bot id = 8543122898)
2026-02-14 19:00:14,498 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:00:14,498 - aiogram.dispatcher - WARNING - Sleep for 4.940352 seconds and try again... (tryings = 21, bot id = 8543122898)
2026-02-14 19:00:40,499 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:00:40,499 - aiogram.dispatcher - WARNING - Sleep for 5.012154 seconds and try again... (tryings = 22, bot id = 8543122898)
2026-02-14 19:01:06,565 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:01:06,566 - aiogram.dispatcher - WARNING - Sleep for 5.036129 seconds and try again... (tryings = 23, bot id = 8543122898)
2026-02-14 19:01:32,629 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:01:32,630 - aiogram.dispatcher - WARNING - Sleep for 5.047328 seconds and try again... (tryings = 24, bot id = 8543122898)
2026-02-14 19:01:58,746 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:01:58,746 - aiogram.dispatcher - WARNING - Sleep for 5.077596 seconds and try again... (tryings = 25, bot id = 8543122898)
2026-02-14 19:02:24,855 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:02:24,855 - aiogram.dispatcher - WARNING - Sleep for 5.063043 seconds and try again... (tryings = 26, bot id = 8543122898)
2026-02-14 19:02:50,949 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:02:50,949 - aiogram.dispatcher - WARNING - Sleep for 5.039065 seconds and try again... (tryings = 27, bot id = 8543122898)
2026-02-14 19:03:17,053 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:03:17,053 - aiogram.dispatcher - WARNING - Sleep for 5.025406 seconds and try again... (tryings = 28, bot id = 8543122898)
2026-02-14 19:03:43,124 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:03:43,124 - aiogram.dispatcher - WARNING - Sleep for 4.924080 seconds and try again... (tryings = 29, bot id = 8543122898)
2026-02-14 19:04:09,108 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:04:09,109 - aiogram.dispatcher - WARNING - Sleep for 5.128767 seconds and try again... (tryings = 30, bot id = 8543122898)
2026-02-14 19:04:35,291 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:04:35,291 - aiogram.dispatcher - WARNING - Sleep for 4.999607 seconds and try again... (tryings = 31, bot id = 8543122898)
2026-02-14 19:05:01,354 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:05:01,354 - aiogram.dispatcher - WARNING - Sleep for 5.152715 seconds and try again... (tryings = 32, bot id = 8543122898)
2026-02-14 19:05:27,544 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:05:27,545 - aiogram.dispatcher - WARNING - Sleep for 4.755301 seconds and try again... (tryings = 33, bot id = 8543122898)
2026-02-14 19:05:53,339 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:05:53,340 - aiogram.dispatcher - WARNING - Sleep for 4.938574 seconds and try again... (tryings = 34, bot id = 8543122898)
2026-02-14 19:06:19,323 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:06:19,323 - aiogram.dispatcher - WARNING - Sleep for 5.082824 seconds and try again... (tryings = 35, bot id = 8543122898)
2026-02-14 19:06:45,468 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:06:45,469 - aiogram.dispatcher - WARNING - Sleep for 5.029497 seconds and try again... (tryings = 36, bot id = 8543122898)
2026-02-14 19:07:11,558 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:07:11,559 - aiogram.dispatcher - WARNING - Sleep for 5.151808 seconds and try again... (tryings = 37, bot id = 8543122898)
2026-02-14 19:07:37,746 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:07:37,746 - aiogram.dispatcher - WARNING - Sleep for 4.926933 seconds and try again... (tryings = 38, bot id = 8543122898)
2026-02-14 19:08:03,747 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:08:03,747 - aiogram.dispatcher - WARNING - Sleep for 5.179049 seconds and try again... (tryings = 39, bot id = 8543122898)
2026-02-14 19:08:29,980 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:08:29,980 - aiogram.dispatcher - WARNING - Sleep for 4.899528 seconds and try again... (tryings = 40, bot id = 8543122898)
2026-02-14 19:08:55,908 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:08:55,909 - aiogram.dispatcher - WARNING - Sleep for 5.142431 seconds and try again... (tryings = 41, bot id = 8543122898)
2026-02-14 19:09:22,103 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:09:22,103 - aiogram.dispatcher - WARNING - Sleep for 4.980007 seconds and try again... (tryings = 42, bot id = 8543122898)
2026-02-14 19:09:48,133 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:09:48,134 - aiogram.dispatcher - WARNING - Sleep for 4.883698 seconds and try again... (tryings = 43, bot id = 8543122898)
2026-02-14 19:10:14,077 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:10:14,078 - aiogram.dispatcher - WARNING - Sleep for 4.917876 seconds and try again... (tryings = 44, bot id = 8543122898)
2026-02-14 19:10:40,043 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:10:40,044 - aiogram.dispatcher - WARNING - Sleep for 4.934968 seconds and try again... (tryings = 45, bot id = 8543122898)
2026-02-14 19:11:06,021 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:11:06,021 - aiogram.dispatcher - WARNING - Sleep for 4.990082 seconds and try again... (tryings = 46, bot id = 8543122898)
2026-02-14 19:11:32,061 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:11:32,061 - aiogram.dispatcher - WARNING - Sleep for 4.955608 seconds and try again... (tryings = 47, bot id = 8543122898)
2026-02-14 19:11:58,064 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:11:58,065 - aiogram.dispatcher - WARNING - Sleep for 4.917988 seconds and try again... (tryings = 48, bot id = 8543122898)
2026-02-14 19:12:24,027 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:12:24,027 - aiogram.dispatcher - WARNING - Sleep for 4.919881 seconds and try again... (tryings = 49, bot id = 8543122898)
2026-02-14 19:12:50,016 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:12:50,016 - aiogram.dispatcher - WARNING - Sleep for 4.911654 seconds and try again... (tryings = 50, bot id = 8543122898)
2026-02-14 19:13:15,960 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:13:15,960 - aiogram.dispatcher - WARNING - Sleep for 4.934188 seconds and try again... (tryings = 51, bot id = 8543122898)
2026-02-14 19:13:41,948 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:13:41,948 - aiogram.dispatcher - WARNING - Sleep for 5.035416 seconds and try again... (tryings = 52, bot id = 8543122898)
2026-02-14 19:14:08,022 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:14:08,023 - aiogram.dispatcher - WARNING - Sleep for 4.969715 seconds and try again... (tryings = 53, bot id = 8543122898)
2026-02-14 19:14:34,033 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:14:34,033 - aiogram.dispatcher - WARNING - Sleep for 4.988163 seconds and try again... (tryings = 54, bot id = 8543122898)
2026-02-14 19:15:00,081 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:15:00,081 - aiogram.dispatcher - WARNING - Sleep for 5.004574 seconds and try again... (tryings = 55, bot id = 8543122898)
2026-02-14 19:15:26,143 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:15:26,143 - aiogram.dispatcher - WARNING - Sleep for 5.060979 seconds and try again... (tryings = 56, bot id = 8543122898)
2026-02-14 19:15:52,248 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:15:52,248 - aiogram.dispatcher - WARNING - Sleep for 4.982282 seconds and try again... (tryings = 57, bot id = 8543122898)
2026-02-14 19:16:18,286 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:16:18,286 - aiogram.dispatcher - WARNING - Sleep for 4.996613 seconds and try again... (tryings = 58, bot id = 8543122898)
2026-02-14 19:16:44,338 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:16:44,338 - aiogram.dispatcher - WARNING - Sleep for 4.839567 seconds and try again... (tryings = 59, bot id = 8543122898)
2026-02-14 19:17:10,241 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:17:10,241 - aiogram.dispatcher - WARNING - Sleep for 5.144148 seconds and try again... (tryings = 60, bot id = 8543122898)
2026-02-14 19:17:36,449 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:17:36,449 - aiogram.dispatcher - WARNING - Sleep for 4.883836 seconds and try again... (tryings = 61, bot id = 8543122898)
2026-02-14 19:18:02,400 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:18:02,401 - aiogram.dispatcher - WARNING - Sleep for 4.944213 seconds and try again... (tryings = 62, bot id = 8543122898)
2026-02-14 19:18:28,405 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:18:28,405 - aiogram.dispatcher - WARNING - Sleep for 5.094152 seconds and try again... (tryings = 63, bot id = 8543122898)
2026-02-14 19:18:54,538 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:18:54,538 - aiogram.dispatcher - WARNING - Sleep for 4.946495 seconds and try again... (tryings = 64, bot id = 8543122898)
2026-02-14 19:19:20,533 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:19:20,533 - aiogram.dispatcher - WARNING - Sleep for 5.074611 seconds and try again... (tryings = 65, bot id = 8543122898)
2026-02-14 19:19:46,638 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:19:46,638 - aiogram.dispatcher - WARNING - Sleep for 5.080464 seconds and try again... (tryings = 66, bot id = 8543122898)
2026-02-14 19:20:12,752 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:20:12,752 - aiogram.dispatcher - WARNING - Sleep for 5.057594 seconds and try again... (tryings = 67, bot id = 8543122898)
2026-02-14 19:20:38,855 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:20:38,855 - aiogram.dispatcher - WARNING - Sleep for 5.065771 seconds and try again... (tryings = 68, bot id = 8543122898)
2026-02-14 19:21:04,994 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:21:04,994 - aiogram.dispatcher - WARNING - Sleep for 5.078667 seconds and try again... (tryings = 69, bot id = 8543122898)
2026-02-14 19:21:31,137 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:21:31,137 - aiogram.dispatcher - WARNING - Sleep for 5.079870 seconds and try again... (tryings = 70, bot id = 8543122898)
2026-02-14 19:21:57,290 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:21:57,290 - aiogram.dispatcher - WARNING - Sleep for 5.019435 seconds and try again... (tryings = 71, bot id = 8543122898)
2026-02-14 19:22:23,341 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:22:23,341 - aiogram.dispatcher - WARNING - Sleep for 4.890728 seconds and try again... (tryings = 72, bot id = 8543122898)
2026-02-14 19:22:49,308 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:22:49,309 - aiogram.dispatcher - WARNING - Sleep for 5.018505 seconds and try again... (tryings = 73, bot id = 8543122898)
2026-02-14 19:23:15,387 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:23:15,387 - aiogram.dispatcher - WARNING - Sleep for 5.116740 seconds and try again... (tryings = 74, bot id = 8543122898)
2026-02-14 19:23:41,556 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:23:41,557 - aiogram.dispatcher - WARNING - Sleep for 5.061910 seconds and try again... (tryings = 75, bot id = 8543122898)
2026-02-14 19:24:07,663 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:24:07,663 - aiogram.dispatcher - WARNING - Sleep for 4.993138 seconds and try again... (tryings = 76, bot id = 8543122898)
2026-02-14 19:24:33,688 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:24:33,689 - aiogram.dispatcher - WARNING - Sleep for 4.956789 seconds and try again... (tryings = 77, bot id = 8543122898)
2026-02-14 19:24:59,695 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:24:59,695 - aiogram.dispatcher - WARNING - Sleep for 4.980637 seconds and try again... (tryings = 78, bot id = 8543122898)
2026-02-14 19:25:17,191 - aiogram.dispatcher - INFO - Connection established (tryings = 79, bot id = 8543122898)
2026-02-14 19:25:36,389 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 1236] Подключение к сети было разорвано локальной системой
2026-02-14 19:25:36,427 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-14 19:25:58,498 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:25:58,498 - aiogram.dispatcher - WARNING - Sleep for 1.273989 seconds and try again... (tryings = 1, bot id = 8543122898)
2026-02-14 19:26:12,739 - aiogram.dispatcher - INFO - Connection established (tryings = 2, bot id = 8543122898)
2026-02-14 19:27:09,058 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-14 19:27:09,073 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-14 19:27:21,527 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 8543122898)
2026-02-14 19:30:17,923 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientOSError: [WinError 1236] Подключение к сети было разорвано локальной системой
2026-02-14 19:30:17,928 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-14 19:30:39,990 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:30:39,990 - aiogram.dispatcher - WARNING - Sleep for 1.234459 seconds and try again... (tryings = 1, bot id = 8543122898)
2026-02-14 19:31:02,257 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:31:02,258 - aiogram.dispatcher - WARNING - Sleep for 1.638436 seconds and try again... (tryings = 2, bot id = 8543122898)
2026-02-14 19:31:24,947 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:31:24,947 - aiogram.dispatcher - WARNING - Sleep for 1.924459 seconds and try again... (tryings = 3, bot id = 8543122898)
2026-02-14 19:31:47,934 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:31:47,934 - aiogram.dispatcher - WARNING - Sleep for 2.571015 seconds and try again... (tryings = 4, bot id = 8543122898)
2026-02-14 19:32:11,547 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:32:11,547 - aiogram.dispatcher - WARNING - Sleep for 3.372455 seconds and try again... (tryings = 5, bot id = 8543122898)
2026-02-14 19:32:35,945 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:32:35,945 - aiogram.dispatcher - WARNING - Sleep for 4.427653 seconds and try again... (tryings = 6, bot id = 8543122898)
2026-02-14 19:33:01,434 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:33:01,434 - aiogram.dispatcher - WARNING - Sleep for 4.987836 seconds and try again... (tryings = 7, bot id = 8543122898)
2026-02-14 19:33:27,484 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:33:27,485 - aiogram.dispatcher - WARNING - Sleep for 4.857934 seconds and try again... (tryings = 8, bot id = 8543122898)
2026-02-14 19:33:53,414 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:33:53,414 - aiogram.dispatcher - WARNING - Sleep for 4.989095 seconds and try again... (tryings = 9, bot id = 8543122898)
2026-02-14 19:34:19,471 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:34:19,471 - aiogram.dispatcher - WARNING - Sleep for 4.954224 seconds and try again... (tryings = 10, bot id = 8543122898)
2026-02-14 19:34:45,491 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:34:45,491 - aiogram.dispatcher - WARNING - Sleep for 4.916448 seconds and try again... (tryings = 11, bot id = 8543122898)
2026-02-14 19:35:11,448 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:35:11,449 - aiogram.dispatcher - WARNING - Sleep for 5.235149 seconds and try again... (tryings = 12, bot id = 8543122898)
2026-02-14 19:35:37,723 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:35:37,724 - aiogram.dispatcher - WARNING - Sleep for 4.968383 seconds and try again... (tryings = 13, bot id = 8543122898)
2026-02-14 19:36:03,725 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:36:03,726 - aiogram.dispatcher - WARNING - Sleep for 5.029855 seconds and try again... (tryings = 14, bot id = 8543122898)
2026-02-14 19:36:29,810 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:36:29,810 - aiogram.dispatcher - WARNING - Sleep for 5.064530 seconds and try again... (tryings = 15, bot id = 8543122898)
2026-02-14 19:36:55,931 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:36:55,931 - aiogram.dispatcher - WARNING - Sleep for 5.066324 seconds and try again... (tryings = 16, bot id = 8543122898)
2026-02-14 19:37:22,049 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:37:22,050 - aiogram.dispatcher - WARNING - Sleep for 4.744164 seconds and try again... (tryings = 17, bot id = 8543122898)
2026-02-14 19:37:47,839 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:37:47,840 - aiogram.dispatcher - WARNING - Sleep for 5.084465 seconds and try again... (tryings = 18, bot id = 8543122898)
2026-02-14 19:38:13,964 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:38:13,965 - aiogram.dispatcher - WARNING - Sleep for 4.930109 seconds and try again... (tryings = 19, bot id = 8543122898)
2026-02-14 19:38:39,932 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:38:39,932 - aiogram.dispatcher - WARNING - Sleep for 5.199675 seconds and try again... (tryings = 20, bot id = 8543122898)
2026-02-14 19:39:06,172 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:39:06,172 - aiogram.dispatcher - WARNING - Sleep for 5.112275 seconds and try again... (tryings = 21, bot id = 8543122898)
2026-02-14 19:39:32,347 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:39:32,348 - aiogram.dispatcher - WARNING - Sleep for 4.932808 seconds and try again... (tryings = 22, bot id = 8543122898)
2026-02-14 19:39:58,331 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:39:58,332 - aiogram.dispatcher - WARNING - Sleep for 5.051382 seconds and try again... (tryings = 23, bot id = 8543122898)
2026-02-14 19:40:24,418 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:40:24,418 - aiogram.dispatcher - WARNING - Sleep for 4.936652 seconds and try again... (tryings = 24, bot id = 8543122898)
2026-02-14 19:40:50,421 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:40:50,421 - aiogram.dispatcher - WARNING - Sleep for 4.941382 seconds and try again... (tryings = 25, bot id = 8543122898)
2026-02-14 19:41:16,431 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:41:16,431 - aiogram.dispatcher - WARNING - Sleep for 4.816194 seconds and try again... (tryings = 26, bot id = 8543122898)
2026-02-14 19:41:42,300 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:41:42,300 - aiogram.dispatcher - WARNING - Sleep for 5.172261 seconds and try again... (tryings = 27, bot id = 8543122898)
2026-02-14 19:42:08,519 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:42:08,520 - aiogram.dispatcher - WARNING - Sleep for 4.806896 seconds and try again... (tryings = 28, bot id = 8543122898)
2026-02-14 19:42:34,365 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:42:34,365 - aiogram.dispatcher - WARNING - Sleep for 4.729066 seconds and try again... (tryings = 29, bot id = 8543122898)
2026-02-14 19:43:00,151 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:43:00,151 - aiogram.dispatcher - WARNING - Sleep for 4.942515 seconds and try again... (tryings = 30, bot id = 8543122898)
2026-02-14 19:43:26,134 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:43:26,134 - aiogram.dispatcher - WARNING - Sleep for 4.982957 seconds and try again... (tryings = 31, bot id = 8543122898)
2026-02-14 19:43:52,182 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:43:52,182 - aiogram.dispatcher - WARNING - Sleep for 5.002013 seconds and try again... (tryings = 32, bot id = 8543122898)
2026-02-14 19:44:18,246 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:44:18,246 - aiogram.dispatcher - WARNING - Sleep for 4.989770 seconds and try again... (tryings = 33, bot id = 8543122898)
2026-02-14 19:44:44,285 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:44:44,285 - aiogram.dispatcher - WARNING - Sleep for 4.882889 seconds and try again... (tryings = 34, bot id = 8543122898)
2026-02-14 19:45:10,216 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:45:10,216 - aiogram.dispatcher - WARNING - Sleep for 5.151549 seconds and try again... (tryings = 35, bot id = 8543122898)
2026-02-14 19:45:36,412 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ClientConnectorError: Cannot connect to host api.telegram.org:443 ssl:default [Превышен таймаут семафора]
2026-02-14 19:45:36,412 - aiogram.dispatcher - WARNING - Sleep for 4.925049 seconds and try again... (tryings = 36, bot id = 8543122898)
2026-02-14 19:45:51,958 - aiogram.dispatcher - INFO - Connection established (tryings = 37, bot id = 8543122898)
2026-02-14 20:28:42,718 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-14 20:28:42,730 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-14 20:28:57,515 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-14 20:28:57,544 - aiogram.dispatcher - WARNING - Sleep for 1.133243 seconds and try again... (tryings = 1, bot id = 8543122898)
2026-02-14 20:29:09,398 - aiogram.dispatcher - INFO - Connection established (tryings = 2, bot id = 8543122898)
2026-02-18 13:34:32,947 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x00000234639E9D30>
2026-02-18 13:34:32,947 - asyncio - ERROR - Unclosed connector
connections: ['deque([(<aiohttp.client_proto.ResponseHandler object at 0x0000023463A69C10>, 9073.6131709)])']
connector: <aiohttp.connector.TCPConnector object at 0x00000234639E9940>
2026-02-18 13:35:08,559 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002087CC19D30>
2026-02-18 13:35:08,560 - asyncio - ERROR - Unclosed connector
connections: ['deque([(<aiohttp.client_proto.ResponseHandler object at 0x000002087CC99C10>, 9109.2355663)])']
connector: <aiohttp.connector.TCPConnector object at 0x000002087CC19940>
2026-02-18 13:35:39,961 - asyncio - ERROR - Unclosed client session
client_session: <aiohttp.client.ClientSession object at 0x000002B38ECD9D30>
2026-02-18 13:35:39,962 - asyncio - ERROR - Unclosed connector
connections: ['deque([(<aiohttp.client_proto.ResponseHandler object at 0x000002B38ED59C10>, 9140.6402186)])']
connector: <aiohttp.connector.TCPConnector object at 0x000002B38ECD9940>
2026-02-18 13:36:04,757 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 13:36:04,759 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 13:36:04,759 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 13:36:04,760 - aiogram.dispatcher - INFO - Start polling
2026-02-18 13:36:04,861 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 13:36:14,358 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:36:14,358 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 13:36:14,359 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,385 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 13:36:14,386 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,387 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 13:36:14,387 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,387 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 13:36:14,387 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,388 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 13:36:14,388 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,389 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 13:36:14,389 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,391 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 13:36:14,391 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 13:36:14,413 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 13:36:14,414 - sqlalchemy.engine.Engine - INFO - [no key 0.00063s] ()
2026-02-18 13:36:14,424 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 13:36:14,425 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 13:36:14,435 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 13:36:14,436 - sqlalchemy.engine.Engine - INFO - [no key 0.00052s] ()
2026-02-18 13:36:14,446 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 13:36:14,447 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,447 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 13:36:14,448 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,448 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 13:36:14,448 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,449 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 13:36:14,449 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,449 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 13:36:14,450 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,450 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 13:36:14,450 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,452 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 13:36:14,452 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,453 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 13:36:14,453 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,454 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 13:36:14,454 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,455 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 13:36:14,455 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:36:14,456 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 13:36:14,456 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 13:36:14,466 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 13:36:14,466 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 13:36:14,475 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:36:14,476 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-18 13:36:14,485 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 13:36:14,486 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 13:36:14,518 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:36:14,520 - sqlalchemy.engine.Engine - INFO - [no key 0.00181s] ()
2026-02-18 13:36:14,536 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:36:14,539 - sqlalchemy.engine.Engine - INFO - [no key 0.00309s] ()
2026-02-18 13:36:14,554 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:36:14,556 - sqlalchemy.engine.Engine - INFO - [no key 0.00143s] ()
2026-02-18 13:36:14,566 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:36:14,567 - aiogram.event - INFO - Update id=66295054 is handled. Duration 2893 ms by bot id=8543122898
2026-02-18 13:36:16,242 - aiogram.event - INFO - Update id=66295055 is not handled. Duration 0 ms by bot id=8543122898
2026-02-18 13:36:16,242 - aiogram.event - ERROR - Cause exception while process update id=66295055 by bot id=8543122898
TypeError: VPNService.__init__() missing 1 required positional argument: 'session'
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\start_cmd.py", line 36, in start_cmd
    client = VPNService()
TypeError: VPNService.__init__() missing 1 required positional argument: 'session'
2026-02-18 13:36:31,237 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 13:36:31,238 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 13:36:31,238 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 13:36:31,498 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 13:36:41,836 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 13:36:41,837 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 13:36:41,837 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 13:36:41,837 - aiogram.dispatcher - INFO - Start polling
2026-02-18 13:36:41,936 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 13:36:43,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:36:43,478 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 13:36:43,478 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (7946439246,)
2026-02-18 13:36:43,480 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 13:36:43,481 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] (7946439246, '2026-02-18 13:36:43.480037', 0)
2026-02-18 13:36:43,482 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:36:43,495 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 13:36:43,496 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 13:36:44,373 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 13:36:44,374 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:36:44,374 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 13:36:44,375 - sqlalchemy.engine.Engine - INFO - [cached since 0.8966s ago] (7946439246,)
2026-02-18 13:36:44,376 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 13:36:44,376 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] (7946439246, '2026-02-18 13:36:44.375949', 'active', 1)
2026-02-18 13:36:44,379 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:36:44,390 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 13:36:45,765 - aiogram.event - INFO - Update id=66295057 is handled. Duration 2296 ms by bot id=8543122898
2026-02-18 13:39:13,075 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:39:13,075 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 13:39:13,075 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,076 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 13:39:13,076 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,077 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 13:39:13,078 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,079 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 13:39:13,079 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,079 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 13:39:13,080 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,081 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 13:39:13,087 - sqlalchemy.engine.Engine - INFO - [no key 0.00640s] ()
2026-02-18 13:39:13,100 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 13:39:13,101 - sqlalchemy.engine.Engine - INFO - [no key 0.00039s] ()
2026-02-18 13:39:13,110 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 13:39:13,111 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2026-02-18 13:39:13,122 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 13:39:13,122 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 13:39:13,134 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 13:39:13,134 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 13:39:13,174 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 13:39:13,181 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,183 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 13:39:13,183 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,184 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 13:39:13,184 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,185 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 13:39:13,185 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,186 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 13:39:13,186 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,187 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 13:39:13,187 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,187 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 13:39:13,187 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,188 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 13:39:13,188 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,189 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 13:39:13,190 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,191 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 13:39:13,191 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:13,193 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 13:39:13,193 - sqlalchemy.engine.Engine - INFO - [no key 0.00042s] ()
2026-02-18 13:39:13,204 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 13:39:13,204 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 13:39:13,217 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:39:13,217 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 13:39:13,229 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 13:39:13,229 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 13:39:13,242 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:39:13,242 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-18 13:39:13,254 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:39:13,254 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 13:39:13,262 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:39:13,262 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 13:39:13,271 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:39:13,271 - aiogram.event - INFO - Update id=66295058 is handled. Duration 321 ms by bot id=8543122898
2026-02-18 13:39:17,619 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:39:17,620 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 13:39:17,620 - sqlalchemy.engine.Engine - INFO - [cached since 154.1s ago] (7946439246,)
2026-02-18 13:39:17,622 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 13:39:17,622 - sqlalchemy.engine.Engine - INFO - [cached since 154.1s ago] (7946439246, '2026-02-18 13:39:17.621793', 0)
2026-02-18 13:39:17,626 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:39:17,634 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 13:39:17,634 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 13:39:18,653 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 400 Bad Request"
2026-02-18 13:39:18,654 - aiogram.event - INFO - Update id=66295059 is not handled. Duration 1035 ms by bot id=8543122898
2026-02-18 13:39:18,654 - aiogram.event - ERROR - Cause exception while process update id=66295059 by bot id=8543122898
ConflictError: API Error A019: User username already exists (HTTP 400)
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 68, in _handle_response
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_models.py", line 763, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://admin.kurvpn.tech/api/users'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\start_cmd.py", line 43, in start_cmd
    await client.get_vpn_subscription(tg_user)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 59, in create_client
    return await self.rem.users.create_user(create_body)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\decorators.py", line 43, in wrapper
    return api._handle_response(response, response_class=response_class)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 70, in _handle_response
    handle_api_error(e.response)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\exceptions\handler.py", line 217, in handle_api_error
    raise exception_class(response.status_code, error_response)
remnawave.exceptions.general.ConflictError: API Error A019: User username already exists (HTTP 400)
2026-02-18 13:39:28,197 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 13:39:28,197 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 13:39:28,198 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 13:39:28,462 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 13:39:34,217 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 13:39:34,218 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 13:39:34,218 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 13:39:34,219 - aiogram.dispatcher - INFO - Start polling
2026-02-18 13:39:34,308 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 13:39:38,071 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:39:38,071 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 13:39:38,071 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,072 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 13:39:38,072 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,073 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 13:39:38,073 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,074 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 13:39:38,074 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,075 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 13:39:38,075 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,076 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 13:39:38,077 - sqlalchemy.engine.Engine - INFO - [no key 0.00063s] ()
2026-02-18 13:39:38,090 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 13:39:38,091 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 13:39:38,101 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 13:39:38,101 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 13:39:38,113 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 13:39:38,113 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 13:39:38,131 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 13:39:38,132 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 13:39:38,140 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 13:39:38,140 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,141 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 13:39:38,141 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,142 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 13:39:38,143 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,143 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 13:39:38,144 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,144 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 13:39:38,144 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,145 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 13:39:38,146 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,147 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 13:39:38,147 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,148 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 13:39:38,148 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,149 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 13:39:38,149 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,150 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 13:39:38,150 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:39:38,151 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 13:39:38,151 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 13:39:38,161 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 13:39:38,161 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 13:39:38,171 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:39:38,172 - sqlalchemy.engine.Engine - INFO - [no key 0.00075s] ()
2026-02-18 13:39:38,183 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 13:39:38,183 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 13:39:38,194 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:39:38,194 - sqlalchemy.engine.Engine - INFO - [no key 0.00042s] ()
2026-02-18 13:39:38,204 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:39:38,205 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 13:39:38,215 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:39:38,216 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 13:39:38,242 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:39:38,244 - aiogram.event - INFO - Update id=66295061 is handled. Duration 819 ms by bot id=8543122898
2026-02-18 13:39:40,179 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:39:40,186 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 13:39:40,187 - sqlalchemy.engine.Engine - INFO - [generated in 0.00132s] (7946439246,)
2026-02-18 13:39:40,191 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 13:39:40,192 - sqlalchemy.engine.Engine - INFO - [generated in 0.00100s] (7946439246, '2026-02-18 13:39:40.190259', 0)
2026-02-18 13:39:40,194 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:39:40,206 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 13:39:40,206 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 13:39:40,980 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 400 Bad Request"
2026-02-18 13:39:40,980 - aiogram.event - INFO - Update id=66295062 is not handled. Duration 802 ms by bot id=8543122898
2026-02-18 13:39:40,980 - aiogram.event - ERROR - Cause exception while process update id=66295062 by bot id=8543122898
ConflictError: API Error A019: User username already exists (HTTP 400)
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 68, in _handle_response
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_models.py", line 763, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://admin.kurvpn.tech/api/users'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\start_cmd.py", line 43, in start_cmd
    await client.get_vpn_subscription(tg_user)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 62, in get_vpn_subscription
    user = await self.create_client(tg_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 59, in create_client
    return await self.rem.users.create_user(create_body)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\decorators.py", line 43, in wrapper
    return api._handle_response(response, response_class=response_class)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 70, in _handle_response
    handle_api_error(e.response)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\exceptions\handler.py", line 217, in handle_api_error
    raise exception_class(response.status_code, error_response)
remnawave.exceptions.general.ConflictError: API Error A019: User username already exists (HTTP 400)
2026-02-18 13:41:09,597 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 13:41:09,597 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 13:41:09,598 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 13:41:09,856 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 13:41:14,831 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 13:41:14,832 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 13:41:14,832 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 13:41:14,832 - aiogram.dispatcher - INFO - Start polling
2026-02-18 13:41:14,928 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 13:41:16,699 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:41:16,699 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 13:41:16,699 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,701 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 13:41:16,701 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,702 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 13:41:16,703 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,704 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 13:41:16,708 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,709 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 13:41:16,710 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,711 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 13:41:16,711 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-18 13:41:16,729 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 13:41:16,729 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2026-02-18 13:41:16,739 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 13:41:16,739 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 13:41:16,751 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 13:41:16,751 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 13:41:16,761 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 13:41:16,761 - sqlalchemy.engine.Engine - INFO - [no key 0.00044s] ()
2026-02-18 13:41:16,772 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 13:41:16,772 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,773 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 13:41:16,773 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,774 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 13:41:16,774 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,774 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 13:41:16,775 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,775 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 13:41:16,775 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,776 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 13:41:16,776 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,776 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 13:41:16,776 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,777 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 13:41:16,777 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,777 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 13:41:16,777 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,778 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 13:41:16,778 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:41:16,779 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 13:41:16,779 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 13:41:16,789 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 13:41:16,790 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 13:41:16,800 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:41:16,800 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2026-02-18 13:41:16,811 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 13:41:16,811 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 13:41:16,821 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:41:16,821 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 13:41:16,834 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:41:16,834 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2026-02-18 13:41:16,845 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:41:16,845 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 13:41:16,856 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:41:16,856 - aiogram.event - INFO - Update id=66295063 is handled. Duration 825 ms by bot id=8543122898
2026-02-18 13:41:18,070 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:41:18,078 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 13:41:18,078 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (7946439246,)
2026-02-18 13:41:18,080 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 13:41:18,081 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] (7946439246, '2026-02-18 13:41:18.079894', 0)
2026-02-18 13:41:18,082 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:41:18,094 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 13:41:18,094 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 13:41:18,794 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 13:41:18,795 - aiogram.event - INFO - Update id=66295064 is not handled. Duration 725 ms by bot id=8543122898
2026-02-18 13:41:18,795 - aiogram.event - ERROR - Cause exception while process update id=66295064 by bot id=8543122898
ValidationError: 1 validation error for str
  Input should be a valid string [type=string_type, input_value=UUID('70f776e5-c85a-4f7b-a03d-4299402d25f3'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\start_cmd.py", line 43, in start_cmd
    await client.get_vpn_subscription(tg_user)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 63, in get_vpn_subscription
    subscription = await self.rem.subscriptions.get_subscription_by_uuid(user.uuid)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\decorators.py", line 38, in wrapper
    request = api._build_request(
        sig, rapid_parameters, method, path, (api,) + args, kwargs, timeout
    )
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 44, in _build_request
    path = rapid_parameters.get_resolved_path(path, ba)
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\rapid_api_client\client.py", line 129, in get_resolved_path
    {p.get_name(): p.get_value(ba) for p in self.path_parameters}
                   ~~~~~~~~~~~^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\rapid_api_client\client.py", line 72, in get_value
    out = TypeAdapter(self.param.annotation).validate_python(out)
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\pydantic\type_adapter.py", line 421, in validate_python
    return self.validator.validate_python(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        object,
        ^^^^^^^
    ...<5 lines>...
        by_name=by_name,
        ^^^^^^^^^^^^^^^^
    )
    ^
pydantic_core._pydantic_core.ValidationError: 1 validation error for str
  Input should be a valid string [type=string_type, input_value=UUID('70f776e5-c85a-4f7b-a03d-4299402d25f3'), input_type=UUID]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2026-02-18 13:55:48,102 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 13:55:48,104 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 13:55:48,104 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 13:55:48,364 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 13:55:55,784 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 13:55:55,784 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 13:55:55,785 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 13:55:55,785 - aiogram.dispatcher - INFO - Start polling
2026-02-18 13:55:55,888 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 13:55:59,616 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:55:59,617 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 13:55:59,617 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,618 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 13:55:59,619 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,619 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 13:55:59,620 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,621 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 13:55:59,621 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,622 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 13:55:59,622 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,624 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 13:55:59,624 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2026-02-18 13:55:59,635 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 13:55:59,635 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 13:55:59,644 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 13:55:59,644 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-18 13:55:59,653 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 13:55:59,653 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2026-02-18 13:55:59,663 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 13:55:59,663 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2026-02-18 13:55:59,675 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 13:55:59,675 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,676 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 13:55:59,676 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,677 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 13:55:59,677 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,678 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 13:55:59,679 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,679 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 13:55:59,679 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,680 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 13:55:59,680 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,681 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 13:55:59,681 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,682 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 13:55:59,682 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,683 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 13:55:59,683 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,684 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 13:55:59,684 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:55:59,685 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 13:55:59,685 - sqlalchemy.engine.Engine - INFO - [no key 0.00018s] ()
2026-02-18 13:55:59,695 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 13:55:59,695 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-18 13:55:59,705 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:55:59,705 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 13:55:59,715 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 13:55:59,715 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 13:55:59,724 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:55:59,724 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 13:55:59,734 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:55:59,734 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 13:55:59,744 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:55:59,744 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 13:55:59,754 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:55:59,754 - aiogram.event - INFO - Update id=66295065 is handled. Duration 1442 ms by bot id=8543122898
2026-02-18 13:56:01,232 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:56:01,239 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 13:56:01,239 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (7946439246,)
2026-02-18 13:56:01,241 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 13:56:01,241 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (7946439246, '2026-02-18 13:56:01.240485', 0)
2026-02-18 13:56:01,243 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:56:01,252 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 13:56:01,252 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 13:56:02,106 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 400 Bad Request"
2026-02-18 13:56:02,106 - aiogram.event - INFO - Update id=66295066 is not handled. Duration 875 ms by bot id=8543122898
2026-02-18 13:56:02,107 - aiogram.event - ERROR - Cause exception while process update id=66295066 by bot id=8543122898
ConflictError: API Error A019: User username already exists (HTTP 400)
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 68, in _handle_response
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_models.py", line 763, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://admin.kurvpn.tech/api/users'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\start_cmd.py", line 43, in start_cmd
    await client.get_vpn_subscription(tg_user)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 68, in get_vpn_subscription
    rem_user = await self.create_client(tg_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 64, in create_client
    return await self.rem.users.create_user(create_body)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\decorators.py", line 43, in wrapper
    return api._handle_response(response, response_class=response_class)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 70, in _handle_response
    handle_api_error(e.response)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\exceptions\handler.py", line 217, in handle_api_error
    raise exception_class(response.status_code, error_response)
remnawave.exceptions.general.ConflictError: API Error A019: User username already exists (HTTP 400)
2026-02-18 13:57:04,201 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 13:57:04,202 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 13:57:04,202 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 13:57:04,459 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 13:57:08,329 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 13:57:08,330 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 13:57:08,330 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 13:57:08,332 - aiogram.dispatcher - INFO - Start polling
2026-02-18 13:57:08,419 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 13:57:09,149 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:57:09,150 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 13:57:09,150 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,152 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 13:57:09,152 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,153 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 13:57:09,154 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,154 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 13:57:09,155 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,155 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 13:57:09,155 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,156 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 13:57:09,156 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 13:57:09,170 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 13:57:09,171 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 13:57:09,181 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 13:57:09,181 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 13:57:09,196 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 13:57:09,204 - sqlalchemy.engine.Engine - INFO - [no key 0.00850s] ()
2026-02-18 13:57:09,231 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 13:57:09,232 - sqlalchemy.engine.Engine - INFO - [no key 0.00132s] ()
2026-02-18 13:57:09,248 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 13:57:09,249 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,250 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 13:57:09,250 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,251 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 13:57:09,252 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,252 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 13:57:09,253 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,253 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 13:57:09,253 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,254 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 13:57:09,254 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,255 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 13:57:09,255 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,256 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 13:57:09,256 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,257 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 13:57:09,257 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,258 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 13:57:09,258 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 13:57:09,259 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 13:57:09,259 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 13:57:09,269 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 13:57:09,269 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 13:57:09,280 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:57:09,280 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 13:57:09,291 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 13:57:09,291 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 13:57:09,301 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:57:09,302 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2026-02-18 13:57:09,312 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:57:09,313 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-18 13:57:09,321 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 13:57:09,321 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 13:57:09,331 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:57:09,332 - aiogram.event - INFO - Update id=66295067 is handled. Duration 826 ms by bot id=8543122898
2026-02-18 13:57:13,328 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:57:13,337 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 13:57:13,337 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] (7946439246,)
2026-02-18 13:57:13,339 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 13:57:13,340 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] (7946439246, '2026-02-18 13:57:13.338493', 0)
2026-02-18 13:57:13,341 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:57:13,351 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 13:57:13,352 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 13:57:14,030 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 13:57:14,142 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/f2a74398-1cf8-4b54-95f6-00376df9fe39 "HTTP/1.1 200 OK"
2026-02-18 13:57:14,143 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:57:14,143 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 13:57:14,144 - sqlalchemy.engine.Engine - INFO - [cached since 0.8067s ago] (7946439246,)
2026-02-18 13:57:14,146 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 13:57:14,146 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ('https://sub.kurvpn.tech/SYTRC-GAHrLVfEWj', 'f2a74398-1cf8-4b54-95f6-00376df9fe39', '2026-02-21 10:57:13.352000', 1)
2026-02-18 13:57:14,147 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:57:14,161 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:57:14,161 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 13:57:14,162 - sqlalchemy.engine.Engine - INFO - [cached since 0.8251s ago] (7946439246,)
2026-02-18 13:57:14,163 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 13:57:14,164 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] (7946439246, '2026-02-18 13:57:14.163429', 'active', 1)
2026-02-18 13:57:14,165 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 13:57:14,174 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 13:57:14,450 - aiogram.event - INFO - Update id=66295068 is handled. Duration 1122 ms by bot id=8543122898
2026-02-18 13:57:32,247 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 13:57:32,247 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 13:57:32,247 - sqlalchemy.engine.Engine - INFO - [cached since 18.91s ago] (7946439246,)
2026-02-18 13:57:32,248 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 13:57:32,248 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 13:57:32,418 - aiogram.event - INFO - Update id=66295069 is handled. Duration 171 ms by bot id=8543122898
2026-02-18 14:02:36,567 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:02:36,568 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:02:36,568 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,569 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:02:36,569 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,569 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:02:36,569 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,570 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:02:36,570 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,571 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:02:36,571 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,572 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 14:02:36,572 - sqlalchemy.engine.Engine - INFO - [no key 0.00016s] ()
2026-02-18 14:02:36,583 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 14:02:36,583 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-18 14:02:36,595 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 14:02:36,595 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 14:02:36,604 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 14:02:36,604 - sqlalchemy.engine.Engine - INFO - [no key 0.00046s] ()
2026-02-18 14:02:36,614 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 14:02:36,614 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 14:02:36,624 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:02:36,624 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,624 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 14:02:36,625 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,625 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:02:36,625 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,626 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 14:02:36,626 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,627 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:02:36,627 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,628 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 14:02:36,628 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,628 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:02:36,628 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,629 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 14:02:36,629 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,629 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:02:36,629 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,630 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 14:02:36,630 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:36,631 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 14:02:36,631 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 14:02:36,641 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 14:02:36,641 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 14:02:36,650 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:02:36,650 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 14:02:36,660 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 14:02:36,660 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 14:02:36,670 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:02:36,671 - sqlalchemy.engine.Engine - INFO - [no key 0.00146s] ()
2026-02-18 14:02:36,682 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:02:36,682 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 14:02:36,693 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:02:36,694 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-18 14:02:36,702 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:02:36,702 - aiogram.event - INFO - Update id=66295070 is handled. Duration 259 ms by bot id=8543122898
2026-02-18 14:02:45,702 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 14:02:45,702 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 14:02:45,703 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 14:02:45,961 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 14:02:51,244 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 14:02:51,245 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 14:02:51,245 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 14:02:51,245 - aiogram.dispatcher - INFO - Start polling
2026-02-18 14:02:51,350 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 14:02:56,331 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:02:56,332 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:02:56,332 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,333 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:02:56,333 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,334 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:02:56,334 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,334 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:02:56,335 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,335 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:02:56,336 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,336 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 14:02:56,336 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 14:02:56,350 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 14:02:56,350 - sqlalchemy.engine.Engine - INFO - [no key 0.00051s] ()
2026-02-18 14:02:56,360 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 14:02:56,361 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 14:02:56,370 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 14:02:56,371 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2026-02-18 14:02:56,381 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 14:02:56,383 - sqlalchemy.engine.Engine - INFO - [no key 0.00111s] ()
2026-02-18 14:02:56,393 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:02:56,393 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,394 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 14:02:56,395 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,396 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:02:56,396 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,397 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 14:02:56,398 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,398 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:02:56,399 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,399 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 14:02:56,400 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,400 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:02:56,400 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,401 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 14:02:56,401 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,401 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:02:56,401 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,402 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 14:02:56,402 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:02:56,403 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 14:02:56,403 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 14:02:56,429 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 14:02:56,429 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 14:02:56,439 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:02:56,440 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-18 14:02:56,449 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 14:02:56,449 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 14:02:56,459 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:02:56,460 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2026-02-18 14:02:56,470 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:02:56,471 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2026-02-18 14:02:56,482 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:02:56,482 - sqlalchemy.engine.Engine - INFO - [no key 0.00056s] ()
2026-02-18 14:02:56,492 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:02:56,493 - aiogram.event - INFO - Update id=66295072 is handled. Duration 810 ms by bot id=8543122898
2026-02-18 14:02:57,488 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:02:57,495 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:02:57,497 - sqlalchemy.engine.Engine - INFO - [generated in 0.00199s] (7946439246,)
2026-02-18 14:02:57,499 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 14:02:57,500 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] (7946439246, '2026-02-18 14:02:57.498953', 0)
2026-02-18 14:02:57,501 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:02:57,511 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 14:02:57,512 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 14:02:58,427 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 14:02:58,534 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/188de9fc-28f3-442f-9727-70a4ba103bd2 "HTTP/1.1 200 OK"
2026-02-18 14:02:58,535 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:02:58,536 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:02:58,536 - sqlalchemy.engine.Engine - INFO - [cached since 1.041s ago] (7946439246,)
2026-02-18 14:02:58,537 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:02:58,538 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ('https://sub.kurvpn.tech/0hjW4PpXXth7j5Ty', '188de9fc-28f3-442f-9727-70a4ba103bd2', '2026-02-21 14:02:57.512000', 1)
2026-02-18 14:02:58,539 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:02:58,549 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:02:58,549 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:02:58,550 - sqlalchemy.engine.Engine - INFO - [cached since 1.055s ago] (7946439246,)
2026-02-18 14:02:58,551 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:02:58,551 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] (7946439246, '2026-02-18 14:02:58.550641', 'active', 1)
2026-02-18 14:02:58,553 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:02:58,563 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 14:02:58,862 - aiogram.event - INFO - Update id=66295073 is handled. Duration 1375 ms by bot id=8543122898
2026-02-18 14:06:45,446 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 14:06:45,447 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 14:06:45,447 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 14:06:45,700 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 14:07:07,931 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 14:07:07,932 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 14:07:07,932 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 14:07:07,932 - aiogram.dispatcher - INFO - Start polling
2026-02-18 14:07:08,030 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 14:07:08,823 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:07:08,824 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:07:08,824 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,825 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:07:08,825 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,826 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:07:08,826 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,826 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:07:08,827 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,827 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:07:08,827 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,828 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 14:07:08,828 - sqlalchemy.engine.Engine - INFO - [no key 0.00017s] ()
2026-02-18 14:07:08,838 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 14:07:08,838 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 14:07:08,848 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 14:07:08,848 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2026-02-18 14:07:08,858 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 14:07:08,859 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 14:07:08,869 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 14:07:08,869 - sqlalchemy.engine.Engine - INFO - [no key 0.00048s] ()
2026-02-18 14:07:08,880 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:07:08,880 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,881 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 14:07:08,881 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,882 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:07:08,882 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,883 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 14:07:08,883 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,883 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:07:08,884 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,884 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 14:07:08,884 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,885 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:07:08,885 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,886 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 14:07:08,886 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,887 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:07:08,887 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,888 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 14:07:08,888 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:07:08,889 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 14:07:08,889 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 14:07:08,928 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 14:07:08,928 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 14:07:08,941 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:07:08,942 - sqlalchemy.engine.Engine - INFO - [no key 0.00116s] ()
2026-02-18 14:07:08,952 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 14:07:08,952 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 14:07:08,962 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:07:08,962 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 14:07:08,972 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:07:08,973 - sqlalchemy.engine.Engine - INFO - [no key 0.00039s] ()
2026-02-18 14:07:08,982 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:07:08,983 - sqlalchemy.engine.Engine - INFO - [no key 0.00042s] ()
2026-02-18 14:07:08,993 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:07:08,994 - aiogram.event - INFO - Update id=66295076 is handled. Duration 828 ms by bot id=8543122898
2026-02-18 14:07:09,828 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:07:09,839 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:07:09,839 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] (7946439246,)
2026-02-18 14:07:09,841 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 14:07:09,842 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] (7946439246, '2026-02-18 14:07:09.840652', 0)
2026-02-18 14:07:09,843 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:07:09,854 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 14:07:09,854 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 14:07:10,636 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 14:07:10,749 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/52ecfb86-c528-45f6-b0fb-7d914da0e544 "HTTP/1.1 200 OK"
2026-02-18 14:07:10,750 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:07:10,750 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:07:10,750 - sqlalchemy.engine.Engine - INFO - [cached since 0.9119s ago] (7946439246,)
2026-02-18 14:07:10,752 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:07:10,752 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ('https://sub.kurvpn.tech/3aGxuSRCzNrq9KXj', '52ecfb86-c528-45f6-b0fb-7d914da0e544', '2026-02-21 14:07:09.854000', 1)
2026-02-18 14:07:10,753 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:07:10,762 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:07:10,763 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:07:10,764 - sqlalchemy.engine.Engine - INFO - [cached since 0.9252s ago] (7946439246,)
2026-02-18 14:07:10,767 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:07:10,768 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] (7946439246, '2026-02-18 14:07:10.767254', 'active', 1)
2026-02-18 14:07:10,769 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:07:10,779 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 14:07:11,027 - aiogram.event - INFO - Update id=66295077 is handled. Duration 1199 ms by bot id=8543122898
2026-02-18 14:07:13,138 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:07:13,139 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 14:07:13,139 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] (7946439246,)
2026-02-18 14:07:13,246 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 400 Bad Request"
2026-02-18 14:07:13,247 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 14:07:13,248 - aiogram.event - INFO - Update id=66295078 is not handled. Duration 110 ms by bot id=8543122898
2026-02-18 14:07:13,248 - aiogram.event - ERROR - Cause exception while process update id=66295078 by bot id=8543122898
ConflictError: API Error A019: User username already exists (HTTP 400)
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 68, in _handle_response
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_models.py", line 763, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://admin.kurvpn.tech/api/users'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\my_vpn.py", line 35, in my_vpn
    vpn = await vpn.get_vpn_subscription(tg_user)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 42, in get_vpn_subscription
    rem_user = await self.create_client(tg_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 38, in create_client
    return await self.rem.users.create_user(create_body)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\decorators.py", line 43, in wrapper
    return api._handle_response(response, response_class=response_class)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 70, in _handle_response
    handle_api_error(e.response)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\exceptions\handler.py", line 217, in handle_api_error
    raise exception_class(response.status_code, error_response)
remnawave.exceptions.general.ConflictError: API Error A019: User username already exists (HTTP 400)
2026-02-18 14:19:15,759 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 14:19:15,760 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 14:19:15,760 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 14:19:16,013 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 14:19:22,157 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 14:19:22,158 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 14:19:22,158 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 14:19:22,158 - aiogram.dispatcher - INFO - Start polling
2026-02-18 14:19:22,257 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 14:19:23,190 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:19:23,191 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:19:23,191 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,192 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:19:23,192 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,193 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:19:23,193 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,193 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:19:23,193 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,194 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:19:23,194 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,195 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 14:19:23,195 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 14:19:23,207 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 14:19:23,207 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 14:19:23,217 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 14:19:23,218 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 14:19:23,227 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 14:19:23,228 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 14:19:23,239 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 14:19:23,239 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 14:19:23,250 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:19:23,250 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,250 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 14:19:23,251 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,251 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:19:23,251 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,252 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 14:19:23,252 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,252 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:19:23,252 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,253 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 14:19:23,253 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,254 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:19:23,254 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,254 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 14:19:23,255 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,255 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:19:23,255 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,256 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 14:19:23,256 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:19:23,256 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 14:19:23,257 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 14:19:23,266 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 14:19:23,267 - sqlalchemy.engine.Engine - INFO - [no key 0.00019s] ()
2026-02-18 14:19:23,277 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:19:23,277 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 14:19:23,287 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 14:19:23,288 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 14:19:23,299 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:19:23,299 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 14:19:23,310 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:19:23,310 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-18 14:19:23,320 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:19:23,321 - sqlalchemy.engine.Engine - INFO - [no key 0.00120s] ()
2026-02-18 14:19:23,331 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:19:23,331 - aiogram.event - INFO - Update id=66295080 is handled. Duration 875 ms by bot id=8543122898
2026-02-18 14:19:25,182 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:19:25,189 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:19:25,189 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] (7946439246,)
2026-02-18 14:19:25,192 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 14:19:25,192 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] (7946439246, '2026-02-18 14:19:25.191161', 0)
2026-02-18 14:19:25,194 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:19:25,206 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 14:19:25,206 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 14:19:25,865 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 14:19:25,977 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/244eaddd-4fae-4e6d-99ac-dd0c5a413c80 "HTTP/1.1 200 OK"
2026-02-18 14:19:25,978 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:19:25,978 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:19:25,978 - sqlalchemy.engine.Engine - INFO - [cached since 0.7894s ago] (7946439246,)
2026-02-18 14:19:25,979 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:19:25,980 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] ('https://sub.kurvpn.tech/4u0Fdo0dEM16Fvrc', '244eaddd-4fae-4e6d-99ac-dd0c5a413c80', '2026-02-21 14:19:25.206000', 1)
2026-02-18 14:19:25,981 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:19:25,990 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:19:25,992 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:19:25,993 - sqlalchemy.engine.Engine - INFO - [cached since 0.8042s ago] (7946439246,)
2026-02-18 14:19:25,995 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:19:25,995 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] (7946439246, '2026-02-18 14:19:25.994643', 'active', 1)
2026-02-18 14:19:25,997 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:19:26,008 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 14:19:26,284 - aiogram.event - INFO - Update id=66295081 is handled. Duration 1102 ms by bot id=8543122898
2026-02-18 14:19:28,537 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:19:28,538 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 14:19:28,538 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (7946439246,)
2026-02-18 14:19:28,539 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:19:28,539 - sqlalchemy.engine.Engine - INFO - [cached since 3.35s ago] (7946439246,)
2026-02-18 14:19:28,540 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 14:19:28,541 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] (1,)
2026-02-18 14:19:28,647 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/244eaddd-4fae-4e6d-99ac-dd0c5a413c80 "HTTP/1.1 200 OK"
2026-02-18 14:19:28,648 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 14:19:28,648 - aiogram.event - INFO - Update id=66295082 is not handled. Duration 112 ms by bot id=8543122898
2026-02-18 14:19:28,649 - aiogram.event - ERROR - Cause exception while process update id=66295082 by bot id=8543122898
AttributeError: 'str' object has no attribute 'expired_at'
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\my_vpn.py", line 40, in my_vpn
    if vpn.expired_at < now:
       ^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'expired_at'
2026-02-18 14:25:54,612 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 14:25:54,613 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 14:25:54,613 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 14:25:54,868 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 14:27:28,273 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 14:27:28,274 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 14:27:28,274 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 14:27:28,274 - aiogram.dispatcher - INFO - Start polling
2026-02-18 14:27:28,365 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 14:27:34,882 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:27:34,884 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:27:34,884 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,885 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:27:34,885 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,886 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:27:34,887 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,888 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:27:34,888 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,890 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:27:34,890 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,891 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 14:27:34,892 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 14:27:34,903 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 14:27:34,904 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 14:27:34,918 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 14:27:34,918 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 14:27:34,929 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 14:27:34,929 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 14:27:34,940 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 14:27:34,940 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 14:27:34,952 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:27:34,952 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,953 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 14:27:34,953 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,954 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:27:34,954 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,954 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 14:27:34,954 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,956 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:27:34,956 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,957 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 14:27:34,957 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,957 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:27:34,957 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,958 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 14:27:34,958 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,959 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:27:34,959 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,960 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 14:27:34,960 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:27:34,961 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 14:27:34,961 - sqlalchemy.engine.Engine - INFO - [no key 0.00062s] ()
2026-02-18 14:27:34,973 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 14:27:34,973 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 14:27:34,984 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:27:34,984 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2026-02-18 14:27:34,995 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 14:27:34,996 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 14:27:35,006 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:27:35,007 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 14:27:35,017 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:27:35,018 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 14:27:35,027 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:27:35,028 - sqlalchemy.engine.Engine - INFO - [no key 0.00050s] ()
2026-02-18 14:27:35,038 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:27:35,039 - aiogram.event - INFO - Update id=66295083 is handled. Duration 782 ms by bot id=8543122898
2026-02-18 14:27:44,581 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:27:44,590 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:27:44,594 - sqlalchemy.engine.Engine - INFO - [generated in 0.00411s] (7946439246,)
2026-02-18 14:27:44,597 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 14:27:44,598 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] (7946439246, '2026-02-18 14:27:44.596397', 0)
2026-02-18 14:27:44,604 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:27:44,616 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 14:27:44,616 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 14:27:45,364 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 14:27:45,478 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/4b627e4f-73a9-40e8-9686-b63bc874cb5b "HTTP/1.1 200 OK"
2026-02-18 14:27:45,479 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:27:45,479 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:27:45,479 - sqlalchemy.engine.Engine - INFO - [cached since 0.8892s ago] (7946439246,)
2026-02-18 14:27:45,480 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:27:45,481 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] ('https://sub.kurvpn.tech/eDurrT2uNL1haH1q', '4b627e4f-73a9-40e8-9686-b63bc874cb5b', '2026-02-21 14:27:44.616000', 1)
2026-02-18 14:27:45,482 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:27:45,492 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:27:45,492 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:27:45,493 - sqlalchemy.engine.Engine - INFO - [cached since 0.9026s ago] (7946439246,)
2026-02-18 14:27:45,494 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:27:45,495 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] (7946439246, '2026-02-18 14:27:45.493947', 'active', 1)
2026-02-18 14:27:45,497 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:27:45,507 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 14:27:45,748 - aiogram.event - INFO - Update id=66295084 is handled. Duration 1167 ms by bot id=8543122898
2026-02-18 14:27:48,731 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:27:48,732 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 14:27:48,733 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (7946439246,)
2026-02-18 14:27:48,734 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:27:48,734 - sqlalchemy.engine.Engine - INFO - [cached since 4.144s ago] (7946439246,)
2026-02-18 14:27:48,735 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 14:27:48,735 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] (1,)
2026-02-18 14:27:48,842 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/4b627e4f-73a9-40e8-9686-b63bc874cb5b "HTTP/1.1 200 OK"
2026-02-18 14:27:48,843 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 14:27:48,843 - aiogram.event - INFO - Update id=66295085 is not handled. Duration 112 ms by bot id=8543122898
2026-02-18 14:27:48,844 - aiogram.event - ERROR - Cause exception while process update id=66295085 by bot id=8543122898
AttributeError: 'str' object has no attribute 'expired_at'
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\my_vpn.py", line 40, in my_vpn
    if vpn.expired_at < now:
       ^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'expired_at'
2026-02-18 14:28:00,799 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 14:28:00,799 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 14:28:00,800 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 14:28:01,053 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 14:28:19,334 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 14:28:19,335 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 14:28:19,335 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 14:28:19,335 - aiogram.dispatcher - INFO - Start polling
2026-02-18 14:28:19,705 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 14:28:24,884 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:28:24,885 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:28:24,885 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,886 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:28:24,887 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,888 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:28:24,888 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,889 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:28:24,889 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,890 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:28:24,890 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,891 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 14:28:24,891 - sqlalchemy.engine.Engine - INFO - [no key 0.00019s] ()
2026-02-18 14:28:24,903 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 14:28:24,904 - sqlalchemy.engine.Engine - INFO - [no key 0.00055s] ()
2026-02-18 14:28:24,915 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 14:28:24,915 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 14:28:24,926 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 14:28:24,926 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 14:28:24,937 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 14:28:24,937 - sqlalchemy.engine.Engine - INFO - [no key 0.00047s] ()
2026-02-18 14:28:24,948 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:28:24,948 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,949 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 14:28:24,949 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,950 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:28:24,950 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,950 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 14:28:24,950 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,951 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:28:24,951 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,951 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 14:28:24,952 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,952 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:28:24,952 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,953 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 14:28:24,953 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,953 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:28:24,953 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,955 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 14:28:24,955 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:28:24,956 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 14:28:24,956 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 14:28:24,966 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 14:28:24,966 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 14:28:24,977 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:28:24,977 - sqlalchemy.engine.Engine - INFO - [no key 0.00048s] ()
2026-02-18 14:28:24,988 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 14:28:24,988 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 14:28:24,998 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:28:24,998 - sqlalchemy.engine.Engine - INFO - [no key 0.00046s] ()
2026-02-18 14:28:25,009 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:28:25,009 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2026-02-18 14:28:25,020 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:28:25,020 - sqlalchemy.engine.Engine - INFO - [no key 0.00042s] ()
2026-02-18 14:28:25,030 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:28:25,031 - aiogram.event - INFO - Update id=66295088 is handled. Duration 872 ms by bot id=8543122898
2026-02-18 14:28:26,295 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:28:26,302 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:28:26,302 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (7946439246,)
2026-02-18 14:28:26,306 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 14:28:26,306 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (7946439246, '2026-02-18 14:28:26.305224', 0)
2026-02-18 14:28:26,307 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:28:26,319 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 14:28:26,320 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 14:28:27,146 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 14:28:27,251 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/6877d34d-2e47-407a-9ffe-34c46b680601 "HTTP/1.1 200 OK"
2026-02-18 14:28:27,252 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:28:27,252 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:28:27,253 - sqlalchemy.engine.Engine - INFO - [cached since 0.9507s ago] (7946439246,)
2026-02-18 14:28:27,254 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:28:27,254 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] ('https://sub.kurvpn.tech/-5BTHjgFvu6vQMM8', '6877d34d-2e47-407a-9ffe-34c46b680601', '2026-02-21 14:28:26.320000', 1)
2026-02-18 14:28:27,256 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:28:27,271 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:28:27,271 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:28:27,272 - sqlalchemy.engine.Engine - INFO - [cached since 0.9696s ago] (7946439246,)
2026-02-18 14:28:27,273 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:28:27,273 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] (7946439246, '2026-02-18 14:28:27.272691', 'active', 1)
2026-02-18 14:28:27,274 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:28:27,285 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 14:28:27,512 - aiogram.event - INFO - Update id=66295089 is handled. Duration 1217 ms by bot id=8543122898
2026-02-18 14:28:29,460 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:28:29,461 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 14:28:29,461 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] (7946439246,)
2026-02-18 14:28:29,462 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:28:29,462 - sqlalchemy.engine.Engine - INFO - [cached since 3.16s ago] (7946439246,)
2026-02-18 14:28:29,463 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 14:28:29,464 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] (1,)
2026-02-18 14:28:29,617 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 14:28:29,618 - aiogram.event - INFO - Update id=66295090 is handled. Duration 159 ms by bot id=8543122898
2026-02-18 14:37:33,005 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:37:33,006 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:37:33,007 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,008 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:37:33,009 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,010 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:37:33,011 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,011 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:37:33,012 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,012 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:37:33,013 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,014 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 14:37:33,014 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 14:37:33,026 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 14:37:33,026 - sqlalchemy.engine.Engine - INFO - [no key 0.00048s] ()
2026-02-18 14:37:33,038 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 14:37:33,038 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 14:37:33,048 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 14:37:33,048 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 14:37:33,056 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 14:37:33,057 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 14:37:33,067 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:37:33,067 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,067 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 14:37:33,068 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,068 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:37:33,068 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,069 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 14:37:33,069 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,069 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:37:33,069 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,070 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 14:37:33,070 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,071 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:37:33,071 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,072 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 14:37:33,072 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,072 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:37:33,073 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,073 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 14:37:33,073 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:37:33,074 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 14:37:33,074 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-18 14:37:33,084 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 14:37:33,084 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 14:37:33,094 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:37:33,094 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 14:37:33,104 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 14:37:33,104 - sqlalchemy.engine.Engine - INFO - [no key 0.00039s] ()
2026-02-18 14:37:33,115 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:37:33,116 - sqlalchemy.engine.Engine - INFO - [no key 0.00054s] ()
2026-02-18 14:37:33,126 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:37:33,126 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 14:37:33,136 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:37:33,136 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-18 14:37:33,147 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:37:33,149 - aiogram.event - INFO - Update id=66295091 is handled. Duration 350 ms by bot id=8543122898
2026-02-18 14:37:35,734 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:37:35,735 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:37:35,735 - sqlalchemy.engine.Engine - INFO - [cached since 549.4s ago] (7946439246,)
2026-02-18 14:37:35,736 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 14:37:35,736 - sqlalchemy.engine.Engine - INFO - [cached since 549.4s ago] (7946439246, '2026-02-18 14:37:35.736040', 0)
2026-02-18 14:37:35,737 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:37:35,749 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 14:37:35,749 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 14:37:36,592 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 14:37:36,711 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/8767976c-9239-43f5-8212-0e24242b2679 "HTTP/1.1 200 OK"
2026-02-18 14:37:36,712 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:37:36,712 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:37:36,713 - sqlalchemy.engine.Engine - INFO - [cached since 550.4s ago] (7946439246,)
2026-02-18 14:37:36,714 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:37:36,714 - sqlalchemy.engine.Engine - INFO - [cached since 549.5s ago] ('https://sub.kurvpn.tech/TNVhNxwfq0DzMjvK', '8767976c-9239-43f5-8212-0e24242b2679', '2026-02-21 14:37:35.749000', 1)
2026-02-18 14:37:36,715 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:37:36,727 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:37:36,728 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:37:36,729 - sqlalchemy.engine.Engine - INFO - [cached since 550.4s ago] (7946439246,)
2026-02-18 14:37:36,729 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:37:36,730 - sqlalchemy.engine.Engine - INFO - [cached since 549.5s ago] (7946439246, '2026-02-18 14:37:36.729765', 'active', 1)
2026-02-18 14:37:36,731 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:37:36,742 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 14:37:37,037 - aiogram.event - INFO - Update id=66295092 is handled. Duration 1303 ms by bot id=8543122898
2026-02-18 14:41:10,982 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:41:10,983 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:41:10,984 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:10,985 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:41:10,985 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:10,986 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:41:10,986 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:10,986 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:41:10,986 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:10,987 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:41:10,987 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:10,989 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 14:41:10,991 - sqlalchemy.engine.Engine - INFO - [no key 0.00205s] ()
2026-02-18 14:41:11,004 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 14:41:11,004 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 14:41:11,014 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 14:41:11,014 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 14:41:11,024 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 14:41:11,024 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 14:41:11,034 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 14:41:11,034 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 14:41:11,044 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 14:41:11,044 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:11,045 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 14:41:11,046 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:11,046 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 14:41:11,046 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:11,047 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 14:41:11,047 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:11,047 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 14:41:11,048 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:11,048 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 14:41:11,048 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:11,049 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 14:41:11,049 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:11,049 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 14:41:11,050 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:11,051 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 14:41:11,051 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:11,052 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 14:41:11,052 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 14:41:11,053 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 14:41:11,053 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 14:41:11,064 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 14:41:11,064 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 14:41:11,074 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:41:11,074 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 14:41:11,083 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 14:41:11,083 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 14:41:11,094 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:41:11,094 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 14:41:11,105 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:41:11,105 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 14:41:11,116 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 14:41:11,116 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 14:41:11,127 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:41:11,127 - aiogram.event - INFO - Update id=66295093 is handled. Duration 263 ms by bot id=8543122898
2026-02-18 14:41:13,661 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:41:13,662 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:41:13,662 - sqlalchemy.engine.Engine - INFO - [cached since 767.4s ago] (7946439246,)
2026-02-18 14:41:13,663 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 14:41:13,664 - sqlalchemy.engine.Engine - INFO - [cached since 767.4s ago] (7946439246, '2026-02-18 14:41:13.663604', 0)
2026-02-18 14:41:13,665 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:41:13,677 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 14:41:13,677 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 14:41:14,530 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 14:41:14,641 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/afd323a1-c46d-4663-8172-4261ee88a20c "HTTP/1.1 200 OK"
2026-02-18 14:41:14,642 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:41:14,642 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:41:14,643 - sqlalchemy.engine.Engine - INFO - [cached since 768.3s ago] (7946439246,)
2026-02-18 14:41:14,644 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:41:14,644 - sqlalchemy.engine.Engine - INFO - [cached since 767.4s ago] ('https://sub.kurvpn.tech/xTDJqSXrypokhg19', 'afd323a1-c46d-4663-8172-4261ee88a20c', '2026-02-21 14:41:13.677000', 1)
2026-02-18 14:41:14,646 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:41:14,657 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 14:41:14,657 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 14:41:14,657 - sqlalchemy.engine.Engine - INFO - [cached since 768.4s ago] (7946439246,)
2026-02-18 14:41:14,658 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 14:41:14,659 - sqlalchemy.engine.Engine - INFO - [cached since 767.4s ago] (7946439246, '2026-02-18 14:41:14.658677', 'active', 1)
2026-02-18 14:41:14,660 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 14:41:14,669 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 14:41:14,925 - aiogram.event - INFO - Update id=66295094 is handled. Duration 1264 ms by bot id=8543122898
2026-02-18 14:58:58,576 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 14:58:58,577 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 14:58:58,577 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 14:58:58,841 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 15:02:24,373 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 15:02:24,374 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 15:02:24,374 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 15:02:24,374 - aiogram.dispatcher - INFO - Start polling
2026-02-18 15:02:24,473 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 15:02:25,351 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 15:02:25,352 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 15:02:25,352 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,354 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 15:02:25,354 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,355 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 15:02:25,355 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,356 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 15:02:25,356 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,357 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 15:02:25,357 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,358 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 15:02:25,358 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2026-02-18 15:02:25,370 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 15:02:25,370 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2026-02-18 15:02:25,380 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 15:02:25,380 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 15:02:25,481 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 15:02:25,482 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 15:02:25,492 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 15:02:25,493 - sqlalchemy.engine.Engine - INFO - [no key 0.00049s] ()
2026-02-18 15:02:25,503 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 15:02:25,504 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,504 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 15:02:25,504 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,505 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 15:02:25,505 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,505 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 15:02:25,506 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,506 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 15:02:25,506 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,507 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 15:02:25,507 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,507 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 15:02:25,507 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,508 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 15:02:25,508 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,509 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 15:02:25,509 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,509 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 15:02:25,509 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 15:02:25,511 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 15:02:25,511 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2026-02-18 15:02:25,521 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 15:02:25,522 - sqlalchemy.engine.Engine - INFO - [no key 0.00065s] ()
2026-02-18 15:02:25,531 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 15:02:25,531 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2026-02-18 15:02:25,689 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 15:02:25,690 - sqlalchemy.engine.Engine - INFO - [no key 0.00108s] ()
2026-02-18 15:02:25,703 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 15:02:25,704 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2026-02-18 15:02:25,714 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 15:02:25,715 - sqlalchemy.engine.Engine - INFO - [no key 0.00082s] ()
2026-02-18 15:02:25,726 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 15:02:25,727 - sqlalchemy.engine.Engine - INFO - [no key 0.00053s] ()
2026-02-18 15:02:25,737 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 15:02:25,758 - aiogram.event - INFO - Update id=66295098 is handled. Duration 1178 ms by bot id=8543122898
2026-02-18 15:02:27,687 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 15:02:27,693 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 15:02:27,694 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (7946439246,)
2026-02-18 15:02:27,696 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 15:02:27,696 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] (7946439246, '2026-02-18 15:02:27.695313', 0)
2026-02-18 15:02:27,698 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 15:02:27,731 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 15:02:27,731 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 15:02:28,630 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 15:02:28,744 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/1792da2a-aaea-4946-b4f8-4ca8cc18c9a3 "HTTP/1.1 200 OK"
2026-02-18 15:02:28,745 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 15:02:28,745 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 15:02:28,745 - sqlalchemy.engine.Engine - INFO - [cached since 1.052s ago] (7946439246,)
2026-02-18 15:02:28,747 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 15:02:28,747 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ('https://sub.kurvpn.tech/QbdusBf2tKsJvqt5', '1792da2a-aaea-4946-b4f8-4ca8cc18c9a3', '2026-02-21 12:02:27.731000', 1)
2026-02-18 15:02:28,748 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 15:02:28,805 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 15:02:28,806 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 15:02:28,806 - sqlalchemy.engine.Engine - INFO - [cached since 1.113s ago] (7946439246,)
2026-02-18 15:02:28,807 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 15:02:28,807 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] (7946439246, '2026-02-18 15:02:28.807073', 'active', 1)
2026-02-18 15:02:28,808 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 15:02:28,880 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 15:02:29,164 - aiogram.event - INFO - Update id=66295099 is handled. Duration 1477 ms by bot id=8543122898
2026-02-18 15:02:39,474 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 15:02:39,475 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 15:02:39,476 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (7946439246,)
2026-02-18 15:02:39,478 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 15:02:39,478 - sqlalchemy.engine.Engine - INFO - [cached since 11.78s ago] (7946439246,)
2026-02-18 15:02:39,480 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 15:02:39,480 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] (1,)
2026-02-18 15:02:39,638 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 15:02:39,639 - aiogram.event - INFO - Update id=66295100 is handled. Duration 165 ms by bot id=8543122898
2026-02-18 15:03:00,662 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 15:03:00,662 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 15:03:00,663 - sqlalchemy.engine.Engine - INFO - [cached since 21.19s ago] (7946439246,)
2026-02-18 15:03:00,664 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 15:03:00,664 - sqlalchemy.engine.Engine - INFO - [cached since 32.97s ago] (7946439246,)
2026-02-18 15:03:00,666 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 15:03:00,666 - sqlalchemy.engine.Engine - INFO - [cached since 21.19s ago] (1,)
2026-02-18 15:03:00,907 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 15:03:00,908 - aiogram.event - INFO - Update id=66295101 is handled. Duration 246 ms by bot id=8543122898
2026-02-18 15:03:15,835 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 15:03:15,837 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 15:03:15,837 - sqlalchemy.engine.Engine - INFO - [cached since 36.36s ago] (7946439246,)
2026-02-18 15:03:15,838 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 15:03:15,838 - sqlalchemy.engine.Engine - INFO - [cached since 48.15s ago] (7946439246,)
2026-02-18 15:03:15,840 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 15:03:15,840 - sqlalchemy.engine.Engine - INFO - [cached since 36.36s ago] (1,)
2026-02-18 15:03:15,973 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 15:03:15,973 - aiogram.event - INFO - Update id=66295102 is handled. Duration 138 ms by bot id=8543122898
2026-02-18 15:07:57,361 - aiogram.event - INFO - Update id=66295103 is not handled. Duration 0 ms by bot id=8543122898
2026-02-18 15:10:20,752 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 15:10:20,752 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 15:10:20,753 - sqlalchemy.engine.Engine - INFO - [cached since 473.1s ago] (7946439246,)
2026-02-18 15:10:20,754 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 15:10:20,754 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 15:10:20,932 - aiogram.event - INFO - Update id=66295104 is handled. Duration 181 ms by bot id=8543122898
2026-02-18 15:10:27,767 - aiogram.event - INFO - Update id=66295105 is not handled. Duration 0 ms by bot id=8543122898
2026-02-18 16:02:07,876 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 16:02:07,878 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 16:02:07,878 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 16:02:08,129 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:02:13,740 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 16:02:13,740 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 16:02:13,741 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 16:02:13,741 - aiogram.dispatcher - INFO - Start polling
2026-02-18 16:02:13,840 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:02:17,053 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:02:17,054 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:02:17,054 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,055 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:02:17,056 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,057 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:02:17,057 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,058 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:02:17,059 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,059 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:02:17,060 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,061 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 16:02:17,062 - sqlalchemy.engine.Engine - INFO - [no key 0.00055s] ()
2026-02-18 16:02:17,073 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 16:02:17,073 - sqlalchemy.engine.Engine - INFO - [no key 0.00059s] ()
2026-02-18 16:02:17,085 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 16:02:17,085 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2026-02-18 16:02:17,096 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 16:02:17,096 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 16:02:17,106 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 16:02:17,106 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 16:02:17,117 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:02:17,117 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,118 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 16:02:17,118 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,118 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:02:17,119 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,119 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 16:02:17,119 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,120 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:02:17,120 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,121 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 16:02:17,121 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,122 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:02:17,122 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,123 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 16:02:17,123 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,124 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:02:17,124 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,125 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 16:02:17,125 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:17,126 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 16:02:17,126 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:02:17,137 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 16:02:17,137 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:02:17,148 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:02:17,148 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-18 16:02:17,170 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 16:02:17,171 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 16:02:17,181 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:02:17,181 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-18 16:02:17,192 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:02:17,192 - sqlalchemy.engine.Engine - INFO - [no key 0.00039s] ()
2026-02-18 16:02:17,203 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:02:17,203 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2026-02-18 16:02:17,214 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:02:17,214 - aiogram.event - INFO - Update id=66295106 is handled. Duration 1008 ms by bot id=8543122898
2026-02-18 16:02:18,731 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:02:18,739 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:02:18,739 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] (7946439246,)
2026-02-18 16:02:18,741 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 16:02:18,741 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] (7946439246, '2026-02-18 16:02:18.740301', 0)
2026-02-18 16:02:18,743 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:02:18,751 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 16:02:18,751 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 16:02:20,444 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 400 Bad Request"
2026-02-18 16:02:20,445 - aiogram.event - INFO - Update id=66295107 is not handled. Duration 1715 ms by bot id=8543122898
2026-02-18 16:02:20,445 - aiogram.event - ERROR - Cause exception while process update id=66295107 by bot id=8543122898
ConflictError: API Error A019: User username already exists (HTTP 400)
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 68, in _handle_response
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_models.py", line 763, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://admin.kurvpn.tech/api/users'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\start_cmd.py", line 39, in start_cmd
    await client.create_client(tg_user)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 43, in create_client
    rem_user = await self.rem.users.create_user(create_body)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\decorators.py", line 43, in wrapper
    return api._handle_response(response, response_class=response_class)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 70, in _handle_response
    handle_api_error(e.response)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\exceptions\handler.py", line 217, in handle_api_error
    raise exception_class(response.status_code, error_response)
remnawave.exceptions.general.ConflictError: API Error A019: User username already exists (HTTP 400)
2026-02-18 16:02:35,369 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:02:35,369 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:02:35,369 - sqlalchemy.engine.Engine - INFO - [cached since 16.63s ago] (7946439246,)
2026-02-18 16:02:35,370 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 16:02:35,370 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:02:35,606 - aiogram.event - INFO - Update id=66295108 is handled. Duration 237 ms by bot id=8543122898
2026-02-18 16:02:45,356 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:02:45,357 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:02:45,357 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] (7946439246,)
2026-02-18 16:02:45,358 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:02:45,359 - sqlalchemy.engine.Engine - INFO - [cached since 26.62s ago] (7946439246,)
2026-02-18 16:02:45,361 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:02:45,361 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (1,)
2026-02-18 16:02:45,491 - common.handlers_flder.my_vpn - INFO - Пользователь 7946439246 попытался просмотреть профиль без активной подписки.
2026-02-18 16:02:45,491 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:02:45,492 - aiogram.event - INFO - Update id=66295109 is handled. Duration 136 ms by bot id=8543122898
2026-02-18 16:02:47,525 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:02:47,525 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:02:47,526 - sqlalchemy.engine.Engine - INFO - [cached since 28.79s ago] (7946439246,)
2026-02-18 16:02:47,527 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 16:02:47,527 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:02:47,709 - aiogram.event - INFO - Update id=66295110 is handled. Duration 184 ms by bot id=8543122898
2026-02-18 16:02:52,939 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:02:52,940 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:02:52,940 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:52,941 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:02:52,941 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:52,941 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:02:52,942 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:52,942 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:02:52,942 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:52,944 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:02:52,944 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:52,945 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 16:02:52,945 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2026-02-18 16:02:52,957 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 16:02:52,957 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 16:02:52,967 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 16:02:52,967 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 16:02:52,977 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 16:02:52,977 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 16:02:52,988 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 16:02:52,988 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 16:02:52,999 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:02:52,999 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:53,000 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 16:02:53,000 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:53,000 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:02:53,001 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:53,001 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 16:02:53,001 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:53,002 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:02:53,002 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:53,002 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 16:02:53,002 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:53,003 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:02:53,003 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:53,003 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 16:02:53,003 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:53,004 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:02:53,005 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:53,005 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 16:02:53,005 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:02:53,006 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 16:02:53,006 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 16:02:53,017 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 16:02:53,018 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 16:02:53,028 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:02:53,029 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:02:53,055 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 16:02:53,074 - sqlalchemy.engine.Engine - INFO - [no key 0.01851s] ()
2026-02-18 16:02:53,084 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:02:53,085 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2026-02-18 16:02:53,097 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:02:53,099 - sqlalchemy.engine.Engine - INFO - [no key 0.00118s] ()
2026-02-18 16:02:53,109 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:02:53,110 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-18 16:02:53,120 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:02:53,121 - aiogram.event - INFO - Update id=66295111 is handled. Duration 315 ms by bot id=8543122898
2026-02-18 16:02:55,204 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:02:55,204 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:02:55,205 - sqlalchemy.engine.Engine - INFO - [cached since 36.47s ago] (7946439246,)
2026-02-18 16:02:55,206 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 16:02:55,206 - sqlalchemy.engine.Engine - INFO - [cached since 36.47s ago] (7946439246, '2026-02-18 16:02:55.205880', 0)
2026-02-18 16:02:55,207 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:02:55,218 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 16:02:55,218 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 16:02:55,962 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 16:02:56,070 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/09e90980-8f56-4ec2-b6bb-ecd900d61a2c "HTTP/1.1 200 OK"
2026-02-18 16:02:56,071 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:02:56,071 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:02:56,071 - sqlalchemy.engine.Engine - INFO - [cached since 37.33s ago] (7946439246,)
2026-02-18 16:02:56,073 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 16:02:56,073 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] ('https://sub.kurvpn.tech/nerTnLkRp0qyC8r9', '09e90980-8f56-4ec2-b6bb-ecd900d61a2c', '2026-02-21 13:02:55.218000', 1)
2026-02-18 16:02:56,075 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:02:56,085 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:02:56,086 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:02:56,086 - sqlalchemy.engine.Engine - INFO - [cached since 37.35s ago] (7946439246,)
2026-02-18 16:02:56,087 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 16:02:56,088 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] (7946439246, '2026-02-18 16:02:56.087010', 'active', 1)
2026-02-18 16:02:56,090 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:02:56,099 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 16:02:56,289 - aiogram.event - INFO - Update id=66295112 is handled. Duration 1085 ms by bot id=8543122898
2026-02-18 16:03:00,020 - aiogram.event - INFO - Update id=66295113 is handled. Duration 243 ms by bot id=8543122898
2026-02-18 16:03:01,602 - aiogram.event - INFO - Update id=66295114 is handled. Duration 235 ms by bot id=8543122898
2026-02-18 16:03:04,281 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:03:04,282 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:03:04,282 - sqlalchemy.engine.Engine - INFO - [cached since 18.92s ago] (7946439246,)
2026-02-18 16:03:04,283 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:03:04,283 - sqlalchemy.engine.Engine - INFO - [cached since 45.54s ago] (7946439246,)
2026-02-18 16:03:04,284 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:03:04,284 - sqlalchemy.engine.Engine - INFO - [cached since 18.92s ago] (1,)
2026-02-18 16:03:05,528 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/users/09e90980-8f56-4ec2-b6bb-ecd900d61a2c "HTTP/1.1 200 OK"
2026-02-18 16:03:05,528 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:03:05,529 - aiogram.event - INFO - Update id=66295115 is not handled. Duration 1364 ms by bot id=8543122898
2026-02-18 16:03:05,529 - aiogram.event - ERROR - Cause exception while process update id=66295115 by bot id=8543122898
TypeError: '<' not supported between instances of 'GetUserByUuidResponseDto' and 'datetime.datetime'
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\puy_vpn.py", line 42, in puy_vpn
    await vpn.buy_vpn(callback.from_user.id, days)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 95, in buy_vpn
    if vpn_exp < now:
       ^^^^^^^^^^^^^
TypeError: '<' not supported between instances of 'GetUserByUuidResponseDto' and 'datetime.datetime'
2026-02-18 16:03:06,530 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:03:06,531 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:03:06,532 - sqlalchemy.engine.Engine - INFO - [cached since 21.17s ago] (7946439246,)
2026-02-18 16:03:06,533 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:03:06,534 - sqlalchemy.engine.Engine - INFO - [cached since 47.8s ago] (7946439246,)
2026-02-18 16:03:06,535 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:03:06,535 - sqlalchemy.engine.Engine - INFO - [cached since 21.17s ago] (1,)
2026-02-18 16:03:06,745 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:03:06,746 - aiogram.event - INFO - Update id=66295116 is handled. Duration 217 ms by bot id=8543122898
2026-02-18 16:03:49,729 - aiogram.event - INFO - Update id=66295117 is handled. Duration 237 ms by bot id=8543122898
2026-02-18 16:03:51,053 - aiogram.event - INFO - Update id=66295118 is handled. Duration 382 ms by bot id=8543122898
2026-02-18 16:03:52,488 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:03:52,488 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:03:52,489 - sqlalchemy.engine.Engine - INFO - [cached since 67.13s ago] (7946439246,)
2026-02-18 16:03:52,489 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:03:52,490 - sqlalchemy.engine.Engine - INFO - [cached since 93.75s ago] (7946439246,)
2026-02-18 16:03:52,491 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:03:52,492 - sqlalchemy.engine.Engine - INFO - [cached since 67.13s ago] (1,)
2026-02-18 16:03:53,289 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/users/09e90980-8f56-4ec2-b6bb-ecd900d61a2c "HTTP/1.1 200 OK"
2026-02-18 16:03:53,289 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:03:53,290 - aiogram.event - INFO - Update id=66295119 is not handled. Duration 921 ms by bot id=8543122898
2026-02-18 16:03:53,290 - aiogram.event - ERROR - Cause exception while process update id=66295119 by bot id=8543122898
TypeError: '<' not supported between instances of 'GetUserByUuidResponseDto' and 'datetime.datetime'
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\puy_vpn.py", line 42, in puy_vpn
    await vpn.buy_vpn(callback.from_user.id, days)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 95, in buy_vpn
    if vpn_exp < now:
       ^^^^^^^^^^^^^
TypeError: '<' not supported between instances of 'GetUserByUuidResponseDto' and 'datetime.datetime'
2026-02-18 16:04:52,972 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 16:04:52,973 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 16:04:52,973 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 16:04:53,227 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:04:58,429 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 16:04:58,430 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 16:04:58,430 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 16:04:58,430 - aiogram.dispatcher - INFO - Start polling
2026-02-18 16:04:58,525 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:05:19,797 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:05:19,803 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:05:19,804 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (7946439246,)
2026-02-18 16:05:19,805 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 16:05:19,805 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:05:20,713 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:05:20,714 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:05:20,714 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,715 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:05:20,716 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,716 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:05:20,716 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,717 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:05:20,717 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,718 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:05:20,718 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,719 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 16:05:20,720 - sqlalchemy.engine.Engine - INFO - [no key 0.00083s] ()
2026-02-18 16:05:20,735 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 16:05:20,736 - sqlalchemy.engine.Engine - INFO - [no key 0.00036s] ()
2026-02-18 16:05:20,747 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 16:05:20,748 - sqlalchemy.engine.Engine - INFO - [no key 0.00054s] ()
2026-02-18 16:05:20,759 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 16:05:20,760 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 16:05:20,771 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 16:05:20,772 - sqlalchemy.engine.Engine - INFO - [no key 0.00098s] ()
2026-02-18 16:05:20,783 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:05:20,784 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,784 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 16:05:20,785 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,785 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:05:20,785 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,786 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 16:05:20,786 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,786 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:05:20,786 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,787 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 16:05:20,787 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,788 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:05:20,788 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,788 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 16:05:20,789 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,789 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:05:20,789 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,790 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 16:05:20,790 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:05:20,790 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 16:05:20,791 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 16:05:20,802 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 16:05:20,803 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 16:05:20,813 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:05:20,814 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:05:20,824 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 16:05:20,825 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 16:05:20,836 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:05:20,836 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:05:20,860 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:05:20,861 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 16:05:20,871 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:05:20,871 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2026-02-18 16:05:20,881 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:05:20,882 - aiogram.event - INFO - Update id=66295120 is handled. Duration 10782 ms by bot id=8543122898
2026-02-18 16:05:28,375 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:05:28,376 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:05:28,376 - sqlalchemy.engine.Engine - INFO - [cached since 8.573s ago] (7946439246,)
2026-02-18 16:05:28,378 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 16:05:28,378 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] (7946439246, '2026-02-18 16:05:28.377203', 0)
2026-02-18 16:05:28,379 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:05:28,390 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 16:05:28,390 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 16:05:33,402 - aiogram.event - INFO - Update id=66295123 is not handled. Duration 5027 ms by bot id=8543122898
2026-02-18 16:05:33,402 - aiogram.event - ERROR - Cause exception while process update id=66295123 by bot id=8543122898
ConnectTimeout: 
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_transports\default.py", line 72, in map_httpcore_exceptions
    yield
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_transports\default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_async\connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_async\connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        pool_request.request
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_async\connection.py", line 101, in handle_async_request
    raise exc
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_async\connection.py", line 78, in handle_async_request
    stream = await self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_async\connection.py", line 156, in _connect
    stream = await stream.start_tls(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_backends\anyio.py", line 67, in start_tls
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Program Files\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\start_cmd.py", line 39, in start_cmd
    await client.create_client(tg_user)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 43, in create_client
    rem_user = await self.rem.users.create_user(create_body)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\decorators.py", line 41, in wrapper
    response = await api.client.send(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_transports\default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_transports\default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectTimeout
2026-02-18 16:05:55,355 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 16:05:55,356 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 16:05:55,356 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 16:05:55,619 - aiogram.event - INFO - Update id=66295122 is not handled. Duration 35824 ms by bot id=8543122898
2026-02-18 16:05:55,619 - aiogram.event - INFO - Update id=66295121 is not handled. Duration 41816 ms by bot id=8543122898
2026-02-18 16:05:55,619 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:06:07,273 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 16:06:07,274 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 16:06:07,274 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 16:06:07,274 - aiogram.dispatcher - INFO - Start polling
2026-02-18 16:06:07,374 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:06:18,259 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:06:18,259 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:06:18,259 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,260 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:06:18,260 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,261 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:06:18,261 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,261 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:06:18,261 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,262 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:06:18,263 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,264 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 16:06:18,264 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 16:06:18,271 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 16:06:18,271 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 16:06:18,282 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 16:06:18,283 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 16:06:18,293 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 16:06:18,294 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 16:06:18,304 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 16:06:18,305 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 16:06:18,315 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:06:18,315 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,316 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 16:06:18,316 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,317 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:06:18,317 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,318 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 16:06:18,318 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,319 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:06:18,319 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,320 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 16:06:18,320 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,321 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:06:18,321 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,321 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 16:06:18,321 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,322 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:06:18,322 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,322 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 16:06:18,323 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,323 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 16:06:18,324 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2026-02-18 16:06:18,334 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 16:06:18,335 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2026-02-18 16:06:18,345 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:06:18,349 - sqlalchemy.engine.Engine - INFO - [no key 0.00374s] ()
2026-02-18 16:06:18,360 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 16:06:18,360 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-18 16:06:18,372 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:06:18,372 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-18 16:06:18,397 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:06:18,397 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 16:06:18,408 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:06:18,409 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:06:18,419 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:06:18,420 - aiogram.event - INFO - Update id=66295126 is handled. Duration 5015 ms by bot id=8543122898
2026-02-18 16:06:18,468 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:06:18,469 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:06:18,469 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,470 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:06:18,470 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,471 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:06:18,471 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,472 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:06:18,472 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,473 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:06:18,473 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,474 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 16:06:18,474 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 16:06:18,485 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 16:06:18,486 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 16:06:18,496 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 16:06:18,496 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 16:06:18,505 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 16:06:18,505 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 16:06:18,516 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 16:06:18,516 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 16:06:18,527 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:06:18,527 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,528 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 16:06:18,528 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,529 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:06:18,529 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,530 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 16:06:18,530 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,531 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:06:18,531 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,531 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 16:06:18,532 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,532 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:06:18,532 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,533 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 16:06:18,533 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,534 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:06:18,534 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,535 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 16:06:18,535 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:06:18,536 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 16:06:18,536 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 16:06:18,546 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 16:06:18,547 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 16:06:18,556 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:06:18,557 - sqlalchemy.engine.Engine - INFO - [no key 0.00047s] ()
2026-02-18 16:06:18,566 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 16:06:18,566 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 16:06:18,577 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:06:18,577 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 16:06:18,586 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:06:18,587 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 16:06:18,599 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:06:18,603 - sqlalchemy.engine.Engine - INFO - [no key 0.00376s] ()
2026-02-18 16:06:18,615 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:06:18,616 - aiogram.event - INFO - Update id=66295125 is handled. Duration 11130 ms by bot id=8543122898
2026-02-18 16:06:20,632 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:06:20,639 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:06:20,639 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] (7946439246,)
2026-02-18 16:06:20,642 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 16:06:20,643 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] (7946439246, '2026-02-18 16:06:20.641450', 0)
2026-02-18 16:06:20,645 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:06:20,658 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 16:06:20,658 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 16:06:21,519 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 16:06:21,637 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/2c8722fb-e7f3-4820-b714-a62b5bfeb298 "HTTP/1.1 200 OK"
2026-02-18 16:06:21,638 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:06:21,639 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:06:21,639 - sqlalchemy.engine.Engine - INFO - [cached since 1s ago] (7946439246,)
2026-02-18 16:06:21,642 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 16:06:21,643 - sqlalchemy.engine.Engine - INFO - [generated in 0.00162s] ('https://sub.kurvpn.tech/zdSmRbqCHuhc8HY-', '2c8722fb-e7f3-4820-b714-a62b5bfeb298', '2026-02-21 13:06:20.658000', 1)
2026-02-18 16:06:21,650 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:06:21,660 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:06:21,660 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:06:21,660 - sqlalchemy.engine.Engine - INFO - [cached since 1.022s ago] (7946439246,)
2026-02-18 16:06:21,662 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 16:06:21,662 - sqlalchemy.engine.Engine - INFO - [generated in 0.00054s] (7946439246, '2026-02-18 16:06:21.661558', 'active', 1)
2026-02-18 16:06:21,664 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:06:21,674 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 16:06:22,510 - aiogram.event - INFO - Update id=66295127 is handled. Duration 1879 ms by bot id=8543122898
2026-02-18 16:06:24,351 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:06:24,352 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:06:24,352 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (7946439246,)
2026-02-18 16:06:24,353 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:06:24,353 - sqlalchemy.engine.Engine - INFO - [cached since 3.714s ago] (7946439246,)
2026-02-18 16:06:24,355 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:06:24,355 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] (1,)
2026-02-18 16:06:24,491 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:06:24,492 - aiogram.event - INFO - Update id=66295128 is handled. Duration 142 ms by bot id=8543122898
2026-02-18 16:06:26,902 - aiogram.event - INFO - Update id=66295129 is handled. Duration 228 ms by bot id=8543122898
2026-02-18 16:06:28,599 - aiogram.event - INFO - Update id=66295130 is handled. Duration 631 ms by bot id=8543122898
2026-02-18 16:06:29,640 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:06:29,640 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:06:29,640 - sqlalchemy.engine.Engine - INFO - [cached since 5.289s ago] (7946439246,)
2026-02-18 16:06:29,641 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:06:29,641 - sqlalchemy.engine.Engine - INFO - [cached since 9.003s ago] (7946439246,)
2026-02-18 16:06:29,642 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:06:29,642 - sqlalchemy.engine.Engine - INFO - [cached since 5.288s ago] (1,)
2026-02-18 16:06:30,703 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/users/2c8722fb-e7f3-4820-b714-a62b5bfeb298 "HTTP/1.1 200 OK"
2026-02-18 16:06:30,704 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:06:30,705 - aiogram.event - INFO - Update id=66295131 is not handled. Duration 1306 ms by bot id=8543122898
2026-02-18 16:06:30,705 - aiogram.event - ERROR - Cause exception while process update id=66295131 by bot id=8543122898
TypeError: can't compare offset-naive and offset-aware datetimes
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\puy_vpn.py", line 42, in puy_vpn
    await vpn.buy_vpn(callback.from_user.id, days)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 95, in buy_vpn
    if expired < now:
       ^^^^^^^^^^^^^
TypeError: can't compare offset-naive and offset-aware datetimes
2026-02-18 16:06:35,431 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:06:35,433 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:06:35,435 - sqlalchemy.engine.Engine - INFO - [cached since 11.08s ago] (7946439246,)
2026-02-18 16:06:35,437 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:06:35,437 - sqlalchemy.engine.Engine - INFO - [cached since 14.8s ago] (7946439246,)
2026-02-18 16:06:35,438 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:06:35,438 - sqlalchemy.engine.Engine - INFO - [cached since 11.08s ago] (1,)
2026-02-18 16:06:35,576 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:06:35,577 - aiogram.event - INFO - Update id=66295132 is handled. Duration 151 ms by bot id=8543122898
2026-02-18 16:08:48,013 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 16:08:48,014 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 16:08:48,014 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 16:08:48,280 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:09:14,416 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 16:09:14,417 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 16:09:14,417 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 16:09:14,418 - aiogram.dispatcher - INFO - Start polling
2026-02-18 16:09:14,518 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:09:17,750 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:09:17,750 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:09:17,750 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,751 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:09:17,752 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,752 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:09:17,752 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,753 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:09:17,753 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,754 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:09:17,754 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,754 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 16:09:17,755 - sqlalchemy.engine.Engine - INFO - [no key 0.00037s] ()
2026-02-18 16:09:17,768 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 16:09:17,768 - sqlalchemy.engine.Engine - INFO - [no key 0.00036s] ()
2026-02-18 16:09:17,779 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 16:09:17,779 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-18 16:09:17,791 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 16:09:17,791 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 16:09:17,801 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 16:09:17,801 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:09:17,812 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:09:17,812 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,813 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 16:09:17,813 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,813 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:09:17,813 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,814 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 16:09:17,814 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,814 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:09:17,814 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,815 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 16:09:17,815 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,815 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:09:17,815 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,816 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 16:09:17,816 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,817 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:09:17,817 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,817 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 16:09:17,818 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:17,819 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 16:09:17,819 - sqlalchemy.engine.Engine - INFO - [no key 0.00035s] ()
2026-02-18 16:09:17,830 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 16:09:17,830 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 16:09:17,842 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:09:17,842 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-18 16:09:17,853 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 16:09:17,853 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 16:09:17,863 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:09:17,863 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:09:17,888 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:09:17,888 - sqlalchemy.engine.Engine - INFO - [no key 0.00056s] ()
2026-02-18 16:09:17,899 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:09:17,900 - sqlalchemy.engine.Engine - INFO - [no key 0.00055s] ()
2026-02-18 16:09:17,911 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:09:17,912 - aiogram.event - INFO - Update id=66295135 is handled. Duration 772 ms by bot id=8543122898
2026-02-18 16:09:19,397 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:09:19,404 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:09:19,404 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (7946439246,)
2026-02-18 16:09:19,406 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 16:09:19,407 - sqlalchemy.engine.Engine - INFO - [generated in 0.00037s] (7946439246, '2026-02-18 16:09:19.405835', 0)
2026-02-18 16:09:19,409 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:09:19,418 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 16:09:19,418 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 16:09:24,426 - aiogram.event - INFO - Update id=66295136 is not handled. Duration 5029 ms by bot id=8543122898
2026-02-18 16:09:24,426 - aiogram.event - ERROR - Cause exception while process update id=66295136 by bot id=8543122898
ConnectTimeout: 
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_transports\default.py", line 72, in map_httpcore_exceptions
    yield
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_transports\default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_async\connection_pool.py", line 256, in handle_async_request
    raise exc from None
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_async\connection_pool.py", line 236, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        pool_request.request
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_async\connection.py", line 101, in handle_async_request
    raise exc
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_async\connection.py", line 78, in handle_async_request
    stream = await self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_async\connection.py", line 124, in _connect
    stream = await self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_backends\auto.py", line 31, in connect_tcp
    return await self._backend.connect_tcp(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_backends\anyio.py", line 113, in connect_tcp
    with map_exceptions(exc_map):
         ~~~~~~~~~~~~~~^^^^^^^^^
  File "C:\Program Files\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpcore\_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectTimeout

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\start_cmd.py", line 39, in start_cmd
    await client.create_client(tg_user)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 43, in create_client
    rem_user = await self.rem.users.create_user(create_body)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\decorators.py", line 41, in wrapper
    response = await api.client.send(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_transports\default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
         ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Program Files\Python313\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_transports\default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectTimeout
2026-02-18 16:09:27,332 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 16:09:27,333 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 16:09:27,333 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 16:09:27,599 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:09:41,339 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 16:09:41,340 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 16:09:41,340 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 16:09:41,341 - aiogram.dispatcher - INFO - Start polling
2026-02-18 16:09:41,449 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:09:44,404 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:09:44,405 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:09:44,405 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,406 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:09:44,407 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,408 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:09:44,408 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,409 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:09:44,414 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,419 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:09:44,430 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,435 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 16:09:44,435 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2026-02-18 16:09:44,444 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 16:09:44,445 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 16:09:44,455 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 16:09:44,455 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 16:09:44,464 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 16:09:44,465 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2026-02-18 16:09:44,475 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 16:09:44,476 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-18 16:09:44,486 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:09:44,487 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,488 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 16:09:44,488 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,488 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:09:44,488 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,489 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 16:09:44,489 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,490 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:09:44,490 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,491 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 16:09:44,491 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,491 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:09:44,491 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,492 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 16:09:44,492 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,492 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:09:44,492 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,493 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 16:09:44,493 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:09:44,494 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 16:09:44,494 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:09:44,505 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 16:09:44,505 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-18 16:09:44,514 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:09:44,516 - sqlalchemy.engine.Engine - INFO - [no key 0.00101s] ()
2026-02-18 16:09:44,526 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 16:09:44,526 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2026-02-18 16:09:44,536 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:09:44,537 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:09:44,548 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:09:44,548 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 16:09:44,558 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:09:44,559 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 16:09:44,568 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:09:44,569 - aiogram.event - INFO - Update id=66295137 is handled. Duration 911 ms by bot id=8543122898
2026-02-18 16:09:45,714 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:09:45,725 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:09:45,725 - sqlalchemy.engine.Engine - INFO - [generated in 0.00033s] (7946439246,)
2026-02-18 16:09:45,728 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 16:09:45,728 - sqlalchemy.engine.Engine - INFO - [generated in 0.00035s] (7946439246, '2026-02-18 16:09:45.726794', 0)
2026-02-18 16:09:45,730 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:09:45,739 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 16:09:45,740 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 16:09:46,635 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 16:09:46,755 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/7676a53b-932f-4771-9b94-16929acfb804 "HTTP/1.1 200 OK"
2026-02-18 16:09:46,755 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:09:46,756 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:09:46,756 - sqlalchemy.engine.Engine - INFO - [cached since 1.031s ago] (7946439246,)
2026-02-18 16:09:46,757 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 16:09:46,758 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ('https://sub.kurvpn.tech/vrXCZcztMXRrf4VB', '7676a53b-932f-4771-9b94-16929acfb804', '2026-02-21 16:09:45.740000', 1)
2026-02-18 16:09:46,759 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:09:46,768 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:09:46,769 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:09:46,769 - sqlalchemy.engine.Engine - INFO - [cached since 1.044s ago] (7946439246,)
2026-02-18 16:09:46,770 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 16:09:46,770 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] (7946439246, '2026-02-18 16:09:46.770031', 'active', 1)
2026-02-18 16:09:46,772 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:09:46,781 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 16:09:47,025 - aiogram.event - INFO - Update id=66295138 is handled. Duration 1311 ms by bot id=8543122898
2026-02-18 16:09:49,677 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:09:49,678 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:09:49,678 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (7946439246,)
2026-02-18 16:09:49,679 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:09:49,679 - sqlalchemy.engine.Engine - INFO - [cached since 3.955s ago] (7946439246,)
2026-02-18 16:09:49,681 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:09:49,682 - sqlalchemy.engine.Engine - INFO - [generated in 0.00076s] (1,)
2026-02-18 16:09:49,842 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:09:49,843 - aiogram.event - INFO - Update id=66295139 is handled. Duration 167 ms by bot id=8543122898
2026-02-18 16:09:52,282 - aiogram.event - INFO - Update id=66295140 is handled. Duration 247 ms by bot id=8543122898
2026-02-18 16:09:53,725 - aiogram.event - INFO - Update id=66295141 is handled. Duration 322 ms by bot id=8543122898
2026-02-18 16:09:54,725 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:09:54,726 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:09:54,726 - sqlalchemy.engine.Engine - INFO - [cached since 5.049s ago] (7946439246,)
2026-02-18 16:09:54,727 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:09:54,728 - sqlalchemy.engine.Engine - INFO - [cached since 9.003s ago] (7946439246,)
2026-02-18 16:09:54,729 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:09:54,729 - sqlalchemy.engine.Engine - INFO - [cached since 5.048s ago] (1,)
2026-02-18 16:09:55,530 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/users/7676a53b-932f-4771-9b94-16929acfb804 "HTTP/1.1 200 OK"
2026-02-18 16:09:55,531 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:09:55,532 - aiogram.event - INFO - Update id=66295142 is not handled. Duration 1062 ms by bot id=8543122898
2026-02-18 16:09:55,532 - aiogram.event - ERROR - Cause exception while process update id=66295142 by bot id=8543122898
TypeError: can't compare offset-naive and offset-aware datetimes
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\puy_vpn.py", line 42, in puy_vpn
    await vpn.buy_vpn(callback.from_user.id, days)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 95, in buy_vpn
    if expired < now:
       ^^^^^^^^^^^^^
TypeError: can't compare offset-naive and offset-aware datetimes
2026-02-18 16:11:31,652 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 16:11:31,653 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 16:11:31,653 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 16:11:31,904 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:11:37,928 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 16:11:37,929 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 16:11:37,929 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 16:11:37,929 - aiogram.dispatcher - INFO - Start polling
2026-02-18 16:11:38,026 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:11:48,806 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:11:48,807 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:11:48,807 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,807 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:11:48,808 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,808 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:11:48,808 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,809 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:11:48,809 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,809 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:11:48,809 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,811 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 16:11:48,811 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2026-02-18 16:11:48,823 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 16:11:48,823 - sqlalchemy.engine.Engine - INFO - [no key 0.00060s] ()
2026-02-18 16:11:48,834 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 16:11:48,835 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:11:48,845 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 16:11:48,845 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 16:11:48,856 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 16:11:48,856 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:11:48,867 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:11:48,867 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,867 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 16:11:48,868 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,868 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:11:48,868 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,869 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 16:11:48,869 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,869 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:11:48,869 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,870 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 16:11:48,870 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,870 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:11:48,870 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,871 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 16:11:48,871 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,872 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:11:48,872 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,873 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 16:11:48,873 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:11:48,873 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 16:11:48,874 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 16:11:48,883 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 16:11:48,884 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 16:11:48,894 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:11:48,894 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2026-02-18 16:11:48,904 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 16:11:48,905 - sqlalchemy.engine.Engine - INFO - [no key 0.00059s] ()
2026-02-18 16:11:48,915 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:11:48,916 - sqlalchemy.engine.Engine - INFO - [no key 0.00056s] ()
2026-02-18 16:11:48,925 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:11:48,925 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2026-02-18 16:11:48,944 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:11:48,944 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2026-02-18 16:11:48,956 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:11:48,956 - aiogram.event - INFO - Update id=66295143 is handled. Duration 826 ms by bot id=8543122898
2026-02-18 16:11:49,867 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:11:49,875 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:11:49,875 - sqlalchemy.engine.Engine - INFO - [generated in 0.00034s] (7946439246,)
2026-02-18 16:11:49,878 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 16:11:49,878 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (7946439246, '2026-02-18 16:11:49.876864', 0)
2026-02-18 16:11:49,879 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:11:49,889 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 16:11:49,889 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 16:11:50,673 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 16:11:50,779 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/dcb84a1e-3ca1-44a7-923c-cb68b880e255 "HTTP/1.1 200 OK"
2026-02-18 16:11:50,780 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:11:50,780 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:11:50,781 - sqlalchemy.engine.Engine - INFO - [cached since 0.9057s ago] (7946439246,)
2026-02-18 16:11:50,782 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 16:11:50,782 - sqlalchemy.engine.Engine - INFO - [generated in 0.00038s] ('https://sub.kurvpn.tech/SyuymbjMhHxZYp_g', 'dcb84a1e-3ca1-44a7-923c-cb68b880e255', '2026-02-21 16:11:49.890000', 1)
2026-02-18 16:11:50,784 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:11:50,792 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:11:50,793 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:11:50,794 - sqlalchemy.engine.Engine - INFO - [cached since 0.9187s ago] (7946439246,)
2026-02-18 16:11:50,795 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 16:11:50,796 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] (7946439246, '2026-02-18 16:11:50.794984', 'active', 1)
2026-02-18 16:11:50,797 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:11:50,806 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 16:11:51,067 - aiogram.event - INFO - Update id=66295144 is handled. Duration 1201 ms by bot id=8543122898
2026-02-18 16:11:52,963 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:11:52,964 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:11:52,965 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (7946439246,)
2026-02-18 16:11:52,966 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:11:52,966 - sqlalchemy.engine.Engine - INFO - [cached since 3.091s ago] (7946439246,)
2026-02-18 16:11:52,968 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:11:52,968 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] (1,)
2026-02-18 16:11:53,251 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:11:53,252 - aiogram.event - INFO - Update id=66295145 is handled. Duration 289 ms by bot id=8543122898
2026-02-18 16:11:54,870 - aiogram.event - INFO - Update id=66295146 is handled. Duration 250 ms by bot id=8543122898
2026-02-18 16:11:57,288 - aiogram.event - INFO - Update id=66295147 is handled. Duration 263 ms by bot id=8543122898
2026-02-18 16:11:58,395 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:11:58,395 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:11:58,396 - sqlalchemy.engine.Engine - INFO - [cached since 5.431s ago] (7946439246,)
2026-02-18 16:11:58,397 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:11:58,397 - sqlalchemy.engine.Engine - INFO - [cached since 8.522s ago] (7946439246,)
2026-02-18 16:11:58,398 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:11:58,398 - sqlalchemy.engine.Engine - INFO - [cached since 5.43s ago] (1,)
2026-02-18 16:11:59,051 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/users/dcb84a1e-3ca1-44a7-923c-cb68b880e255 "HTTP/1.1 200 OK"
2026-02-18 16:11:59,052 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:11:59,053 - aiogram.event - INFO - Update id=66295148 is not handled. Duration 880 ms by bot id=8543122898
2026-02-18 16:11:59,053 - aiogram.event - ERROR - Cause exception while process update id=66295148 by bot id=8543122898
TypeError: can't compare offset-naive and offset-aware datetimes
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\puy_vpn.py", line 42, in puy_vpn
    await vpn.buy_vpn(callback.from_user.id, days)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 95, in buy_vpn
    if expired < now:
       ^^^^^^^^^^^^^
TypeError: can't compare offset-naive and offset-aware datetimes
2026-02-18 16:16:33,676 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 16:16:33,677 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 16:16:33,677 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 16:16:33,928 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:16:39,346 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 16:16:39,347 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 16:16:39,347 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 16:16:39,347 - aiogram.dispatcher - INFO - Start polling
2026-02-18 16:16:39,458 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:16:48,689 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:16:48,689 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:16:48,689 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,690 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:16:48,690 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,691 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:16:48,691 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,691 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:16:48,692 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,693 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:16:48,693 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,694 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 16:16:48,694 - sqlalchemy.engine.Engine - INFO - [no key 0.00017s] ()
2026-02-18 16:16:48,705 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 16:16:48,706 - sqlalchemy.engine.Engine - INFO - [no key 0.00059s] ()
2026-02-18 16:16:48,716 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 16:16:48,717 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-18 16:16:48,727 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 16:16:48,728 - sqlalchemy.engine.Engine - INFO - [no key 0.00037s] ()
2026-02-18 16:16:48,739 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 16:16:48,739 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 16:16:48,749 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:16:48,750 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,750 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 16:16:48,750 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,751 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:16:48,751 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,752 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 16:16:48,752 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,752 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:16:48,752 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,753 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 16:16:48,753 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,753 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:16:48,754 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,754 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 16:16:48,755 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,756 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:16:48,756 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,756 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 16:16:48,757 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:48,757 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 16:16:48,758 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 16:16:48,767 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 16:16:48,768 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-18 16:16:48,778 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:16:48,778 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:16:48,789 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 16:16:48,789 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 16:16:48,800 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:16:48,800 - sqlalchemy.engine.Engine - INFO - [no key 0.00035s] ()
2026-02-18 16:16:48,811 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:16:48,811 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 16:16:48,822 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:16:48,822 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 16:16:48,832 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:16:48,833 - aiogram.event - INFO - Update id=66295149 is handled. Duration 761 ms by bot id=8543122898
2026-02-18 16:16:54,535 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:16:54,535 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:16:54,536 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,537 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:16:54,537 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,538 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:16:54,538 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,539 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:16:54,539 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,540 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:16:54,540 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,540 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 16:16:54,541 - sqlalchemy.engine.Engine - INFO - [no key 0.00019s] ()
2026-02-18 16:16:54,552 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 16:16:54,553 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 16:16:54,563 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 16:16:54,563 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 16:16:54,574 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 16:16:54,574 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 16:16:54,585 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 16:16:54,585 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 16:16:54,596 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:16:54,596 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,598 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 16:16:54,598 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,599 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:16:54,599 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,600 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 16:16:54,601 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,601 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:16:54,601 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,602 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 16:16:54,602 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,602 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:16:54,603 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,603 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 16:16:54,603 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,604 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:16:54,604 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,604 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 16:16:54,605 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:16:54,605 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 16:16:54,605 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-18 16:16:54,614 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 16:16:54,614 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-18 16:16:54,625 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:16:54,625 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2026-02-18 16:16:54,635 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 16:16:54,635 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 16:16:54,645 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:16:54,646 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 16:16:54,655 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:16:54,656 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 16:16:54,665 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:16:54,666 - sqlalchemy.engine.Engine - INFO - [no key 0.00112s] ()
2026-02-18 16:16:54,676 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:16:54,677 - aiogram.event - INFO - Update id=66295150 is handled. Duration 270 ms by bot id=8543122898
2026-02-18 16:16:55,741 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:16:55,749 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:16:55,750 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] (7946439246,)
2026-02-18 16:16:55,752 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 16:16:55,752 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (7946439246, '2026-02-18 16:16:55.751344', 0)
2026-02-18 16:16:55,755 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:16:55,767 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 16:16:55,767 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 16:16:56,623 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 16:16:56,738 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/64c60d46-56cc-4855-b552-3dbcbe83fb32 "HTTP/1.1 200 OK"
2026-02-18 16:16:56,739 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:16:56,740 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:16:56,740 - sqlalchemy.engine.Engine - INFO - [cached since 0.9907s ago] (7946439246,)
2026-02-18 16:16:56,742 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 16:16:56,743 - sqlalchemy.engine.Engine - INFO - [generated in 0.00062s] ('https://sub.kurvpn.tech/QXUyXcHDaVvee1R7', '64c60d46-56cc-4855-b552-3dbcbe83fb32', '2026-02-21 16:16:55.767000', 1)
2026-02-18 16:16:56,747 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:16:56,761 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:16:56,762 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:16:56,762 - sqlalchemy.engine.Engine - INFO - [cached since 1.012s ago] (7946439246,)
2026-02-18 16:16:56,763 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 16:16:56,763 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] (7946439246, '2026-02-18 16:16:56.763039', 'active', 1)
2026-02-18 16:16:56,766 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:16:56,775 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 16:16:57,003 - aiogram.event - INFO - Update id=66295151 is handled. Duration 1262 ms by bot id=8543122898
2026-02-18 16:16:59,316 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:16:59,317 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:16:59,317 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (7946439246,)
2026-02-18 16:16:59,318 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:16:59,318 - sqlalchemy.engine.Engine - INFO - [cached since 3.569s ago] (7946439246,)
2026-02-18 16:16:59,320 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:16:59,320 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] (1,)
2026-02-18 16:16:59,478 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:16:59,480 - aiogram.event - INFO - Update id=66295152 is handled. Duration 164 ms by bot id=8543122898
2026-02-18 16:17:05,017 - aiogram.event - INFO - Update id=66295153 is handled. Duration 299 ms by bot id=8543122898
2026-02-18 16:17:06,472 - aiogram.event - INFO - Update id=66295154 is handled. Duration 262 ms by bot id=8543122898
2026-02-18 16:17:07,342 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:17:07,343 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:17:07,343 - sqlalchemy.engine.Engine - INFO - [cached since 8.026s ago] (7946439246,)
2026-02-18 16:17:07,344 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:17:07,344 - sqlalchemy.engine.Engine - INFO - [cached since 11.59s ago] (7946439246,)
2026-02-18 16:17:07,345 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:17:07,346 - sqlalchemy.engine.Engine - INFO - [cached since 8.026s ago] (1,)
2026-02-18 16:17:07,985 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/users/64c60d46-56cc-4855-b552-3dbcbe83fb32 "HTTP/1.1 200 OK"
2026-02-18 16:17:07,986 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:17:07,987 - aiogram.event - INFO - Update id=66295155 is not handled. Duration 764 ms by bot id=8543122898
2026-02-18 16:17:07,987 - aiogram.event - ERROR - Cause exception while process update id=66295155 by bot id=8543122898
TypeError: can't compare offset-naive and offset-aware datetimes
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\puy_vpn.py", line 42, in puy_vpn
    await vpn.buy_vpn(callback.from_user.id, days)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 95, in buy_vpn
    if expired < now:
       ^^^^^^^^^^^^^
TypeError: can't compare offset-naive and offset-aware datetimes
2026-02-18 16:18:19,132 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 16:18:19,133 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 16:18:19,133 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 16:18:19,385 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:18:23,782 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 16:18:23,783 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 16:18:23,783 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 16:18:23,783 - aiogram.dispatcher - INFO - Start polling
2026-02-18 16:18:23,882 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:18:28,101 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:18:28,101 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:18:28,102 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,104 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:18:28,104 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,107 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:18:28,107 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,108 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:18:28,108 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,109 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:18:28,110 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,110 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 16:18:28,111 - sqlalchemy.engine.Engine - INFO - [no key 0.00082s] ()
2026-02-18 16:18:28,123 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 16:18:28,123 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 16:18:28,133 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 16:18:28,134 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-18 16:18:28,143 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 16:18:28,143 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 16:18:28,154 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 16:18:28,154 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 16:18:28,165 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:18:28,165 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,166 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 16:18:28,166 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,167 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:18:28,167 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,168 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 16:18:28,168 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,168 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:18:28,168 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,169 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 16:18:28,169 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,169 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:18:28,169 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,170 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 16:18:28,170 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,170 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:18:28,170 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,171 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 16:18:28,171 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:18:28,172 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 16:18:28,172 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 16:18:28,183 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 16:18:28,184 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 16:18:28,194 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:18:28,195 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 16:18:28,205 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 16:18:28,206 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-18 16:18:28,216 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:18:28,217 - sqlalchemy.engine.Engine - INFO - [no key 0.00045s] ()
2026-02-18 16:18:28,228 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:18:28,228 - sqlalchemy.engine.Engine - INFO - [no key 0.00044s] ()
2026-02-18 16:18:28,238 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:18:28,239 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2026-02-18 16:18:28,249 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:18:28,250 - aiogram.event - INFO - Update id=66295158 is handled. Duration 832 ms by bot id=8543122898
2026-02-18 16:18:29,613 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:18:29,621 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:18:29,622 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] (7946439246,)
2026-02-18 16:18:29,624 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 16:18:29,624 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (7946439246, '2026-02-18 16:18:29.623330', 0)
2026-02-18 16:18:29,625 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:18:29,637 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 16:18:29,637 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 16:18:30,485 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 400 Bad Request"
2026-02-18 16:18:30,486 - aiogram.event - INFO - Update id=66295159 is not handled. Duration 874 ms by bot id=8543122898
2026-02-18 16:18:30,486 - aiogram.event - ERROR - Cause exception while process update id=66295159 by bot id=8543122898
ConflictError: API Error A019: User username already exists (HTTP 400)
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 68, in _handle_response
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_models.py", line 763, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://admin.kurvpn.tech/api/users'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\start_cmd.py", line 39, in start_cmd
    await client.create_client(tg_user)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 43, in create_client
    rem_user = await self.rem.users.create_user(create_body)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\decorators.py", line 43, in wrapper
    return api._handle_response(response, response_class=response_class)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 70, in _handle_response
    handle_api_error(e.response)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\exceptions\handler.py", line 217, in handle_api_error
    raise exception_class(response.status_code, error_response)
remnawave.exceptions.general.ConflictError: API Error A019: User username already exists (HTTP 400)
2026-02-18 16:18:50,057 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 16:18:50,058 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 16:18:50,058 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 16:18:50,320 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:18:55,710 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 16:18:55,711 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 16:18:55,711 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 16:18:55,712 - aiogram.dispatcher - INFO - Start polling
2026-02-18 16:18:55,798 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 16:19:03,154 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:19:03,155 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:19:03,155 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,156 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:19:03,156 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,157 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:19:03,157 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,158 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:19:03,158 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,159 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:19:03,159 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,160 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 16:19:03,161 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-18 16:19:03,173 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 16:19:03,174 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 16:19:03,184 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 16:19:03,185 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 16:19:03,195 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 16:19:03,196 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 16:19:03,206 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 16:19:03,207 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 16:19:03,216 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 16:19:03,216 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,217 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 16:19:03,217 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,217 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 16:19:03,217 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,218 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 16:19:03,218 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,218 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 16:19:03,219 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,219 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 16:19:03,220 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,220 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 16:19:03,221 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,222 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 16:19:03,223 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,223 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 16:19:03,223 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,224 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 16:19:03,224 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 16:19:03,225 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 16:19:03,225 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 16:19:03,236 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 16:19:03,237 - sqlalchemy.engine.Engine - INFO - [no key 0.00040s] ()
2026-02-18 16:19:03,247 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:19:03,247 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2026-02-18 16:19:03,267 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 16:19:03,268 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 16:19:03,278 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:19:03,279 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 16:19:03,289 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:19:03,289 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 16:19:03,301 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 16:19:03,301 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 16:19:03,315 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:19:03,316 - aiogram.event - INFO - Update id=66295161 is handled. Duration 811 ms by bot id=8543122898
2026-02-18 16:19:04,625 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:19:04,634 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:19:04,634 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] (7946439246,)
2026-02-18 16:19:04,637 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 16:19:04,638 - sqlalchemy.engine.Engine - INFO - [generated in 0.00074s] (7946439246, '2026-02-18 16:19:04.636046', 0)
2026-02-18 16:19:04,639 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:19:04,650 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 16:19:04,650 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 16:19:05,316 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 16:19:05,443 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/c61edd79-84cf-4d90-8c9e-e4eabb42066b "HTTP/1.1 200 OK"
2026-02-18 16:19:05,444 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:19:05,444 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:19:05,445 - sqlalchemy.engine.Engine - INFO - [cached since 0.8105s ago] (7946439246,)
2026-02-18 16:19:05,446 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 16:19:05,446 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ('https://sub.kurvpn.tech/gX9e8Rnr1nr8quLe', 'c61edd79-84cf-4d90-8c9e-e4eabb42066b', '2026-02-21 13:19:04.650000', 1)
2026-02-18 16:19:05,448 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:19:05,459 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:19:05,460 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:19:05,460 - sqlalchemy.engine.Engine - INFO - [cached since 0.8256s ago] (7946439246,)
2026-02-18 16:19:05,461 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 16:19:05,461 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] (7946439246, '2026-02-18 13:19:05.460916', 'active', 1)
2026-02-18 16:19:05,462 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:19:05,472 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 16:19:05,694 - aiogram.event - INFO - Update id=66295162 is handled. Duration 1069 ms by bot id=8543122898
2026-02-18 16:19:09,035 - aiogram.event - INFO - Update id=66295163 is handled. Duration 226 ms by bot id=8543122898
2026-02-18 16:19:10,006 - aiogram.event - INFO - Update id=66295164 is handled. Duration 207 ms by bot id=8543122898
2026-02-18 16:19:10,825 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:19:10,826 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:19:10,826 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (7946439246,)
2026-02-18 16:19:10,827 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:19:10,827 - sqlalchemy.engine.Engine - INFO - [cached since 6.193s ago] (7946439246,)
2026-02-18 16:19:10,829 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:19:10,829 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] (1,)
2026-02-18 16:19:11,479 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/users/c61edd79-84cf-4d90-8c9e-e4eabb42066b "HTTP/1.1 200 OK"
2026-02-18 16:19:11,607 - httpx - INFO - HTTP Request: PATCH https://admin.kurvpn.tech/api/users "HTTP/1.1 200 OK"
2026-02-18 16:19:11,609 - sqlalchemy.engine.Engine - INFO - UPDATE vpn_accounts SET expired_at=? WHERE vpn_accounts.id = ?
2026-02-18 16:19:11,609 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] ('2026-03-23 13:19:04.650000', 1)
2026-02-18 16:19:11,610 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:19:11,624 - common.handlers_flder.puy_vpn - INFO - Подписка продлена на 30 дней для пользователя: 7946439246
2026-02-18 16:19:11,625 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:19:11,625 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:19:11,626 - sqlalchemy.engine.Engine - INFO - [cached since 6.992s ago] (7946439246,)
2026-02-18 16:19:11,627 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 16:19:11,628 - sqlalchemy.engine.Engine - INFO - INSERT INTO shoping (money, shop_date, user_id) VALUES (?, ?, ?)
2026-02-18 16:19:11,628 - sqlalchemy.engine.Engine - INFO - [generated in 0.00022s] (149, '2026-02-18 16:19', 1)
2026-02-18 16:19:11,629 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 16:19:11,638 - ServiceClasses.shoping_service - INFO - Покупка создана: пользователь 1, сумма 149 Р., дата 2026-02-18 16:19
2026-02-18 16:19:11,638 - common.handlers_flder.puy_vpn - INFO - Запись о покупке добавлена для пользователя: 7946439246 с суммой: 149 Р. и датой: 2026-02-18 16:19
2026-02-18 16:19:11,639 - aiogram.event - INFO - Update id=66295165 is handled. Duration 941 ms by bot id=8543122898
2026-02-18 16:19:15,208 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:19:15,208 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:19:15,208 - sqlalchemy.engine.Engine - INFO - [cached since 4.382s ago] (7946439246,)
2026-02-18 16:19:15,209 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:19:15,209 - sqlalchemy.engine.Engine - INFO - [cached since 10.58s ago] (7946439246,)
2026-02-18 16:19:15,210 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:19:15,210 - sqlalchemy.engine.Engine - INFO - [cached since 4.382s ago] (1,)
2026-02-18 16:19:15,344 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:19:15,345 - aiogram.event - INFO - Update id=66295166 is handled. Duration 138 ms by bot id=8543122898
2026-02-18 16:43:58,403 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:43:58,403 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:43:58,404 - sqlalchemy.engine.Engine - INFO - [cached since 1494s ago] (7946439246,)
2026-02-18 16:43:58,405 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 16:43:58,405 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:43:58,594 - aiogram.event - INFO - Update id=66295167 is handled. Duration 191 ms by bot id=8543122898
2026-02-18 16:43:59,775 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:43:59,775 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 16:43:59,775 - sqlalchemy.engine.Engine - INFO - [cached since 1489s ago] (7946439246,)
2026-02-18 16:43:59,776 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:43:59,777 - sqlalchemy.engine.Engine - INFO - [cached since 1495s ago] (7946439246,)
2026-02-18 16:43:59,778 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 16:43:59,778 - sqlalchemy.engine.Engine - INFO - [cached since 1489s ago] (1,)
2026-02-18 16:43:59,953 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:43:59,953 - aiogram.event - INFO - Update id=66295168 is handled. Duration 179 ms by bot id=8543122898
2026-02-18 16:44:02,141 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 16:44:02,141 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 16:44:02,142 - sqlalchemy.engine.Engine - INFO - [cached since 1498s ago] (7946439246,)
2026-02-18 16:44:02,142 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 16:44:02,144 - sqlalchemy.engine.Engine - INFO - SELECT shoping.id, shoping.money, shoping.shop_date, shoping.user_id 
FROM shoping 
WHERE shoping.user_id = ?
2026-02-18 16:44:02,144 - sqlalchemy.engine.Engine - INFO - [generated in 0.00027s] (1,)
2026-02-18 16:44:02,145 - ServiceClasses.shoping_service - INFO - Получено 1 покупок для пользователя 1
2026-02-18 16:44:02,273 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 16:44:02,274 - aiogram.event - INFO - Update id=66295169 is handled. Duration 133 ms by bot id=8543122898
2026-02-18 17:04:48,350 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 17:04:48,351 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 17:04:48,351 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 17:04:48,607 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 17:05:49,372 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 17:05:49,373 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 17:05:49,373 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 17:05:49,374 - aiogram.dispatcher - INFO - Start polling
2026-02-18 17:05:49,483 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 17:05:50,404 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:05:50,404 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 17:05:50,404 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,405 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 17:05:50,406 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,406 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 17:05:50,406 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,407 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 17:05:50,407 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,408 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 17:05:50,409 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,411 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 17:05:50,411 - sqlalchemy.engine.Engine - INFO - [no key 0.00054s] ()
2026-02-18 17:05:50,427 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 17:05:50,427 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 17:05:50,437 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 17:05:50,437 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 17:05:50,447 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 17:05:50,447 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2026-02-18 17:05:50,457 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 17:05:50,457 - sqlalchemy.engine.Engine - INFO - [no key 0.00032s] ()
2026-02-18 17:05:50,467 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 17:05:50,467 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,468 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 17:05:50,468 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,469 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 17:05:50,469 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,470 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 17:05:50,470 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,470 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 17:05:50,471 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,471 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 17:05:50,471 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,472 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 17:05:50,472 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,473 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 17:05:50,473 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,473 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 17:05:50,473 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,474 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 17:05:50,474 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:05:50,475 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 17:05:50,476 - sqlalchemy.engine.Engine - INFO - [no key 0.00037s] ()
2026-02-18 17:05:50,486 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 17:05:50,486 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 17:05:50,499 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:05:50,499 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2026-02-18 17:05:50,511 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 17:05:50,512 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-18 17:05:50,523 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:05:50,523 - sqlalchemy.engine.Engine - INFO - [no key 0.00049s] ()
2026-02-18 17:05:50,537 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:05:50,537 - sqlalchemy.engine.Engine - INFO - [no key 0.00042s] ()
2026-02-18 17:05:50,548 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:05:50,548 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-18 17:05:50,559 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:05:50,559 - aiogram.event - INFO - Update id=66295172 is handled. Duration 978 ms by bot id=8543122898
2026-02-18 17:05:52,635 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:05:52,642 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:05:52,643 - sqlalchemy.engine.Engine - INFO - [generated in 0.00039s] (7946439246,)
2026-02-18 17:05:52,645 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 17:05:52,645 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] (7946439246, '2026-02-18 17:05:52.644513', 0)
2026-02-18 17:05:52,648 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:05:52,655 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 17:05:52,655 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 17:05:53,675 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 400 Bad Request"
2026-02-18 17:05:53,676 - aiogram.event - INFO - Update id=66295173 is not handled. Duration 1041 ms by bot id=8543122898
2026-02-18 17:05:53,676 - aiogram.event - ERROR - Cause exception while process update id=66295173 by bot id=8543122898
ConflictError: API Error A019: User username already exists (HTTP 400)
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 68, in _handle_response
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_models.py", line 763, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://admin.kurvpn.tech/api/users'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\start_cmd.py", line 39, in start_cmd
    await client.create_client(tg_user)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 43, in create_client
    rem_user = await self.rem.users.create_user(create_body)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\decorators.py", line 43, in wrapper
    return api._handle_response(response, response_class=response_class)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 70, in _handle_response
    handle_api_error(e.response)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\exceptions\handler.py", line 217, in handle_api_error
    raise exception_class(response.status_code, error_response)
remnawave.exceptions.general.ConflictError: API Error A019: User username already exists (HTTP 400)
2026-02-18 17:06:05,547 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:06:05,547 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 17:06:05,547 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,548 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 17:06:05,548 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,549 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 17:06:05,549 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,550 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 17:06:05,550 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,550 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 17:06:05,551 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,552 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 17:06:05,553 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 17:06:05,564 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 17:06:05,564 - sqlalchemy.engine.Engine - INFO - [no key 0.00041s] ()
2026-02-18 17:06:05,574 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 17:06:05,574 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-18 17:06:05,585 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 17:06:05,585 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 17:06:05,596 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 17:06:05,596 - sqlalchemy.engine.Engine - INFO - [no key 0.00061s] ()
2026-02-18 17:06:05,607 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 17:06:05,607 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,608 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 17:06:05,609 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,610 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 17:06:05,610 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,611 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 17:06:05,611 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,612 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 17:06:05,612 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,613 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 17:06:05,613 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,614 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 17:06:05,614 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,615 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 17:06:05,615 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,615 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 17:06:05,616 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,616 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 17:06:05,616 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:06:05,617 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 17:06:05,617 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 17:06:05,629 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 17:06:05,630 - sqlalchemy.engine.Engine - INFO - [no key 0.00078s] ()
2026-02-18 17:06:05,640 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:06:05,641 - sqlalchemy.engine.Engine - INFO - [no key 0.00079s] ()
2026-02-18 17:06:05,651 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 17:06:05,651 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 17:06:05,662 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:06:05,662 - sqlalchemy.engine.Engine - INFO - [no key 0.00039s] ()
2026-02-18 17:06:05,673 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:06:05,673 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 17:06:05,684 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:06:05,684 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-18 17:06:05,711 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:06:05,711 - aiogram.event - INFO - Update id=66295174 is handled. Duration 296 ms by bot id=8543122898
2026-02-18 17:06:07,026 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:06:07,026 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:06:07,027 - sqlalchemy.engine.Engine - INFO - [cached since 14.38s ago] (7946439246,)
2026-02-18 17:06:07,028 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 17:06:07,028 - sqlalchemy.engine.Engine - INFO - [cached since 14.38s ago] (7946439246, '2026-02-18 17:06:07.027690', 0)
2026-02-18 17:06:07,029 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:06:07,042 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 17:06:07,043 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 17:06:07,959 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 17:06:08,081 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/3dce315f-40f7-4359-8b6b-8d0e6dd2dd25 "HTTP/1.1 200 OK"
2026-02-18 17:06:08,082 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:06:08,082 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:06:08,083 - sqlalchemy.engine.Engine - INFO - [cached since 15.44s ago] (7946439246,)
2026-02-18 17:06:08,084 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:06:08,084 - sqlalchemy.engine.Engine - INFO - [generated in 0.00026s] ('https://sub.kurvpn.tech/uMsc66QKvkRBQmXm', '3dce315f-40f7-4359-8b6b-8d0e6dd2dd25', '2026-02-21 14:06:07.044000', 1)
2026-02-18 17:06:08,086 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:06:08,097 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:06:08,097 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:06:08,098 - sqlalchemy.engine.Engine - INFO - [cached since 15.46s ago] (7946439246,)
2026-02-18 17:06:08,099 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:06:08,099 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] (7946439246, '2026-02-18 14:06:08.098815', 'active', 1)
2026-02-18 17:06:08,101 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:06:08,111 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 17:06:08,532 - aiogram.event - INFO - Update id=66295175 is handled. Duration 1506 ms by bot id=8543122898
2026-02-18 17:06:10,342 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:06:10,343 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 17:06:10,343 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (7946439246,)
2026-02-18 17:06:10,344 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:06:10,344 - sqlalchemy.engine.Engine - INFO - [cached since 17.7s ago] (7946439246,)
2026-02-18 17:06:10,346 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 17:06:10,347 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] (1,)
2026-02-18 17:06:10,480 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 17:06:10,480 - aiogram.event - INFO - Update id=66295176 is handled. Duration 139 ms by bot id=8543122898
2026-02-18 17:06:12,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:06:12,446 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:06:12,446 - sqlalchemy.engine.Engine - INFO - [cached since 19.8s ago] (7946439246,)
2026-02-18 17:06:12,447 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 17:06:12,447 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 17:06:13,035 - aiogram.event - INFO - Update id=66295177 is handled. Duration 590 ms by bot id=8543122898
2026-02-18 17:06:26,359 - aiogram.event - INFO - Update id=66295178 is not handled. Duration 0 ms by bot id=8543122898
2026-02-18 17:06:29,249 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:06:29,249 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:06:29,250 - sqlalchemy.engine.Engine - INFO - [cached since 36.61s ago] (8016999764,)
2026-02-18 17:06:29,251 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 17:06:29,251 - sqlalchemy.engine.Engine - INFO - [cached since 36.61s ago] (8016999764, '2026-02-18 17:06:29.251211', 0)
2026-02-18 17:06:29,253 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:06:29,264 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 8016999764
2026-02-18 17:06:29,264 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 8016999764 создан в базе данных.
2026-02-18 17:06:29,907 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 17:06:30,012 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/d607921d-b60b-44d8-a56b-ad0362c9947c "HTTP/1.1 200 OK"
2026-02-18 17:06:30,013 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:06:30,013 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:06:30,013 - sqlalchemy.engine.Engine - INFO - [cached since 37.37s ago] (8016999764,)
2026-02-18 17:06:30,014 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:06:30,014 - sqlalchemy.engine.Engine - INFO - [cached since 21.93s ago] ('https://sub.kurvpn.tech/zAEm087_7BrSN7CZ', 'd607921d-b60b-44d8-a56b-ad0362c9947c', '2026-02-21 14:06:29.265000', 2)
2026-02-18 17:06:30,015 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:06:30,025 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:06:30,025 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:06:30,026 - sqlalchemy.engine.Engine - INFO - [cached since 37.38s ago] (8016999764,)
2026-02-18 17:06:30,026 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:06:30,027 - sqlalchemy.engine.Engine - INFO - [cached since 21.93s ago] (8016999764, '2026-02-18 14:06:30.026697', 'active', 2)
2026-02-18 17:06:30,028 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:06:30,037 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 8016999764
2026-02-18 17:06:30,039 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:06:30,040 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:06:30,041 - sqlalchemy.engine.Engine - INFO - [cached since 37.4s ago] (7946439246,)
2026-02-18 17:06:30,042 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 17:06:30,043 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:06:30,044 - sqlalchemy.engine.Engine - INFO - [cached since 37.4s ago] (8016999764,)
2026-02-18 17:06:30,046 - sqlalchemy.engine.Engine - INFO - SELECT referals.id, referals.invited_by_tg_id, referals.ref_tg_id, referals.bonus_given, referals.user_id 
FROM referals 
WHERE referals.ref_tg_id = ?
2026-02-18 17:06:30,048 - sqlalchemy.engine.Engine - INFO - [generated in 0.00169s] (8016999764,)
2026-02-18 17:06:30,050 - sqlalchemy.engine.Engine - INFO - INSERT INTO referals (invited_by_tg_id, ref_tg_id, bonus_given, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:06:30,050 - sqlalchemy.engine.Engine - INFO - [generated in 0.00040s] (7946439246, 8016999764, 0, 2)
2026-02-18 17:06:30,052 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:06:30,060 - common.handlers_flder.start_cmd - INFO - Создан реферал для пользователя: 8016999764 приглашённым пользователем: 7946439246
2026-02-18 17:06:30,060 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:06:30,060 - sqlalchemy.engine.Engine - INFO - SELECT referals.id, referals.invited_by_tg_id, referals.ref_tg_id, referals.bonus_given, referals.user_id 
FROM referals 
WHERE referals.ref_tg_id = ?
2026-02-18 17:06:30,060 - sqlalchemy.engine.Engine - INFO - [cached since 0.01442s ago] (8016999764,)
2026-02-18 17:06:30,061 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 17:06:30,062 - sqlalchemy.engine.Engine - INFO - [cached since 19.72s ago] (7946439246,)
2026-02-18 17:06:30,062 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:06:30,063 - sqlalchemy.engine.Engine - INFO - [cached since 37.42s ago] (7946439246,)
2026-02-18 17:06:30,064 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 17:06:30,064 - sqlalchemy.engine.Engine - INFO - [cached since 19.72s ago] (1,)
2026-02-18 17:06:30,171 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/users/3dce315f-40f7-4359-8b6b-8d0e6dd2dd25 "HTTP/1.1 200 OK"
2026-02-18 17:06:30,173 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 17:06:30,173 - aiogram.event - INFO - Update id=66295179 is not handled. Duration 925 ms by bot id=8543122898
2026-02-18 17:06:30,174 - aiogram.event - ERROR - Cause exception while process update id=66295179 by bot id=8543122898
ValidationError: 1 validation error for UpdateUserRequestDto
expire_at
  Input should be a valid datetime [type=datetime_type, input_value=datetime.timedelta(days=5), input_type=timedelta]
    For further information visit https://errors.pydantic.dev/2.11/v/datetime_type
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\start_cmd.py", line 61, in start_cmd
    await client.referal_vpn(invited_id, ref_tg)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 114, in referal_vpn
    body = UpdateUserRequestDto(uuid=vpn_exp.uuid, expire_at=timedelta(days=5))
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\pydantic\main.py", line 253, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
pydantic_core._pydantic_core.ValidationError: 1 validation error for UpdateUserRequestDto
expire_at
  Input should be a valid datetime [type=datetime_type, input_value=datetime.timedelta(days=5), input_type=timedelta]
    For further information visit https://errors.pydantic.dev/2.11/v/datetime_type
2026-02-18 17:09:44,455 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 17:09:44,456 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 17:09:44,456 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 17:09:44,713 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 17:09:50,783 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 17:09:50,784 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 17:09:50,784 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 17:09:50,784 - aiogram.dispatcher - INFO - Start polling
2026-02-18 17:09:50,882 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 17:10:05,120 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 17:10:05,121 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 17:10:05,122 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 17:10:05,375 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 17:10:09,886 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 17:10:09,887 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 17:10:09,887 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 17:10:09,887 - aiogram.dispatcher - INFO - Start polling
2026-02-18 17:10:09,995 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 17:10:15,950 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:10:15,950 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 17:10:15,950 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:15,952 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 17:10:15,952 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:15,953 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 17:10:15,953 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:15,954 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 17:10:15,954 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:15,955 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 17:10:15,955 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:15,955 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 17:10:15,956 - sqlalchemy.engine.Engine - INFO - [no key 0.00016s] ()
2026-02-18 17:10:15,966 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 17:10:15,966 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 17:10:15,975 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 17:10:15,975 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 17:10:15,984 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 17:10:15,984 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2026-02-18 17:10:15,994 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 17:10:15,994 - sqlalchemy.engine.Engine - INFO - [no key 0.00034s] ()
2026-02-18 17:10:16,003 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 17:10:16,003 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,004 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 17:10:16,004 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,005 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 17:10:16,005 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,005 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 17:10:16,006 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,006 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 17:10:16,006 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,007 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 17:10:16,007 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,007 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 17:10:16,007 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,008 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 17:10:16,008 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,009 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 17:10:16,009 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,010 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 17:10:16,010 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,011 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 17:10:16,011 - sqlalchemy.engine.Engine - INFO - [no key 0.00020s] ()
2026-02-18 17:10:16,021 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 17:10:16,021 - sqlalchemy.engine.Engine - INFO - [no key 0.00021s] ()
2026-02-18 17:10:16,031 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:10:16,032 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2026-02-18 17:10:16,042 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 17:10:16,043 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 17:10:16,053 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:10:16,053 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 17:10:16,064 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:10:16,065 - sqlalchemy.engine.Engine - INFO - [no key 0.00058s] ()
2026-02-18 17:10:16,076 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:10:16,076 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 17:10:16,085 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:10:16,085 - aiogram.event - INFO - Update id=66295180 is handled. Duration 4462 ms by bot id=8543122898
2026-02-18 17:10:16,497 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:10:16,497 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 17:10:16,497 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,498 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 17:10:16,498 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,498 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 17:10:16,498 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,499 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 17:10:16,499 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,499 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 17:10:16,500 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,500 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 17:10:16,500 - sqlalchemy.engine.Engine - INFO - [no key 0.00014s] ()
2026-02-18 17:10:16,512 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 17:10:16,512 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 17:10:16,521 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 17:10:16,521 - sqlalchemy.engine.Engine - INFO - [no key 0.00023s] ()
2026-02-18 17:10:16,531 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 17:10:16,531 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 17:10:16,540 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 17:10:16,541 - sqlalchemy.engine.Engine - INFO - [no key 0.00086s] ()
2026-02-18 17:10:16,551 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 17:10:16,551 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,551 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 17:10:16,552 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,553 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 17:10:16,553 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,554 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 17:10:16,554 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,555 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 17:10:16,555 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,556 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 17:10:16,556 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,556 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 17:10:16,557 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,557 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 17:10:16,558 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,559 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 17:10:16,559 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,560 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 17:10:16,560 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:10:16,560 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 17:10:16,561 - sqlalchemy.engine.Engine - INFO - [no key 0.00019s] ()
2026-02-18 17:10:16,571 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 17:10:16,571 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 17:10:16,581 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:10:16,581 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2026-02-18 17:10:16,593 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 17:10:16,594 - sqlalchemy.engine.Engine - INFO - [no key 0.00077s] ()
2026-02-18 17:10:16,605 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:10:16,605 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 17:10:16,615 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:10:16,615 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 17:10:16,624 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:10:16,624 - sqlalchemy.engine.Engine - INFO - [no key 0.00031s] ()
2026-02-18 17:10:16,633 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:10:16,634 - aiogram.event - INFO - Update id=66295181 is handled. Duration 550 ms by bot id=8543122898
2026-02-18 17:10:41,233 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:10:41,242 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:10:41,242 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (7946439246,)
2026-02-18 17:10:41,245 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 17:10:41,245 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (7946439246, '2026-02-18 17:10:41.244021', 0)
2026-02-18 17:10:41,247 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:10:41,258 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 17:10:41,258 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 17:10:42,118 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 17:10:42,225 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/5d3a00b2-0a4a-4fef-a321-8b149542c240 "HTTP/1.1 200 OK"
2026-02-18 17:10:42,226 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:10:42,226 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:10:42,226 - sqlalchemy.engine.Engine - INFO - [cached since 0.9843s ago] (7946439246,)
2026-02-18 17:10:42,228 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:10:42,228 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] ('https://sub.kurvpn.tech/1NnTGFyvwWvH-0zh', '5d3a00b2-0a4a-4fef-a321-8b149542c240', '2026-02-21 14:10:41.258000', 1)
2026-02-18 17:10:42,231 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:10:42,243 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:10:42,243 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:10:42,244 - sqlalchemy.engine.Engine - INFO - [cached since 1.002s ago] (7946439246,)
2026-02-18 17:10:42,245 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:10:42,245 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] (7946439246, '2026-02-18 14:10:42.244918', 'active', 1)
2026-02-18 17:10:42,248 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:10:42,258 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 17:10:42,498 - aiogram.event - INFO - Update id=66295182 is handled. Duration 1265 ms by bot id=8543122898
2026-02-18 17:10:55,834 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:10:55,834 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:10:55,834 - sqlalchemy.engine.Engine - INFO - [cached since 14.59s ago] (8016999764,)
2026-02-18 17:10:55,836 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 17:10:55,836 - sqlalchemy.engine.Engine - INFO - [cached since 14.59s ago] (8016999764, '2026-02-18 17:10:55.836032', 0)
2026-02-18 17:10:55,837 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:10:55,848 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 8016999764
2026-02-18 17:10:55,852 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 8016999764 создан в базе данных.
2026-02-18 17:10:56,466 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 17:10:56,571 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/aa283017-fb2e-4f83-9074-0a92ac1e0545 "HTTP/1.1 200 OK"
2026-02-18 17:10:56,571 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:10:56,572 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:10:56,572 - sqlalchemy.engine.Engine - INFO - [cached since 15.33s ago] (8016999764,)
2026-02-18 17:10:56,573 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:10:56,573 - sqlalchemy.engine.Engine - INFO - [cached since 14.35s ago] ('https://sub.kurvpn.tech/vH3-jZAsBYBjaHUH', 'aa283017-fb2e-4f83-9074-0a92ac1e0545', '2026-02-21 14:10:55.852000', 2)
2026-02-18 17:10:56,575 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:10:56,585 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:10:56,585 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:10:56,585 - sqlalchemy.engine.Engine - INFO - [cached since 15.34s ago] (8016999764,)
2026-02-18 17:10:56,586 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:10:56,587 - sqlalchemy.engine.Engine - INFO - [cached since 14.34s ago] (8016999764, '2026-02-18 14:10:56.586664', 'active', 2)
2026-02-18 17:10:56,588 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:10:56,597 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 8016999764
2026-02-18 17:10:56,598 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:10:56,598 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:10:56,598 - sqlalchemy.engine.Engine - INFO - [cached since 15.36s ago] (7946439246,)
2026-02-18 17:10:56,599 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 17:10:56,600 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:10:56,600 - sqlalchemy.engine.Engine - INFO - [cached since 15.36s ago] (8016999764,)
2026-02-18 17:10:56,603 - sqlalchemy.engine.Engine - INFO - SELECT referals.id, referals.invited_by_tg_id, referals.ref_tg_id, referals.bonus_given, referals.user_id 
FROM referals 
WHERE referals.ref_tg_id = ?
2026-02-18 17:10:56,603 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] (8016999764,)
2026-02-18 17:10:56,605 - sqlalchemy.engine.Engine - INFO - INSERT INTO referals (invited_by_tg_id, ref_tg_id, bonus_given, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:10:56,606 - sqlalchemy.engine.Engine - INFO - [generated in 0.00036s] (7946439246, 8016999764, 0, 2)
2026-02-18 17:10:56,608 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:10:56,629 - common.handlers_flder.start_cmd - INFO - Создан реферал для пользователя: 8016999764 приглашённым пользователем: 7946439246
2026-02-18 17:10:56,630 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:10:56,630 - sqlalchemy.engine.Engine - INFO - SELECT referals.id, referals.invited_by_tg_id, referals.ref_tg_id, referals.bonus_given, referals.user_id 
FROM referals 
WHERE referals.ref_tg_id = ?
2026-02-18 17:10:56,630 - sqlalchemy.engine.Engine - INFO - [cached since 0.02751s ago] (8016999764,)
2026-02-18 17:10:56,632 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 17:10:56,632 - sqlalchemy.engine.Engine - INFO - [generated in 0.00025s] (7946439246,)
2026-02-18 17:10:56,633 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:10:56,633 - sqlalchemy.engine.Engine - INFO - [cached since 15.39s ago] (7946439246,)
2026-02-18 17:10:56,636 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 17:10:56,636 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] (1,)
2026-02-18 17:10:56,747 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/users/5d3a00b2-0a4a-4fef-a321-8b149542c240 "HTTP/1.1 200 OK"
2026-02-18 17:10:56,853 - httpx - INFO - HTTP Request: PATCH https://admin.kurvpn.tech/api/users "HTTP/1.1 200 OK"
2026-02-18 17:10:56,855 - sqlalchemy.engine.Engine - INFO - UPDATE referals SET bonus_given=? WHERE referals.id = ?
2026-02-18 17:10:56,855 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (1, 1)
2026-02-18 17:10:56,858 - sqlalchemy.engine.Engine - INFO - UPDATE vpn_accounts SET expired_at=? WHERE vpn_accounts.id = ?
2026-02-18 17:10:56,858 - sqlalchemy.engine.Engine - INFO - [generated in 0.00029s] ('2026-02-26 14:10:41.258000', 1)
2026-02-18 17:10:56,859 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:10:56,868 - common.handlers_flder.start_cmd - INFO - Реферальный бонус применён для пользователя: 7946439246 за приглашённого пользователя: 8016999764
2026-02-18 17:10:56,869 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:10:56,870 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:10:56,870 - sqlalchemy.engine.Engine - INFO - [cached since 15.63s ago] (7946439246,)
2026-02-18 17:10:56,871 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 17:10:56,872 - sqlalchemy.engine.Engine - INFO - UPDATE users SET referal_count=? WHERE users.id = ?
2026-02-18 17:10:56,872 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s] (1, 1)
2026-02-18 17:10:56,874 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:10:56,884 - ServiceClasses.user_service - INFO - Счётчик рефералов для пользователя 7946439246 увеличен. Новое значение: 1
2026-02-18 17:10:57,109 - aiogram.event - INFO - Update id=66295183 is handled. Duration 1276 ms by bot id=8543122898
2026-02-18 17:11:05,885 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:11:05,886 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:11:05,886 - sqlalchemy.engine.Engine - INFO - [cached since 24.64s ago] (8016999764,)
2026-02-18 17:11:05,886 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 8016999764 найден в базе.
2026-02-18 17:11:05,887 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:11:05,887 - sqlalchemy.engine.Engine - INFO - [cached since 24.64s ago] (7946439246,)
2026-02-18 17:11:05,887 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 17:11:05,888 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:11:05,888 - sqlalchemy.engine.Engine - INFO - [cached since 24.65s ago] (8016999764,)
2026-02-18 17:11:05,889 - sqlalchemy.engine.Engine - INFO - SELECT referals.id, referals.invited_by_tg_id, referals.ref_tg_id, referals.bonus_given, referals.user_id 
FROM referals 
WHERE referals.ref_tg_id = ?
2026-02-18 17:11:05,890 - sqlalchemy.engine.Engine - INFO - [cached since 9.287s ago] (8016999764,)
2026-02-18 17:11:05,890 - ServiceClasses.referal_service - WARNING - Пользователь 8016999764 уже имеет реферала. Создание нового реферала не разрешено.
2026-02-18 17:11:05,890 - common.handlers_flder.start_cmd - INFO - Создан реферал для пользователя: 8016999764 приглашённым пользователем: 7946439246
2026-02-18 17:11:05,891 - sqlalchemy.engine.Engine - INFO - SELECT referals.id, referals.invited_by_tg_id, referals.ref_tg_id, referals.bonus_given, referals.user_id 
FROM referals 
WHERE referals.ref_tg_id = ?
2026-02-18 17:11:05,891 - sqlalchemy.engine.Engine - INFO - [cached since 9.288s ago] (8016999764,)
2026-02-18 17:11:05,892 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 17:11:05,892 - sqlalchemy.engine.Engine - INFO - [cached since 9.261s ago] (7946439246,)
2026-02-18 17:11:05,893 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 17:11:05,894 - aiogram.event - INFO - Update id=66295184 is handled. Duration 8 ms by bot id=8543122898
2026-02-18 17:11:08,995 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:11:08,995 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:11:08,995 - sqlalchemy.engine.Engine - INFO - [cached since 27.75s ago] (8016999764,)
2026-02-18 17:11:08,996 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 8016999764 найден в базе.
2026-02-18 17:11:08,997 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:11:08,997 - sqlalchemy.engine.Engine - INFO - [cached since 27.75s ago] (7946439246,)
2026-02-18 17:11:08,998 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 17:11:08,998 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:11:08,998 - sqlalchemy.engine.Engine - INFO - [cached since 27.76s ago] (8016999764,)
2026-02-18 17:11:08,999 - sqlalchemy.engine.Engine - INFO - SELECT referals.id, referals.invited_by_tg_id, referals.ref_tg_id, referals.bonus_given, referals.user_id 
FROM referals 
WHERE referals.ref_tg_id = ?
2026-02-18 17:11:08,999 - sqlalchemy.engine.Engine - INFO - [cached since 12.4s ago] (8016999764,)
2026-02-18 17:11:09,000 - ServiceClasses.referal_service - WARNING - Пользователь 8016999764 уже имеет реферала. Создание нового реферала не разрешено.
2026-02-18 17:11:09,001 - common.handlers_flder.start_cmd - INFO - Создан реферал для пользователя: 8016999764 приглашённым пользователем: 7946439246
2026-02-18 17:11:09,002 - sqlalchemy.engine.Engine - INFO - SELECT referals.id, referals.invited_by_tg_id, referals.ref_tg_id, referals.bonus_given, referals.user_id 
FROM referals 
WHERE referals.ref_tg_id = ?
2026-02-18 17:11:09,002 - sqlalchemy.engine.Engine - INFO - [cached since 12.4s ago] (8016999764,)
2026-02-18 17:11:09,003 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 17:11:09,004 - sqlalchemy.engine.Engine - INFO - [cached since 12.37s ago] (7946439246,)
2026-02-18 17:11:09,006 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 17:11:09,008 - aiogram.event - INFO - Update id=66295185 is handled. Duration 13 ms by bot id=8543122898
2026-02-18 17:11:25,392 - aiogram.event - INFO - Update id=66295186 is not handled. Duration 0 ms by bot id=8543122898
2026-02-18 17:11:26,463 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:11:26,463 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:11:26,463 - sqlalchemy.engine.Engine - INFO - [cached since 45.22s ago] (7946439246,)
2026-02-18 17:11:26,464 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7946439246 найден в базе.
2026-02-18 17:11:26,464 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 17:11:26,721 - aiogram.event - INFO - Update id=66295187 is handled. Duration 259 ms by bot id=8543122898
2026-02-18 17:11:50,178 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:11:50,179 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:11:50,179 - sqlalchemy.engine.Engine - INFO - [cached since 68.94s ago] (7266447577,)
2026-02-18 17:11:50,309 - common.handlers_flder.referal_system - WARNING - Попытка доступа к реферальной системе для несуществующего пользователя: 7266447577
2026-02-18 17:11:50,310 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 17:11:50,310 - aiogram.event - INFO - Update id=66295188 is handled. Duration 132 ms by bot id=8543122898
2026-02-18 17:11:52,665 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:11:52,666 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:11:52,666 - sqlalchemy.engine.Engine - INFO - [cached since 71.42s ago] (7266447577,)
2026-02-18 17:11:52,667 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 17:11:52,667 - sqlalchemy.engine.Engine - INFO - [cached since 71.42s ago] (7266447577, '2026-02-18 17:11:52.667065', 0)
2026-02-18 17:11:52,668 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:11:52,679 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7266447577
2026-02-18 17:11:52,679 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7266447577 создан в базе данных.
2026-02-18 17:11:56,228 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 201 Created"
2026-02-18 17:11:56,574 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/fdfbc613-8933-4196-8b91-f7a951de7811 "HTTP/1.1 200 OK"
2026-02-18 17:11:56,575 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:11:56,575 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:11:56,575 - sqlalchemy.engine.Engine - INFO - [cached since 75.33s ago] (7266447577,)
2026-02-18 17:11:56,577 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:11:56,577 - sqlalchemy.engine.Engine - INFO - [cached since 74.35s ago] ('https://sub.kurvpn.tech/upcyxyeQ_oBnLwdq', 'fdfbc613-8933-4196-8b91-f7a951de7811', '2026-02-21 14:11:52.679000', 3)
2026-02-18 17:11:56,578 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:11:56,589 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:11:56,590 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:11:56,590 - sqlalchemy.engine.Engine - INFO - [cached since 75.35s ago] (7266447577,)
2026-02-18 17:11:56,591 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:11:56,591 - sqlalchemy.engine.Engine - INFO - [cached since 74.35s ago] (7266447577, '2026-02-18 14:11:56.591189', 'active', 3)
2026-02-18 17:11:56,593 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:11:56,603 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7266447577
2026-02-18 17:11:56,954 - aiogram.event - INFO - Update id=66295189 is handled. Duration 4289 ms by bot id=8543122898
2026-02-18 17:12:02,737 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:12:02,737 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:12:02,737 - sqlalchemy.engine.Engine - INFO - [cached since 81.5s ago] (7266447577,)
2026-02-18 17:12:02,738 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7266447577 найден в базе.
2026-02-18 17:12:02,738 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 17:12:02,930 - aiogram.event - INFO - Update id=66295190 is handled. Duration 194 ms by bot id=8543122898
2026-02-18 17:12:14,750 - aiogram.event - INFO - Update id=66295191 is not handled. Duration 0 ms by bot id=8543122898
2026-02-18 17:12:16,260 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:12:16,260 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:12:16,261 - sqlalchemy.engine.Engine - INFO - [cached since 95.02s ago] (8016999764,)
2026-02-18 17:12:16,261 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 8016999764 найден в базе.
2026-02-18 17:12:16,261 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:12:16,262 - sqlalchemy.engine.Engine - INFO - [cached since 95.02s ago] (7266447577,)
2026-02-18 17:12:16,262 - ServiceClasses.user_service - INFO - Пользователь с Telegram ID 7266447577 найден в базе.
2026-02-18 17:12:16,262 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:12:16,263 - sqlalchemy.engine.Engine - INFO - [cached since 95.02s ago] (8016999764,)
2026-02-18 17:12:16,263 - sqlalchemy.engine.Engine - INFO - SELECT referals.id, referals.invited_by_tg_id, referals.ref_tg_id, referals.bonus_given, referals.user_id 
FROM referals 
WHERE referals.ref_tg_id = ?
2026-02-18 17:12:16,263 - sqlalchemy.engine.Engine - INFO - [cached since 79.66s ago] (8016999764,)
2026-02-18 17:12:16,265 - ServiceClasses.referal_service - WARNING - Пользователь 8016999764 уже имеет реферала. Создание нового реферала не разрешено.
2026-02-18 17:12:16,265 - common.handlers_flder.start_cmd - INFO - Создан реферал для пользователя: 8016999764 приглашённым пользователем: 7266447577
2026-02-18 17:12:16,265 - sqlalchemy.engine.Engine - INFO - SELECT referals.id, referals.invited_by_tg_id, referals.ref_tg_id, referals.bonus_given, referals.user_id 
FROM referals 
WHERE referals.ref_tg_id = ?
2026-02-18 17:12:16,266 - sqlalchemy.engine.Engine - INFO - [cached since 79.66s ago] (8016999764,)
2026-02-18 17:12:16,267 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 17:12:16,267 - sqlalchemy.engine.Engine - INFO - [cached since 79.64s ago] (7266447577,)
2026-02-18 17:12:16,268 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 17:12:16,269 - aiogram.event - INFO - Update id=66295192 is handled. Duration 9 ms by bot id=8543122898
2026-02-18 17:16:01,218 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - Request timeout error
2026-02-18 17:16:01,218 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 17:16:12,871 - aiogram.dispatcher - INFO - Connection established (tryings = 1, bot id = 8543122898)
2026-02-18 17:17:32,799 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:17:32,799 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 17:17:32,799 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,800 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 17:17:32,800 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,802 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 17:17:32,802 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,803 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 17:17:32,803 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,803 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 17:17:32,804 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,806 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 17:17:32,810 - sqlalchemy.engine.Engine - INFO - [no key 0.00376s] ()
2026-02-18 17:17:32,821 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 17:17:32,821 - sqlalchemy.engine.Engine - INFO - [no key 0.00026s] ()
2026-02-18 17:17:32,831 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 17:17:32,832 - sqlalchemy.engine.Engine - INFO - [no key 0.00022s] ()
2026-02-18 17:17:32,841 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 17:17:32,842 - sqlalchemy.engine.Engine - INFO - [no key 0.00028s] ()
2026-02-18 17:17:32,850 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 17:17:32,851 - sqlalchemy.engine.Engine - INFO - [no key 0.00024s] ()
2026-02-18 17:17:32,860 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 17:17:32,861 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,861 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 17:17:32,861 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,862 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 17:17:32,862 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,863 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 17:17:32,863 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,864 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 17:17:32,864 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,865 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 17:17:32,865 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,866 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 17:17:32,866 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,866 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 17:17:32,866 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,867 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 17:17:32,867 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,867 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 17:17:32,868 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:17:32,868 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 17:17:32,869 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-18 17:17:32,880 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 17:17:32,880 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 17:17:32,889 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:17:32,890 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 17:17:32,900 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 17:17:32,901 - sqlalchemy.engine.Engine - INFO - [no key 0.00027s] ()
2026-02-18 17:17:32,912 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:17:32,912 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 17:17:32,922 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:17:32,923 - sqlalchemy.engine.Engine - INFO - [no key 0.00033s] ()
2026-02-18 17:17:32,933 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:17:32,934 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 17:17:32,943 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:17:32,944 - aiogram.event - INFO - Update id=66295193 is handled. Duration 1177 ms by bot id=8543122898
2026-02-18 17:17:35,313 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:17:35,313 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:17:35,314 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] (7946439246,)
2026-02-18 17:17:35,315 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 17:17:35,315 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] (7946439246, '2026-02-18 17:17:35.314885', 0)
2026-02-18 17:17:35,316 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:17:35,326 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 17:17:35,326 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 17:17:36,252 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 400 Bad Request"
2026-02-18 17:17:36,253 - aiogram.event - INFO - Update id=66295194 is not handled. Duration 940 ms by bot id=8543122898
2026-02-18 17:17:36,253 - aiogram.event - ERROR - Cause exception while process update id=66295194 by bot id=8543122898
ConflictError: API Error A019: User username already exists (HTTP 400)
Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 68, in _handle_response
    response.raise_for_status()
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\httpx\_models.py", line 763, in raise_for_status
    raise HTTPStatusError(message, request=request, response=self)
httpx.HTTPStatusError: Client error '400 Bad Request' for url 'https://admin.kurvpn.tech/api/users'
For more information check: https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 320, in _process_update
    response = await self.feed_update(bot, update, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 164, in feed_update
    response = await self.update.wrap_outer_middleware(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\error.py", line 27, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\middlewares\user_context.py", line 58, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\fsm\middleware.py", line 43, in __call__
    return await handler(event, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\dispatcher.py", line 283, in _listen_update
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\aiogram\dispatcher\event\handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "c:\Users\SKM\Desktop\KUR_VPN\common\handlers_flder\start_cmd.py", line 39, in start_cmd
    await client.create_client(tg_user)
  File "c:\Users\SKM\Desktop\KUR_VPN\ServiceClasses\vpn_service.py", line 43, in create_client
    rem_user = await self.rem.users.create_user(create_body)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\decorators.py", line 43, in wrapper
    return api._handle_response(response, response_class=response_class)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\rapid\client.py", line 70, in _handle_response
    handle_api_error(e.response)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "C:\Users\SKM\Desktop\KUR_VPN\.venv\Lib\site-packages\remnawave\exceptions\handler.py", line 217, in handle_api_error
    raise exception_class(response.status_code, error_response)
remnawave.exceptions.general.ConflictError: API Error A019: User username already exists (HTTP 400)
2026-02-18 17:35:34,672 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 17:35:34,673 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 17:35:34,673 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 17:35:34,928 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 17:35:42,347 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2026-02-18 17:35:42,349 - apscheduler.scheduler - INFO - Added job "notifications" to job store "default"
2026-02-18 17:35:42,349 - apscheduler.scheduler - INFO - Scheduler started
2026-02-18 17:35:42,349 - aiogram.dispatcher - INFO - Start polling
2026-02-18 17:35:42,434 - aiogram.dispatcher - INFO - Run polling for bot @botintestin_bot id=8543122898 - 'KUR VPN'
2026-02-18 17:35:48,492 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:35:48,492 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 17:35:48,492 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,493 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 17:35:48,493 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,494 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 17:35:48,494 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,494 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 17:35:48,494 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,495 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 17:35:48,495 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,496 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE referals
2026-02-18 17:35:48,496 - sqlalchemy.engine.Engine - INFO - [no key 0.00068s] ()
2026-02-18 17:35:48,509 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE shoping
2026-02-18 17:35:48,510 - sqlalchemy.engine.Engine - INFO - [no key 0.00030s] ()
2026-02-18 17:35:48,520 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE vpn_accounts
2026-02-18 17:35:48,520 - sqlalchemy.engine.Engine - INFO - [no key 0.00029s] ()
2026-02-18 17:35:48,531 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE subscriptions
2026-02-18 17:35:48,531 - sqlalchemy.engine.Engine - INFO - [no key 0.00025s] ()
2026-02-18 17:35:48,543 - sqlalchemy.engine.Engine - INFO - 
DROP TABLE users
2026-02-18 17:35:48,544 - sqlalchemy.engine.Engine - INFO - [no key 0.00096s] ()
2026-02-18 17:35:48,556 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("users")
2026-02-18 17:35:48,556 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,558 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("users")
2026-02-18 17:35:48,558 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,559 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("subscriptions")
2026-02-18 17:35:48,559 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,560 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("subscriptions")
2026-02-18 17:35:48,560 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,561 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("vpn_accounts")
2026-02-18 17:35:48,561 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,562 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("vpn_accounts")
2026-02-18 17:35:48,562 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,562 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("shoping")
2026-02-18 17:35:48,563 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,564 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("shoping")
2026-02-18 17:35:48,564 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,565 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("referals")
2026-02-18 17:35:48,565 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,565 - sqlalchemy.engine.Engine - INFO - PRAGMA temp.table_info("referals")
2026-02-18 17:35:48,565 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2026-02-18 17:35:48,566 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE users (
	id INTEGER NOT NULL, 
	telegram_id INTEGER NOT NULL, 
	reg_date DATETIME NOT NULL, 
	referal_count INTEGER NOT NULL, 
	PRIMARY KEY (id)
)


2026-02-18 17:35:48,567 - sqlalchemy.engine.Engine - INFO - [no key 0.00038s] ()
2026-02-18 17:35:48,578 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_users_telegram_id ON users (telegram_id)
2026-02-18 17:35:48,579 - sqlalchemy.engine.Engine - INFO - [no key 0.00039s] ()
2026-02-18 17:35:48,593 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE subscriptions (
	id INTEGER NOT NULL, 
	subs_tg_id INTEGER NOT NULL, 
	created_at DATETIME NOT NULL, 
	status VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:35:48,594 - sqlalchemy.engine.Engine - INFO - [no key 0.00044s] ()
2026-02-18 17:35:48,616 - sqlalchemy.engine.Engine - INFO - CREATE UNIQUE INDEX ix_subscriptions_subs_tg_id ON subscriptions (subs_tg_id)
2026-02-18 17:35:48,622 - sqlalchemy.engine.Engine - INFO - [no key 0.00634s] ()
2026-02-18 17:35:48,648 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE vpn_accounts (
	id INTEGER NOT NULL, 
	"key" VARCHAR NOT NULL, 
	uuid VARCHAR NOT NULL, 
	expired_at DATETIME NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:35:48,651 - sqlalchemy.engine.Engine - INFO - [no key 0.00245s] ()
2026-02-18 17:35:48,669 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE shoping (
	id INTEGER NOT NULL, 
	money INTEGER NOT NULL, 
	shop_date VARCHAR NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:35:48,673 - sqlalchemy.engine.Engine - INFO - [no key 0.00312s] ()
2026-02-18 17:35:48,687 - sqlalchemy.engine.Engine - INFO - 
CREATE TABLE referals (
	id INTEGER NOT NULL, 
	invited_by_tg_id BIGINT NOT NULL, 
	ref_tg_id INTEGER NOT NULL, 
	bonus_given BOOLEAN NOT NULL, 
	user_id INTEGER NOT NULL, 
	PRIMARY KEY (id), 
	UNIQUE (ref_tg_id), 
	FOREIGN KEY(user_id) REFERENCES users (id)
)


2026-02-18 17:35:48,687 - sqlalchemy.engine.Engine - INFO - [no key 0.00043s] ()
2026-02-18 17:35:48,698 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:35:48,699 - aiogram.event - INFO - Update id=66295195 is handled. Duration 870 ms by bot id=8543122898
2026-02-18 17:35:51,093 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:35:51,101 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:35:51,102 - sqlalchemy.engine.Engine - INFO - [generated in 0.00126s] (7946439246,)
2026-02-18 17:35:51,105 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (telegram_id, reg_date, referal_count) VALUES (?, ?, ?)
2026-02-18 17:35:51,105 - sqlalchemy.engine.Engine - INFO - [generated in 0.00045s] (7946439246, '2026-02-18 17:35:51.103953', 0)
2026-02-18 17:35:51,108 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:35:51,119 - ServiceClasses.user_service - INFO - Новый пользователь создан: Telegram ID 7946439246
2026-02-18 17:35:51,120 - common.handlers_flder.start_cmd - INFO - Пользователь с Telegram ID 7946439246 создан в базе данных.
2026-02-18 17:35:51,750 - httpx - INFO - HTTP Request: POST https://admin.kurvpn.tech/api/users "HTTP/1.1 400 Bad Request"
2026-02-18 17:35:51,855 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/users/by-username/7946439246 "HTTP/1.1 200 OK"
2026-02-18 17:35:51,965 - httpx - INFO - HTTP Request: GET https://admin.kurvpn.tech/api/subscriptions/by-uuid/5d3a00b2-0a4a-4fef-a321-8b149542c240 "HTTP/1.1 200 OK"
2026-02-18 17:35:51,966 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:35:51,966 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:35:51,966 - sqlalchemy.engine.Engine - INFO - [cached since 0.8655s ago] (7946439246,)
2026-02-18 17:35:51,968 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 17:35:51,968 - sqlalchemy.engine.Engine - INFO - [generated in 0.00030s] (1,)
2026-02-18 17:35:51,970 - sqlalchemy.engine.Engine - INFO - INSERT INTO vpn_accounts ("key", uuid, expired_at, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:35:51,970 - sqlalchemy.engine.Engine - INFO - [generated in 0.00032s] ('https://sub.kurvpn.tech/1NnTGFyvwWvH-0zh', '5d3a00b2-0a4a-4fef-a321-8b149542c240', '2026-02-26 14:10:41.258000', 1)
2026-02-18 17:35:51,971 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:35:51,982 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:35:51,983 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:35:51,983 - sqlalchemy.engine.Engine - INFO - [cached since 0.8823s ago] (7946439246,)
2026-02-18 17:35:51,986 - sqlalchemy.engine.Engine - INFO - INSERT INTO subscriptions (subs_tg_id, created_at, status, user_id) VALUES (?, ?, ?, ?)
2026-02-18 17:35:51,986 - sqlalchemy.engine.Engine - INFO - [generated in 0.00041s] (7946439246, '2026-02-18 14:35:51.985032', 'active', 1)
2026-02-18 17:35:51,988 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-18 17:35:51,997 - common.handlers_flder.start_cmd - INFO - Подписка создана для пользователя: 7946439246
2026-02-18 17:35:52,220 - aiogram.event - INFO - Update id=66295196 is handled. Duration 1128 ms by bot id=8543122898
2026-02-18 17:35:55,998 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-18 17:35:55,998 - sqlalchemy.engine.Engine - INFO - SELECT subscriptions.id, subscriptions.subs_tg_id, subscriptions.created_at, subscriptions.status, subscriptions.user_id 
FROM subscriptions 
WHERE subscriptions.subs_tg_id = ?
2026-02-18 17:35:55,999 - sqlalchemy.engine.Engine - INFO - [generated in 0.00024s] (7946439246,)
2026-02-18 17:35:55,999 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.telegram_id, users.reg_date, users.referal_count 
FROM users 
WHERE users.telegram_id = ?
2026-02-18 17:35:56,000 - sqlalchemy.engine.Engine - INFO - [cached since 4.899s ago] (7946439246,)
2026-02-18 17:35:56,000 - sqlalchemy.engine.Engine - INFO - SELECT vpn_accounts.id, vpn_accounts."key", vpn_accounts.uuid, vpn_accounts.expired_at, vpn_accounts.user_id 
FROM vpn_accounts 
WHERE vpn_accounts.user_id = ?
2026-02-18 17:35:56,000 - sqlalchemy.engine.Engine - INFO - [cached since 4.033s ago] (1,)
2026-02-18 17:35:56,136 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-18 17:35:56,136 - aiogram.event - INFO - Update id=66295197 is handled. Duration 139 ms by bot id=8543122898
2026-02-18 19:11:05,796 - aiogram.event - INFO - Update id=66295198 is not handled. Duration 0 ms by bot id=8543122898
2026-02-18 20:17:32,728 - aiogram.dispatcher - INFO - Polling stopped
2026-02-18 20:17:32,729 - aiogram.dispatcher - ERROR - Failed to fetch updates - TelegramNetworkError: HTTP Client says - ServerDisconnectedError: Server disconnected
2026-02-18 20:17:32,729 - aiogram.dispatcher - WARNING - Sleep for 1.000000 seconds and try again... (tryings = 0, bot id = 8543122898)
2026-02-18 20:17:32,988 - aiogram.dispatcher - INFO - Polling stopped for bot @botintestin_bot id=8543122898 - 'KUR VPN'
